<p>
So quickly understand how to work with storage in Azure.
</p>

<p>
Understand there is a clear split between storage and databases.
</p>

<p>
You manage all of the files via storage accounts.
</p>

<p>
This post explores the way to set up and use everything properly in
Azure.
</p>

<p>
It will be also of paramount importance as just upon a clear
understanding of the specifics of the microsoft storage service you
will be able to properly understand and use the azure SDK. Meaning you
will have no difficulty in understanding for instance when to use a
<code>BlobContainerClientBuilder</code> or a <code>BlobContainerBuilder</code>.
</p>

<p>
In general you can find the java SDK for java <a href="https://docs.microsoft.com/en-us/java/api/com.azure.storage.blob.blobcontainerclient?view=azure-java-stable">here</a>.
</p>

<!-- TEASER_END -->

<div id="outline-container-orga55dc44" class="outline-2">
<h2 id="orga55dc44">Storage Account</h2>
<div class="outline-text-2" id="text-orga55dc44">
<p>
A storage account provides a unique namespace in Azure for your
data.
</p>

<p>
Every object that you store in Azure Storage has an address that
includes your unique account name.
</p>

<p>
You have different types of storage accounts:
</p>

<img src="../../images/Screenshot 2022-03-24 153624.png" class="center">

<p>
So you see that depending on the use case a different solution is
preferred.
</p>
</div>
</div>

<div id="outline-container-org2d8a75c" class="outline-2">
<h2 id="org2d8a75c">Containers</h2>
<div class="outline-text-2" id="text-org2d8a75c">
<p>
That is simply a logical layer for grouping blobs.
</p>

<p>
To the best of my knowledge - did not research that much data do
not live on the same machines etc.
</p>

<p>
So it is pretty much it.
</p>

<p>
Just recall the hierarchy.
</p>

<p>
Note now that containers can hold the following objects:
</p>

<ul class="org-ul">
<li>blobs</li>

<li>queues</li>

<li>tables</li>
</ul>
</div>

<div id="outline-container-org56cee00" class="outline-3">
<h3 id="org56cee00">Blobs</h3>
<div class="outline-text-3" id="text-org56cee00">
<p>
The combination of the account name and the Blob Storage endpoint
forms the base address for the objects in your storage account.
</p>

<p>
So understand that you have multiple types of blobs. Depending on
what you want to do you will have to choose the correct one.
</p>

<p>
That is the role of V. Do not spend too much time in there.
</p>

<p>
Just recall that general overview:
</p>

<ul class="org-ul">
<li>Block blobs store text and binary data. Block blobs are made up
of blocks of data that can be managed individually. Block blobs
can store up to about 190.7 TiB.</li>

<li>Append blobs are made up of blocks like block blobs, but are
optimized for append operations. Append blobs are ideal for
scenarios such as logging data from virtual machines.</li>

<li>Page blobs store random access files up to 8 TiB in size. Page
blobs store virtual hard drive (VHD) files and serve as disks for
Azure virtual machines. For more information about page blobs,
see Overview of Azure page blobs</li>
</ul>

<p>
That is pretty much it to this stage. You know blobs from your
past.
</p>
</div>
</div>

<div id="outline-container-org059e9ab" class="outline-3">
<h3 id="org059e9ab">Tables</h3>
<div class="outline-text-3" id="text-org059e9ab">
<p>
Check <a href="https://docs.microsoft.com/en-us/azure/storage/tables/table-storage-overview">here</a>.
</p>

<p>
Interesting stuff. Did not spend again too much time over there.
</p>

<p>
But the idea is to save large tables.
</p>

<p>
Different though in comparison to a relational DB. In the sense
here the idea is not to make large joins or trigger stored
procedures.
</p>

<p>
You rather save a bunch of relational data over there.
</p>

<p>
The question is though: in which format?
</p>

<p>
Would be interesting in order to understand if that might be
useful to you at some point.
</p>

<p>
Bahh seems like a weird solution this one to this stage.
</p>

<p>
I am not able to properly set into a frame to this stage. 
</p>
</div>
</div>
</div>

<div id="outline-container-org0411cb5" class="outline-2">
<h2 id="org0411cb5">Azure SDK</h2>
<div class="outline-text-2" id="text-org0411cb5">
<p>
So the above was a bit at the high level the structure of Azure
storage.
</p>

<p>
You need to understand now better how everything works.
</p>

<p>
So I am experimenting a bit with it in my Spring playground
application.
</p>

<p>
So while I am writing these notes I clearly see the tendency of
have three different ways of doing the thing. That is very standard
in the IT world.
</p>

<p>
I see that this is what happens all of the time. Then the issue
when you learn is to quickly identify the best way to do what you
want to do.
</p>

<p>
Sometimes you will make the right decision. Sometimes you will
not. The important bit as in life is to move on. There is lots to
do.
</p>

<p>
Place your bets and understand where you have to dig a lot and
spend a lot of time in understanding how a thing works. And
understand where you can move faster. 
</p>
</div>

<div id="outline-container-orgf073379" class="outline-3">
<h3 id="orgf073379">BlobServiceClient</h3>
<div class="outline-text-3" id="text-orgf073379">
<p>
Find the docu <a href="https://docs.microsoft.com/en-us/dotnet/api/azure.storage.blobs.blobserviceclient?view=azure-dotnet">here</a>.
</p>

<p>
So with this you work at the highest level of the storage
account.
</p>

<p>
I.e. you work at the <code>container</code> level here.
</p>

<p>
Here you have packaged functions calling the APIs for making
standard operations on containers.
</p>

<p>
Note now that you can work in the code by using that hierarchical
structure. Meaning.
</p>

<p>
You can <code>create</code> a <code>blobContainer</code> or get a connection to and
existing one.
</p>

<p>
The idea then that after creating or getting an existing Blob the
java SDK returns you an object for it.
</p>

<p>
See for instance the <code>GetBlobContainer</code> method.
</p>

<p>
It returns a <code>BlobContainerClient</code>. Through it then you have all
of the methods for acting on that specific layer.
</p>

<p>
So you see how you can chain the thing.
</p>

<p>
Given my discussion in the previous section of choosing the
correct way of working I guess to work in such a way.
</p>

<p>
Start always from the top of it and then chain until your level of
interest. And then act on such hierarchical level.
</p>

<p>
In such a way you might be able to keep everything into the code
and work programatically.
</p>

<p>
The other option is to work through system level parameter that
you might for instance specify in the <code>.env</code> file.
</p>

<p>
You can then use the paramters over there to jump directly to your
hierarchical level of interest. Building the client for that
specific hierarchical layer and working straight on that level.
</p>
</div>
</div>

<div id="outline-container-orgae686f3" class="outline-3">
<h3 id="orgae686f3">BlobContainer level</h3>
<div class="outline-text-3" id="text-orgae686f3">
<p>
So this is the lower level.
</p>

<p>
Here you act directly on the Blob level.
</p>

<p>
You have a basic understanding of the SDK now cause you inferred
the logic of it and how that was constructed.
</p>

<p>
So check for instance at the following snippet in order to list
all of the available blobs.
</p>

<div class="highlight"><pre><span></span>    <span class="c1">// Option 1 - Connect directly at the hierarchical level of choice</span>

    <span class="c1">// Create a BlobContainerClient object pointing to your Blob of choice</span>
    <span class="n">BlobContainerClient</span> <span class="n">blobClient</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BlobContainerClientBuilder</span><span class="p">()</span>
	<span class="p">.</span><span class="na">credential</span><span class="p">(</span><span class="n">defaultCredential</span><span class="p">)</span>
	<span class="p">.</span><span class="na">endpoint</span><span class="p">(</span><span class="n">dotenv</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;BlobContainerEndpoint&quot;</span><span class="p">))</span>
	<span class="p">.</span><span class="na">buildClient</span><span class="p">();</span>


    <span class="c1">// Option 2 - Connect at the highest and work sequentially to it</span>

    <span class="c1">// Create a BlobServiceClient Returning your Blob of choice</span>
    <span class="n">BlobContainerClient</span> <span class="n">blobClient</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BlobContainerClientBuilder</span><span class="p">()</span>
	<span class="p">.</span><span class="na">credential</span><span class="p">(</span><span class="n">defaultCredential</span><span class="p">)</span>
	<span class="p">.</span><span class="na">endpoint</span><span class="p">(</span><span class="s">&quot;https://&lt;myStorageEndpoint&gt;.blob.storage.windows.net/&quot;</span><span class="p">)</span>
	<span class="p">.</span><span class="na">buildClient</span><span class="p">();</span>

    <span class="c1">// List the blob(s) in the container.</span>
    <span class="c1">// ok good working now. note that feeds is a container and it lists all blobs into it.</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">BlobItem</span> <span class="n">blobItem</span> <span class="p">:</span> <span class="n">blobClient</span><span class="p">.</span><span class="na">listBlobs</span><span class="p">())</span> <span class="p">{</span>
	<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;\t&quot;</span> <span class="o">+</span> <span class="n">blobItem</span><span class="p">.</span><span class="na">getName</span><span class="p">());</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
