<!DOCTYPE html>
<html prefix="        og: http://ogp.me/ns# article: http://ogp.me/ns/article#     " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Code Quality Management and Monitoring | Bits of Experience</title>
<link href="https://fonts.googleapis.com/css?family=Bitter:400,400i,700" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://marcohassan.github.io/bits-of-experience/posts/code-quality-management-and-monitoring/">
<!--[if lt IE 9]><script src="../../assets/js/html5shiv-printshiv.min.js"></script><![endif]--><meta name="author" content="Marco Hassan">
<link rel="prev" href="../on-a-beautiful-sentence/" title="On a beautiful Sentence" type="text/html">
<link rel="next" href="../on-the-correct-library-versioning-scheme/" title="On the Correct Library Versioning Scheme" type="text/html">
<meta property="og:site_name" content="Bits of Experience">
<meta property="og:title" content="Code Quality Management and Monitoring">
<meta property="og:url" content="https://marcohassan.github.io/bits-of-experience/posts/code-quality-management-and-monitoring/">
<meta property="og:description" content="img {
display: block;
margin-top: 60px;
margin-bottom: 60px;
margin-left: auto;
margin-right: auto;
width: 70%;
height: 100%;
class: center;
}

.container {
  position: relative;
  left: 15%;
  margin">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2022-09-19T17:32:48+02:00">
<meta property="article:tag" content="software-engineering">
</head>
<body>
    <a href="#page-content" class="sr-only sr-only-focusable">Skip to main content</a>
    
    <section class="social"><ul>
<li><a href="../../pages/aboutme/" title="About me"><i class="fa fa-user-circle"></i></a></li>
            <li><a href="../../pages/bits-of-experience-a-readable-view-on-my-study-adventures/" title="Home"><i class="fa fa-home"></i></a></li>
            <li><a href="../../index.html" title="Blog"><i class="fa fa-edit"></i></a></li>
            <li><a href="../../pages/emacs/" title="A life Configuring Emacs"><i class="fa fa-code"></i></a></li>
            <li><a href="../../pages/papers/" title="Term and Research Papers"><i class="fa fa-university"></i></a></li>
            <li><a href="../../pages/foto-blog/" title="Foto Blog"><i class="fa fa-camera-retro"></i></a></li>
            <li><a href="https://github.com/MarcoHassan" title="My Github"><i class="fab fa-github"></i></a></li>
            <li><a href="https://stackoverflow.com/users/9731177/mhass" title="My Stack"><i class="fab fa-stack-overflow"></i></a></li>
            <li><a href="../../rss.xml" title="RSS"><i class="fa fa-rss"></i></a></li>
            <li><a href="../../categories/index.html" title="Tags"><i class="fa fa-tags"></i></a></li>
    
    

        </ul></section><section class="page-content"><div class="content" rel="main">
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Code Quality Management and Monitoring</a></h1>

        <div class="metadata">
            <p class="dateline"><a href="." rel="bookmark"><i class="fa fa-clock"></i> <time class="published dt-published" datetime="2022-09-19T17:32:48+02:00" itemprop="datePublished" title="2022-09-19 17:32">2022-09-19 17:32</time></a></p>
            <p class="byline author vcard"> <i class="fa fa-user"></i> <span class="byline-name fn" itemprop="author">
                    Marco Hassan
            </span></p>
            
        <p class="sourceline"><a href="index.org" class="sourcelink"><i class="fa fa-file-code"></i> Source</a></p>

            

            
    <div class="tags">
<h3 class="metadata-title">
<i class="fa fa-tags"></i> Tags:</h3>
        <ul itemprop="keywords" class="tags-ul">
<li><a class="tag p-category" href="../../categories/software-engineering/" rel="tag">software-engineering</a></li>
        </ul>
</div>

        </div>
    </header><div class="e-content entry-content" itemprop="articleBody text">
    <style>
img {
display: block;
margin-top: 60px;
margin-bottom: 60px;
margin-left: auto;
margin-right: auto;
width: 70%;
height: 100%;
class: center;
}

.container {
  position: relative;
  left: 15%;
  margin-top: 60px;
  margin-bottom: 60px;
  width: 70%;
  overflow: hidden;
  padding-top: 56.25%; /* 16:9 Aspect Ratio */
  display:block;
  overflow-y: hidden;
}

.responsive-iframe {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  width: 100%;
  height: 100%;
  border: none;
  display:block;
  overflow-y: hidden;
}
</style>
<p>
So basically this post contains a way to statically analyze your code
in order to see the quality of it.
</p>

<p>
This is important in order find blind spots in your code. Moreover, it
is important to keep track of the history of the quality of the
software in time. So it is a very important piece of the puzzle.
</p>

<p>
These notes are based on the gradle in action book.
</p>

<!-- TEASER_END -->

<p>
Understand the following:
</p>

<blockquote>
<p>
In the Java space, you can choose from a wide range of open source and
commercial solutions, such as Checkstyle, PMD, Cobertura, FindBugs,
and Sonar.  Many of these tools are already available in the form of
Gradle core or third-party plugins and can be seamlessly integrated
into your build.
</p>
</blockquote>

<p>
So a good idea to this point is to include these metrics and
include them in git. Just to keep track about the quality of your
code as a time series.
</p>

<p>
In general such tools produce metrics along the following
categories:
</p>

<ol class="org-ol">
<li>Code Coverage</li>

<li>Adherence to coding standards</li>

<li>Bad coding practices and design problems</li>

<li>Overly complex, duplicated, and strongly coupled code</li>
</ol>
<div id="outline-container-org9d4aec2" class="outline-3">
<h3 id="org9d4aec2">Important practical aspects</h3>
<div class="outline-text-3" id="text-org9d4aec2">
<p>
It is important to understand that you should group different code
quality metrics in different gradle tasks.
</p>

<p>
The idea is that you do not want to execute all of them together
and across the entire codebase. It will take too much time.
</p>

<p>
In this sense, you should rather decouple the tasks and also
understand the opportunity to run them for smaller portions of
your codebase.
</p>

<blockquote>
<p>
For example, during development you may want to know whether you’ve
improved the code coverage of the class you’re currently refactoring
without having to run other lengthy code quality processes.
</p>
</blockquote>
</div>
</div>


<div id="outline-container-org8cba912" class="outline-2">
<h2 id="org8cba912">Code Coverage</h2>
<div class="outline-text-2" id="text-org8cba912">
<p>
Code coverage analysis (also called test coverage analysis) is the
process of finding the areas in your code that are not exercised by
test cases.
</p>

<p>
Empirical studies show that reasonable code coverage has an
indirect impact on the quality of your code.
</p>

<p>
In any case understand the following:
</p>

<blockquote>
<p>
But despite all these benefits, code analysis <b>doesn’t replace a code
review</b> by an experienced peer; rather, it complements it.
</p>
</blockquote>

<p>
A further important question in this space is the type of coverage
metrics that you want to use.
</p>
</div>


<div id="outline-container-org5e16910" class="outline-3">
<h3 id="org5e16910">Types of Coverage</h3>
<div class="outline-text-3" id="text-org5e16910">
<p>
There is in fact more than an option to consider and especially the
following:
</p>

<ul class="org-ul">
<li>
<i>Branch coverage</i>: Measures which of the possible execution paths
(for example, in if/else branching logic) is executed by tests.</li>

<li>
<i>Statement coverage</i>: Measures which statements in a code block
have been executed. (The default in pytest-coverage).</li>

<li>
<i>Method coverage</i>: Measures which of the methods were entered
during test execution</li>

<li>
<i>Complexity metrics</i>: Measures cyclomatic complexity (the number
of independent paths through a block of code) of packages,
classes, and methods.</li>
</ul>
<p>
Especially interesting to me is the <i>complexity metric</i> as it is a
metric that I want to explore on the codebase I work on as being
quite indicative.
</p>
</div>
</div>

<div id="outline-container-org240da0a" class="outline-3">
<h3 id="org240da0a">Types of Instrumentation</h3>
<div class="outline-text-3" id="text-org240da0a">
<p>
Essentially instrumentation is the way your programs actually
check the coverage.
</p>

<p>
I.e. as per gradle in action:
</p>

<blockquote>
<p>
The job of instrumentation is to inject instructions that are used to
detect whether a particular code line or block is hit during test
execution.
</p>
</blockquote>

<p>
Understand that there are now three types of instrumentation
possibilities in Java:
</p>

<ol class="org-ol">
<li>
<b>Source code</b> instrumentation adds instructions to the source
code before compiling it to trace which part of the code has
been executed.</li>

<li>
<b>Offline bytecode</b> instrumentation applies these instructions
directly to the compiled bytecode.</li>

<li>
<b>On-the-fly</b> instrumentation adds these same instructions to the
bytecode, but does this when it’s loaded by the JVM’s class
loader.</li>
</ol>
<p>
Note now, that obviously the last one is the better option, due to
the following straightforward reasoning:
</p>

<blockquote>
<p>
In the context of a continuous delivery pipeline, where bundling the
deliverable is done after executing the code analysis phase, you want
to make sure that the source or bytecode isn’t modified after the
compilation process to avoid unexpected behavior in the target
environment.  Therefore, on-the-fly instrumentation should be
preferred.
</p>
</blockquote>

<p>
Note that in other cases there are ways to avoid instrumentation
problems. However, this requires more thought and I am not
treating it here as for the moment I am going with an on the fly
implementation software.
</p>
</div>
</div>

<div id="outline-container-org3d8c98b" class="outline-3">
<h3 id="org3d8c98b">Software Decision</h3>
<div class="outline-text-3" id="text-org3d8c98b">
<p>
I will use <i>JaCoCo</i> for running coverage and this is on the fly
implementation such that this problem is solved in the first
place. Note that JaCoCo produces <b>line and branch coverage</b>
metrics. The complexity coverage metric is missing in this sense.
</p>

<p>
If you want that cyclomatic complexity you should go with
enterprise solutions such as Cobertura. Keep it in the back of
your mind. You are likely going back with the request at some
point.
</p>

<p>
An example of cobertura report would look as follows, you see that
you have a lot information there:
</p>


<img src="../../images/Screenshot%202022-09-21%20112958.png" class="center">
</div>
</div>
</div>


<div id="outline-container-org610381d" class="outline-2">
<h2 id="org610381d">Static Code Analysis</h2>
<div class="outline-text-2" id="text-org610381d">
<p>
Recall the intro.
</p>

<p>
Basically these software covers the other points 2-4.
</p>

<p>
An overview of the available tools is the following:
</p>

<img src="../../images/Screenshot%202022-09-21%20115628.png" class="center">
</div>


<div id="outline-container-orgf7bd5d9" class="outline-3">
<h3 id="orgf7bd5d9">Checkstyle</h3>
<div class="outline-text-3" id="text-orgf7bd5d9">
<p>
So this is the first component of the static code analysis is
style checking.
</p>

<p>
It is important to adhere to coding styles. It will keep your code
uniform and clean.
</p>

<p>
In my python projects I have the style checks already implemented
at lsp level giving me warnings if I am not <a href="https://github.com/PyCQA/pycodestyle">pycodestyle conform</a>.
</p>

<p>
In this sense the first step in this dimension is to select a
relevant coding style. Check at the <a href="https://checkstyle.sourceforge.io/">following webpage</a> in this
sense.
</p>

<p>
Note that while this is the primary task of checkstyle the
<b>project developed in time</b>:
</p>

<blockquote>
<p>
The project started out as a tool for finding areas in your source
code that don’t comply with your coding rules. Over time, the feature
set was expanded to <b>also check for design problems, duplicate code,
and common bug patterns</b>.
</p>
</blockquote>

<p>
However, note that in this sense it is better to use the PMD
project. This is focused simply around the latter.
</p>
</div>
</div>


<div id="outline-container-orgc2ce3c1" class="outline-3">
<h3 id="orgc2ce3c1">PMD</h3>
<div class="outline-text-3" id="text-orgc2ce3c1">
<p>
As mentioned <a href="http://pmd.sourceforge.net/">PMD</a>:
</p>

<blockquote>
<p>
PMD is similar to Checkstyle, though it exclusively focuses on coding
problems like dead or duplicated code, overly complex code, and
possible bugs.
</p>
</blockquote>
</div>
</div>


<div id="outline-container-org4678603" class="outline-3">
<h3 id="org4678603">FindBugs / SpotBugs</h3>
<div class="outline-text-3" id="text-org4678603">
<p>
<a href="http://findbugs.sourceforge.net/">This</a> is as well for finding bugs and general poor design
practices.
</p>

<blockquote>
<p>
The bugs identified include problems like equals/hashCode
implementations, redundant null checks, and even performance
issues. Unlike the other analyzers presented earlier, FindBugs
operates on the Java bytecode, rather than the source code. You’ll
find that operating on bytecode makes the analysis slower than source
code analysis. For bigger projects, be prepared for it to take
minutes.
</p>
</blockquote>

<p>
Note that according to the official gradle documentation in the
migration between 5.X -&gt; 6.X the findbugs plugin was
deprecated. It was replaced by <a href="https://github.com/spotbugs/spotbugs-gradle-plugin">the following</a>.
</p>

<p>
Note that this seems to be quite well done as a check. The issue
is that it is not properly integrated and does not generate html
or xml reports via the gradle plugin.
</p>

<p>
You should maybe use something <a href="https://spotbugs.readthedocs.io/en/latest/running.html">along these lines</a>.
</p>

<p>
I leave it for another moment though.
</p>

<p>
In any case this is most likely the go to software - see for
instance this thread:
</p>

<p>
You can understand it as well by the fact that there are a lot of
adds-on to it, such as:
</p>

<ul class="org-ul">
<li><a href="https://find-sec-bugs.github.io/">https://find-sec-bugs.github.io/</a></li>
<li><a href="https://github.com/KengoTODA/findbugs-slf4j">https://github.com/KengoTODA/findbugs-slf4j</a></li>
</ul>
</div>
</div>


<div id="outline-container-org710921c" class="outline-3">
<h3 id="org710921c">JDepend</h3>
<div class="outline-text-3" id="text-org710921c">
<p>
<a href="http://clarkware.com/software/JDepend.html">This</a> is also a very cool one and differes in general from the
above static code analysis.
</p>

<blockquote>
<p>
The static code analysis tool JDepend produces metrics that measure
the design quality of your code.
</p>

<p>
It scans all packages of your Java code, counts the number of classes
and interfaces, and determines their dependencies.
</p>

<p>
This information will help you identify hot spots of unwanted or
strong coupling.
</p>
</blockquote>
</div>
</div>


<div id="outline-container-orgfca72d7" class="outline-3">
<h3 id="orgfca72d7">Other options</h3>
<div class="outline-text-3" id="text-orgfca72d7">
<p>
Note that there a ton of options on top of the above.
</p>

<p>
You can navigate the world wide web and try to make sense of it.
</p>

<p>
Some that might be worth exploring at some point are:
</p>

<ul class="org-ul">
<li><a href="https://niels.nu/blog/2018/testing-the-architecture">archUnit</a></li>
</ul>
</div>
</div>
</div>


<div id="outline-container-org1df33ee" class="outline-2">
<h2 id="org1df33ee">Aggregation of the different Code Quality Reports</h2>
<div class="outline-text-2" id="text-org1df33ee">
<p>
Understand the following:
</p>

<blockquote>
<p>
You’ve seen how to generate code metrics for your project using
different code analysis tools. Each of these tools produces reports
that need to be checked individually.  With every build, the existing
report is potentially deleted and a new one is created, so you have no
idea whether the code quality has improved or decayed over time. What
you need is a centralized tool that monitors, visualizes, and
aggregates your metrics. A tool that provides this functionality is
<a href="http://www.sonarsource.org/">Sonar</a>.
</p>
</blockquote>

<p>
Note that you can easily understand that the way the person
develops in the book is quite outdated. Some of the plugins do not
exists anymore in newer software versions.
</p>

<p>
Moreover, even the sonar component is not as it used to be. It is
now split across two projects.
</p>

<ol class="org-ol">
<li>
<p>
<code>sonarlint</code>:
</p>

<p>
this is cool cause it has a flavour of the static analysis tools
you have seen above but it is on the fly.
</p>

<p>
See the <a href="https://www.sonarqube.org/">official webpage</a> for more.
</p>

<p>
Note that there is an emacs plug in for it. It works in tandem
with lsp so you are <a href="https://github.com/emacs-lsp/lsp-sonarlint">good to go</a>.
</p>
</li>

<li>
<p>
<code>sonarqube</code>:
</p>

<p>
This is actually the point mentioned in the gradle in action
book.
</p>

<p>
It is quite short there. You shall read more into detail over
<a href="https://docs.sonarqube.org/latest/setup/install-server/">here</a>.
</p>
</li>
</ol>
</div>
</div>



<div id="outline-container-orgb5da86c" class="outline-2">
<h2 id="orgb5da86c">IN-PROGRESS test sonarlint and integrate it with lsp. write notes where necessary</h2>
<div class="outline-text-2" id="text-orgb5da86c">
<p>
I installed everything and verified everything.
</p>

<p>
Should work correctly.
</p>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="../on-a-beautiful-sentence/" rel="prev" title="On a beautiful Sentence">Previous post</a>
            </li>
            <li class="next">
                <a href="../on-the-correct-library-versioning-scheme/" rel="next" title="On the Correct Library Versioning Scheme">Next post</a>
            </li>
        </ul></nav></aside></article><footer id="footer"><p>Contents © 2022         <a href="mailto:marco.hassan30@gmail.com">Marco Hassan</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    </section><script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(2, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
