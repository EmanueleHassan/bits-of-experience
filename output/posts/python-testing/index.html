<!DOCTYPE html>
<html prefix="        og: http://ogp.me/ns# article: http://ogp.me/ns/article#     " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Python Testing | Bits of Experience</title>
<link href="https://fonts.googleapis.com/css?family=Bitter:400,400i,700" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://marcohassan.github.io/bits-of-experience/posts/python-testing/">
<!--[if lt IE 9]><script src="../../assets/js/html5shiv-printshiv.min.js"></script><![endif]--><meta name="author" content="Marco Hassan">
<link rel="prev" href="../emacs-as-sql-client/" title="Emacs as SQL Client" type="text/html">
<link rel="next" href="../what-to-migrate/" title="what to migrate" type="text/html">
<meta property="og:site_name" content="Bits of Experience">
<meta property="og:title" content="Python Testing">
<meta property="og:url" content="https://marcohassan.github.io/bits-of-experience/posts/python-testing/">
<meta property="og:description" content="So you already worked with python testing frameworks.



The set up was already in place back then.



Now it is more than a year that I do not touch the thing and
everything is solidly gone.



Lucki">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2022-05-12T13:35:32+02:00">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="software-engineering">
<meta property="article:tag" content="testing">
</head>
<body>
    <a href="#page-content" class="sr-only sr-only-focusable">Skip to main content</a>
    
    <section class="social"><ul>
<li><a href="../../pages/aboutme/" title="About me"><i class="fa fa-user-circle"></i></a></li>
            <li><a href="../../pages/bits-of-experience-a-readable-view-on-my-study-adventures/" title="Home"><i class="fa fa-home"></i></a></li>
            <li><a href="../../index.html" title="Blog"><i class="fa fa-edit"></i></a></li>
            <li><a href="../../pages/emacs/" title="A life Configuring Emacs"><i class="fa fa-code"></i></a></li>
            <li><a href="../../pages/papers/" title="Term and Research Papers"><i class="fa fa-university"></i></a></li>
            <li><a href="../../pages/foto-blog/" title="Foto Blog"><i class="fa fa-camera-retro"></i></a></li>
            <li><a href="https://github.com/MarcoHassan" title="My Github"><i class="fab fa-github"></i></a></li>
            <li><a href="https://stackoverflow.com/users/9731177/mhass" title="My Stack"><i class="fab fa-stack-overflow"></i></a></li>
            <li><a href="../../rss.xml" title="RSS"><i class="fa fa-rss"></i></a></li>
            <li><a href="../../categories/index.html" title="Tags"><i class="fa fa-tags"></i></a></li>
    
    

        </ul></section><section class="page-content"><div class="content" rel="main">
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Python Testing</a></h1>

        <div class="metadata">
            <p class="dateline"><a href="." rel="bookmark"><i class="fa fa-clock"></i> <time class="published dt-published" datetime="2022-05-12T13:35:32+02:00" itemprop="datePublished" title="2022-05-12 13:35">2022-05-12 13:35</time></a></p>
            <p class="byline author vcard"> <i class="fa fa-user"></i> <span class="byline-name fn" itemprop="author">
                    Marco Hassan
            </span></p>
            
        <p class="sourceline"><a href="index.org" class="sourcelink"><i class="fa fa-file-code"></i> Source</a></p>

            

            
    <div class="tags">
<h3 class="metadata-title">
<i class="fa fa-tags"></i> Tags:</h3>
        <ul itemprop="keywords" class="tags-ul">
<li><a class="tag p-category" href="../../categories/python/" rel="tag">Python</a></li>
            <li><a class="tag p-category" href="../../categories/software-engineering/" rel="tag">software-engineering</a></li>
            <li><a class="tag p-category" href="../../categories/testing/" rel="tag">testing</a></li>
        </ul>
</div>

        </div>
    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>
So you already worked with python testing frameworks.
</p>

<p>
The set up was already in place back then.
</p>

<p>
Now it is more than a year that I do not touch the thing and
everything is solidly gone.
</p>

<p>
Luckily I have a repo on my Github with some structure of it.
</p>

<p>
Will leverage that now, plus I will start to write some notes, such
that people that will have to collaborate with me can reference to
it.
</p>

<p>
On the top of it, it will be useful for the future as well.
</p>

<p>
Plus finally it is always nice to see the things in multiple
languages. It is always the same story. By adding pieces to the puzzle
the picture becomes systematically clearer not the opposite. 
</p>

<!-- TEASER_END -->

<div id="outline-container-org4f91701" class="outline-2">
<h2 id="org4f91701">Pytest vs. Unittests</h2>
<div class="outline-text-2" id="text-org4f91701">
<p>
So basically these are the two big testing frameworks in the Python
space.
</p>

<p>
I had worked with both in the past. 
</p>

<p>
I will go with the first. This decision is not 100% thought through
decision but when you work you understand that sometimes you have to
cut corners and based on what I could quickly read online it is
sensible.
</p>

<p>
There is even the possibility of running <code>unittests</code> tests through
pytest so it makes sense to leverage on this. 
</p>
</div>
</div>

<div id="outline-container-orgd3f1d2a" class="outline-2">
<h2 id="orgd3f1d2a">Writing tests</h2>
<div class="outline-text-2" id="text-orgd3f1d2a">
<p>
So a good start is the good-practices section of the <a href="https://docs.pytest.org/en/6.2.x/goodpractices.html">official
documentation</a>.
</p>

<p>
Read as well the following documentation:
</p>

<ul class="org-ul">
<li><a href="https://docs.pytest.org/en/6.2.x/reference.html">Reference API</a></li>

<li><a href="https://realpython.com/pytest-python-testing/">Python testing</a></li>
</ul>
</div>

<div id="outline-container-orgd196055" class="outline-3">
<h3 id="orgd196055">Conventions for Python test discovery</h3>
<div class="outline-text-3" id="text-orgd196055">
<p>
So basically there are two options:
</p>

<ul class="org-ul">
<li>Embedding the tests within a package - Tests inside of the
application code</li>

<li>Tests outside of the application code</li>
</ul>
<p>
<i>Update:</i> Go with the second version. It is the best. 
</p>
</div>

<div id="outline-container-org29357d5" class="outline-4">
<h4 id="org29357d5">Tests outside of the application</h4>
<div class="outline-text-4" id="text-org29357d5">
<p>
Note that basically you have a set of disadavantages if you work
in such a way.
</p>

<p>
Among the others:
</p>

<ul class="org-ul">
<li>there is no 1:1 mapping among python testing and packages
modules.</li>
</ul>
<p>
If you want to work this way you have to find a solution for it.
You can probably go into the direction with markers but I do
not know how much helpful this will be.
</p>

<p>
So basically the idea is to follow these conventions such that you
can properly map the modules to the tests.
</p>

<p>
That said, should you go this way you should work in the following
way, well noting the following points.
</p>

<p>
Note that in constrast to Java here the situation is much more
messy because of the python module imports and how everything
enters the <code>sys.path</code>. You can read more about it <a href="https://docs.pytest.org/en/6.2.x/pythonpath.html#import-modes">here</a>.
</p>

<p>
You can refer to that page in general, but use the following set up
in general as your north star:
</p>

<div class="highlight"><pre><span></span>    setup.py
    src/
	mypkg/
	    __init__.py
	    app.py
	    view.py
    tests/
	__init__.py
	foo/
	    __init__.py
	    test_view.py
	bar/
	    __init__.py
	    test_view.py
</pre></div>

<p>
Note that you need to create testing packages as in the above
(<code>foo</code>, <code>bar</code>) if you have testing modules called in the same way.
</p>
</div>
</div>

<div id="outline-container-orgb64a09d" class="outline-4">
<h4 id="orgb64a09d">Tests inside of the application code</h4>
<div class="outline-text-4" id="text-orgb64a09d">
<p>
This is a cleaner solution in the sense that it is clear which
tests belong to which modules.
</p>

<div class="highlight"><pre><span></span>    setup.py
    mypkg/
	__init__.py
	app.py
	view.py
	test/
	    __init__.py
	    test_app.py
	    test_view.py
</pre></div>

<p>
You can then quickly tests them by running:
</p>

<div class="highlight"><pre><span></span>    pytest --pyargs mypkg
</pre></div>
</div>
</div>
</div>



<div id="outline-container-org436d2b3" class="outline-3">
<h3 id="org436d2b3">Personal Conventions</h3>
<div class="outline-text-3" id="text-org436d2b3">
</div>
<div id="outline-container-org58cdc3c" class="outline-4">
<h4 id="org58cdc3c">Always use classes</h4>
<div class="outline-text-4" id="text-org58cdc3c">
<p>
Always run your tests within classes. This will be of paramount
importance.
</p>

<p>
I will usually run tests in the following way:
</p>

<div class="highlight"><pre><span></span>    <span class="c1"># content of test_moduleX.py</span>
    <span class="k">class</span> <span class="nc">Test_ModuleX</span><span class="p">:</span>
	<span class="k">def</span> <span class="nf">test_one</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	    <span class="n">x</span> <span class="o">=</span> <span class="s2">"this"</span>
	    <span class="k">assert</span> <span class="s2">"h"</span> <span class="ow">in</span> <span class="n">x</span>

	<span class="k">def</span> <span class="nf">test_two</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	    <span class="n">x</span> <span class="o">=</span> <span class="s2">"hello"</span>
	    <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">"check"</span><span class="p">)</span>
</pre></div>

<p>
then you can run the tests for the single module as follows:
</p>

<div class="highlight"><pre><span></span>    $ pytest -q test_moduleX.py
</pre></div>

<p>
On the top of it you can as well create complex logic by
inheritance etc.
</p>

<p>
Finally it is important to realize that despite the way you set up
your tests, the following benefits are there:
</p>

<blockquote>
<ul class="org-ul">
<li>Test organization</li>

<li>Sharing fixtures for tests only in that particular class</li>

<li>Applying marks at the class level and having them implicitly
apply to all tests</li>
</ul>
</blockquote>

<p>
You can as well use the flag <code>-k</code> to run tests by regular
expression.
</p>
</div>
</div>
</div>


<div id="outline-container-org5b288de" class="outline-3">
<h3 id="org5b288de">Some Useful commands</h3>
<div class="outline-text-3" id="text-org5b288de">
<p>
Note that you have a couple of plug-ins in pytest, depending on
what you aim to do.
</p>

<p>
You can check them as follows:
</p>

<div class="highlight"><pre><span></span>   $ pip install pytest-html
</pre></div>

<p>
Then you’re able to run tests with:
</p>

<div class="highlight"><pre><span></span>   $ pytest  -html<span class="o">=</span>report.html
</pre></div>
</div>
</div>


<div id="outline-container-orgcae0a54" class="outline-3">
<h3 id="orgcae0a54">Interpret Results</h3>
<div class="outline-text-3" id="text-orgcae0a54">
<p>
You have to understand the following options:
</p>

<blockquote>
<ul class="org-ul">
<li>f - failed</li>

<li>E - error</li>

<li>s - skipped</li>

<li>x - xfailed</li>

<li>X - xpassed</li>

<li>p - passed</li>

<li>P - passed with output</li>
</ul>
</blockquote>
</div>
</div>


<div id="outline-container-org9dd8e4b" class="outline-3">
<h3 id="org9dd8e4b">
<span class="todo TODO">TODO</span> properly configure the logging for there as well</h3>
</div>
</div>

<div id="outline-container-orgf819510" class="outline-2">
<h2 id="orgf819510">
<span class="todo TODO">TODO</span> Test Coverage</h2>
<div class="outline-text-2" id="text-orgf819510">
<p>
In order to generate your coverage reports you can use the
<code>coverage</code> library.
</p>

<p>
This is important as you can properly sleep at night, once your code
is properly covered.
</p>

<p>
This should also go into your <a href="https://www.scrum.org/resources/blog/done-understanding-definition-done?gclid=Cj0KCQjw4PKTBhD8ARIsAHChzRIlof8n0e1pwXTQ-QBKWB56BuHONmIqLLL99zyOrJBa57FCg3heLUUaAgkIEALw_wcB">definition of <code>DONE</code></a>.
</p>

<p>
You will release your projects just when you will have covered a
decent coverage level.
</p>

<p>
Now you can explore the following modules in order to properly work
in here:
</p>

<ul class="org-ul">
<li><a href="https://pytest-cov.readthedocs.io/en/latest/">pytest-cov</a></li>

<li><a href="https://coverage.readthedocs.io/en/6.3.2/">coverage</a></li>
</ul>
</div>
</div>

<div id="outline-container-org2256fc0" class="outline-2">
<h2 id="org2256fc0">
<span class="todo TODO">TODO</span> Read into Tox</h2>
<div class="outline-text-2" id="text-org2256fc0">
<p>
So basically this is your gradle/maven correspondent for Python.
</p>

<p>
So this is a nice automation tool. Should properly check into it and
make it run.
</p>

<p>
This is also necessary in order to have a proper environment for
testing out your code.
</p>

<p>
You can then integrate everything properly.
</p>

<p>
I.e. you can set up virtual enviornments, run your tests etc. in
there.
</p>

<p>
This is important set up everything correctly such that you can
properly introduce the python stack and triple down on everything.
</p>
</div>
</div>

<div id="outline-container-org34ecc88" class="outline-2">
<h2 id="org34ecc88">
<span class="todo TODO">TODO</span> spline</h2>
<div class="outline-text-2" id="text-org34ecc88">
<p>
This is the bonus section. Also go deeper into <a href="https://spline.readthedocs.io/en/latest/example.html">this</a>.
</p>

<p>
Just if you have time. 
</p>

<p>
I think this is an interesting project.
</p>

<p>
I would need more time to properly check into this.
</p>

<p>
Unfortunaltely in my current position I have no time to really go
out there and explore and push the boundaries.
</p>

<p>
It is already a miracle keeping the boat afloat and modernizing it
to the <i>current sate</i> of the technologies. 
</p>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="../emacs-as-sql-client/" rel="prev" title="Emacs as SQL Client">Previous post</a>
            </li>
            <li class="next">
                <a href="../what-to-migrate/" rel="next" title="what to migrate">Next post</a>
            </li>
        </ul></nav></aside></article><footer id="footer"><p>Contents © 2022         <a href="mailto:marco.hassan30@gmail.com">Marco Hassan</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    </section><script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(2, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
