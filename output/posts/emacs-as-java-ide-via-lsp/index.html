<!DOCTYPE html>
<html prefix="        og: http://ogp.me/ns# article: http://ogp.me/ns/article#     " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Emacs as Java IDE via LSP | Bits of Experience</title>
<link href="https://fonts.googleapis.com/css?family=Bitter:400,400i,700" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://emanuelehassan.github.io/bits-of-experience/posts/emacs-as-java-ide-via-lsp/">
<!--[if lt IE 9]><script src="../../assets/js/html5shiv-printshiv.min.js"></script><![endif]--><meta name="author" content="Marco Hassan">
<link rel="prev" href="../java-notes-history-syntax-and-tricks/" title="Java Notes - History, Syntax and Tricks" type="text/html">
<link rel="next" href="../on-encryption/" title="On encryption" type="text/html">
<meta property="og:site_name" content="Bits of Experience">
<meta property="og:title" content="Emacs as Java IDE via LSP">
<meta property="og:url" content="https://emanuelehassan.github.io/bits-of-experience/posts/emacs-as-java-ide-via-lsp/">
<meta property="og:description" content="img {
display: block;
margin-top: 60px;
margin-bottom: 60px;
margin-left: auto;
margin-right: auto;
width: 70%;
height: 100%;
class: center;
}

.container {
  position: relative;
  left: 15%;
  margin">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2021-09-29T18:03:15+02:00">
<meta property="article:tag" content="emacs">
<meta property="article:tag" content="java">
</head>
<body>
    <a href="#page-content" class="sr-only sr-only-focusable">Skip to main content</a>
    
    <section class="social"><ul>
<li><a href="../../pages/aboutme/" title="About me"><i class="fa fa-user-circle"></i></a></li>
            <li><a href="../../pages/bits-of-experience-a-readable-view-on-my-study-adventures/" title="Home"><i class="fa fa-home"></i></a></li>
            <li><a href="../../index.html" title="Blog"><i class="fa fa-edit"></i></a></li>
            <li><a href="../../pages/emacs/" title="A life Configuring Emacs"><i class="fa fa-code"></i></a></li>
            <li><a href="../../pages/papers/" title="Term and Research Papers"><i class="fa fa-university"></i></a></li>
            <li><a href="../../pages/foto-blog/" title="Foto Blog"><i class="fa fa-camera-retro"></i></a></li>
            <li><a href="https://github.com/MarcoHassan" title="My Github"><i class="fab fa-github"></i></a></li>
            <li><a href="https://stackoverflow.com/users/9731177/mhass" title="My Stack"><i class="fab fa-stack-overflow"></i></a></li>
            <li><a href="../../rss.xml" title="RSS"><i class="fa fa-rss"></i></a></li>
            <li><a href="../../categories/index.html" title="Tags"><i class="fa fa-tags"></i></a></li>
    
    

        </ul></section><section class="page-content"><div class="content" rel="main">
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Emacs as Java IDE via LSP</a></h1>

        <div class="metadata">
            <p class="dateline"><a href="." rel="bookmark"><i class="fa fa-clock"></i> <time class="published dt-published" datetime="2021-09-29T18:03:15+02:00" itemprop="datePublished" title="2021-09-29 18:03">2021-09-29 18:03</time></a></p>
            <p class="byline author vcard"> <i class="fa fa-user"></i> <span class="byline-name fn" itemprop="author">
                    Marco Hassan
            </span></p>
            
        <p class="sourceline"><a href="index.org" class="sourcelink"><i class="fa fa-file-code"></i> Source</a></p>

            

            
    <div class="tags">
<h3 class="metadata-title">
<i class="fa fa-tags"></i> Tags:</h3>
        <ul itemprop="keywords" class="tags-ul">
<li><a class="tag p-category" href="../../categories/emacs/" rel="tag">emacs</a></li>
            <li><a class="tag p-category" href="../../categories/java/" rel="tag">java</a></li>
        </ul>
</div>

        </div>
    </header><div class="e-content entry-content" itemprop="articleBody text">
    <style>
img {
display: block;
margin-top: 60px;
margin-bottom: 60px;
margin-left: auto;
margin-right: auto;
width: 70%;
height: 100%;
class: center;
}

.container {
  position: relative;
  left: 15%;
  margin-top: 60px;
  margin-bottom: 60px;
  width: 70%;
  overflow: hidden;
  padding-top: 56.25%; /* 16:9 Aspect Ratio */
  display:block;
  overflow-y: hidden;
}

.responsive-iframe {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  width: 100%;
  height: 100%;
  border: none;
  display:block;
  overflow-y: hidden;
}
</style>
<p>
So I will work quite a lot with Java in the next couple of years. So I
have to properly set up a strong IDE and workflow for working in it.
</p>

<p>
I know that the majority of the people do not think much of emacs in
terms of IDE but since the language-server-protocol integrations I
believe they can be as strong as more mainstream IDEs such as Visual
Code out there. t.
</p>

<p>
I even think that they can be better once you get into it
enough. After a bit of research I am quite sure about the fact.
</p>

<p>
In fact this was my experience with Python and now the step is simply
to get ot that level of costumization with emacs. So here some notes
on my way of making emacs a top environment for java and improve my
productivity with it in the long-term.
</p>

<!-- TEASER_END -->


<div id="outline-container-orgd308f73" class="outline-2">
<h2 id="orgd308f73">Resources</h2>
<div class="outline-text-2" id="text-orgd308f73">
<p>
Look at the following <a href="https://code.visualstudio.com/blogs/2018/08/07/debug-adapter-protocol-website">blog entry</a> and <a href="https://microsoft.github.io/language-server-protocol/overviews/lsp/overview/">this entry</a>.
</p>

<p>
There you will understand why emacs is nothing else than VS-code. So
people that tell you that VS-code is a better IDE than emacs have
obviously no idea how VS-code works in the background.
</p>

<p>
Add to a perfect functioning IDE all of the major emacs mode that have
little to no rival:
</p>

<ul class="org-ul">
<li>org-mode</li>

<li>magit</li>

<li>projectile</li>

<li>imenu</li>

<li>hs-minor-mode</li>
</ul>
<p>
etc. and you will soon get the reason why emacs is 10x better than any
other workflow solution out there.
</p>

<p>
Also note that you should not get confused. The underlying language
servers that you install are running in localhost so that your code is
never leaving your machine.
</p>

<p>
You can in fact see in emacs the <code>pid</code> that they are running on as it
is prompted in any source file where you are developing with the
integration of the language server protocol.
</p>

<p>
I tried then to find the process on my local laptop. On windows
systems you can do that with the following command.
</p>

<div class="highlight"><pre><span></span>netstat<span class="w"> </span>-aon
</pre></div>

<p>
Note that interestingly the process is listening on <code>0.0.0.0</code> for
connections on <code>0.0.0.0</code> so actually anyone knowing the port and IP of
my machine can connect to that language server. I was rather thinking
more of a <code>127.0.0.1</code> solution as default to be honest.
</p>

<p>
That said you can now explore the functionalities of the language
server protocol and how the infor is displayed in the emacs UI.
</p>

<p>
Check as well <a href="https://xpressrazor.wordpress.com/2020/11/04/java-programming-in-emacs/">this tutorial</a> that shows some basics functioning of
java-lsp. 
</p>
</div>
</div>


<div id="outline-container-org7dfb9b7" class="outline-2">
<h2 id="org7dfb9b7">Issues when installing the server</h2>
<div class="outline-text-2" id="text-org7dfb9b7">
<p>
So recently I migrated laptop. I am having issues with the
installation of the new jdtls server.
</p>

<p>
So here some notes in the case that you should work with it again in
the future.
</p>

<p>
So essentially the material is as well expressed <a href="https://www.reddit.com/r/emacs/comments/ilucsy/lsp_java_server_cannot_start/">here</a>.
</p>

<p>
So basically the first steps you have to take are the removal of
the important libaries:
</p>

<ul class="org-ul">
<li><code>.lsp-session-v1</code></li>

<li><code>.cache/lsp/eclipse.jdt.ls/</code></li>
</ul>
<p>
Then when you restart your emacs and open a java file, with your
current configuration you will automatically be prompted to install
the jdts server.
</p>

<p>
You can do that and should you not be able to run the server it is
worthwhile to check at the logs available at
<code>.emacs.d/.cache/lsp/eclipse.jdt.ls/config_win</code>.
</p>
</div>


<div id="outline-container-org74812af" class="outline-3">
<h3 id="org74812af">ISSUE try this as the next step</h3>
<div class="outline-text-3" id="text-org74812af">
<p>
In this case it seems that the new lsp server that you download
out-of-the box requires Java-17 to properly run.
</p>

<ul class="org-ul">
<li>download java 17 and see if that manages to fix the issue.</li>

<li>
<p>
changing the path and java<sub>home</sub> variable to Java 17. Change it
back should you run into problems.
</p>

<p>
Got some improvement at some point it seems to work. Then
restarted emacs and got an error. Cannot find java in there for
some reason.
</p>
</li>
</ul>
<p>
So essentially with both you have issues. There is something wrong
your java setup.
</p>

<p>
Check at the following errors:
</p>


<ol class="org-ol">
<li>
<p>
In the case of running with Java 17 - you seem to be able to
connect to the eclipse.jdts lsp server. You get the following
error when trying to build the project though.
</p>

<blockquote>
<p>
Unsupported class file major version 61
</p>
</blockquote>

<p>
According to <a href="https://mkyong.com/java/java-unsupported-class-file-major-version-61/">this source</a>: so it looks as if the runtime of
java is below java 17 - the version you used to compile the classes.
</p>
</li>
</ol>
<ol class="org-ol">
<li>
<p>
If you are using java 11 as your java<sub>home</sub> and set the jdk
properly in your path you get the following error:
</p>

<blockquote>
<p>
Unresolved requirement: Require-Capability: osgi.ee; filter:="(&amp;(osgi.ee=JavaSE)(version=17))"
</p>
</blockquote>

<p>
This ultimately means that: the runtime shipped by efxclipse
does not know Java-17. Please lower that to 11 for the
moment. See <a href="https://www.eclipse.org/forums/index.php/t/1110558/">the following source</a>.
</p>
</li>
</ol>
<p>
So the two problems look quite similar. In fact they are in fact
connected. The question is then where these runtime are that are
causing mess.
</p>

<p>
So fix this issue it is quite annoying. Try to clear all of the
files containing the Java metadata and make order over there.
</p>
</div>

<div id="outline-container-orgb02b15b" class="outline-4">
<h4 id="orgb02b15b">Inspect the following</h4>
<div class="outline-text-4" id="text-orgb02b15b">
<p>
I think this might be the issue - check at the java -version of
your installed openjdk:
</p>

<blockquote>
<p>
openjdk version "17.0.6" 2023-01-17 LTS
OpenJDK Runtime Environment Microsoft-7209853 (build 17.0.6+10-LTS)
OpenJDK 64-Bit Server VM Microsoft-7209853 (build 17.0.6+10-LTS, mixed mode, sharing)
</p>
</blockquote>

<p>
So you see the runtime environment is higher than the JDK
version. Check the message of Dave. Maybe this is the issue.
</p>

<p>
Note that LTS stands for <i>Long-Term-Support (LTS)</i> in the
above. It means that the provider plans to support such versions
for long time after their release.
</p>

<hr>
<p>
You have to understand how you can go down from that <code>+10</code>
version. I think this is what might cause confusion when
building the project with Java 17.
</p>

<p>
Otherwise try to restrict the source and target in your gradle
project at the specific <code>17.0.6</code>.
</p>

<hr>
<p>
Note that the following holds for the Java version 11:
</p>

<div class="highlight"><pre><span></span>       openjdk version "11.0.12" 2021-07-20
       OpenJDK Runtime Environment Microsoft-25199 (build 11.0.12+7)
       OpenJDK 64-Bit Server VM Microsoft-25199 (build 11.0.12+7, mixed mode)
</pre></div>

<p>
And it builds perfectly. So it must be something different.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org4c1aa55" class="outline-2">
<h2 id="org4c1aa55">Find reference</h2>
<div class="outline-text-2" id="text-org4c1aa55">
<p>
<code>lsp-find-references</code>:  For an object visualize where it is used in
your project. I.e. it searches across all of your files in the
project. You can then navigate across them in the usual way.
</p>

<p>
Note that this si actually very similar to the ag-search you used to
do through projectile. No big difference in this sense.
</p>

<p>
you can either do it in this version or via
<code>peek-reference</code>. understand which one of the both you like the
most.
</p>

<p>
note that you have understand the difference among reference and
implementations when searching.
</p>

<p>
you search for references for objects or variables.
</p>

<p>
you search for implementations of classes and interfaces.
</p>
</div>
</div>


<div id="outline-container-orga0e5d8b" class="outline-2">
<h2 id="orga0e5d8b">peek references</h2>
<div class="outline-text-2" id="text-orga0e5d8b">
<p>
basically the same as finding by reference. it will display more
information in the same buffer though.
</p>

<p>
you will not just see the references such that you can hover there
and jump to the statement but rather you will have two frames side
by side where hovering over one statement it will already display
the code for that piece of information.
</p>

<p>
I might even like this better. it is not bad as you see on the code
and then if you select it you actually jump to that piece of code as
in the normal way.
</p>
</div>
</div>


<div id="outline-container-org9e46ffb" class="outline-2">
<h2 id="org9e46ffb">IN-PROGRESS Alternative to the Reference possibilities</h2>
<div class="outline-text-2" id="text-org9e46ffb">
<p>
Note that I am having currently some problems with the reference
methods above, apparently the project is too big and everzthing
eventually crashes.
</p>

<p>
I guess that the issue will eventually be fixed in future versions.
</p>

<p>
In the meanwhile I have a quite handy solution. This involves in
leveraging <code>ripgrep</code> in combination with projectile.
</p>

<p>
It is in this sense possible to search for keywords, text and
regular expressions across your project.
</p>

<p>
You will then see where the thing is used across the project.
</p>

<p>
This is pretty much the same functionality of the above. Peek
reference would be cooler if it would be properly working.
</p>

<p>
As you could see on the fly the different references and could make
sense of them on the fly. I guess that you will have to ask a lot to
your emacs for working in such a way. Especially in these larger
projects. 
</p>
</div>
</div>


<div id="outline-container-org2b8c562" class="outline-2">
<h2 id="org2b8c562">Refactor</h2>
<div class="outline-text-2" id="text-org2b8c562">
</div>
<div id="outline-container-org1df6d8d" class="outline-3">
<h3 id="org1df6d8d">general refactoring - naming etc</h3>
<div class="outline-text-3" id="text-org1df6d8d">
<p>
when you call the rename option through the <code>lsp</code> server you should
actually rename all of the variables across all of the source files
in the project. this is actually not happening in my case so there
must still be some minor error.
</p>
</div>
</div>

<div id="outline-container-orge823db3" class="outline-3">
<h3 id="orge823db3">refactoring of parameters</h3>
<div class="outline-text-3" id="text-orge823db3">
<p>
note that in Java you can not assign default to parameters.
</p>

<p>
this is a big drawback to my mind.. it was pretty useful as a
feature.
</p>

<p>
now you have the option to implement the default parameters either
by overloading the stuff, or by encapsulating some information into
some object or finally by using the option of eclipse of
refactoring.
</p>

<p>
Depending on the circumstances one might be better than the
other. It is a question of experience and of checking how different
things work.
</p>

<p>
So the idea is that if you enter the refactoring view, you will
have the option of <b>changing method signature</b>.
</p>

<p>
This is a nice way to set a default. You can in fact add a
parameter and specify over there the default such that eclipse will
actually change all of the existing methods by adding the parameter
of choice with the <b>default</b> value of choice.
</p>
</div>
</div>
</div>


<div id="outline-container-org0a98077" class="outline-2">
<h2 id="org0a98077">Flycheck</h2>
<div class="outline-text-2" id="text-org0a98077">
<p>
With <code>lsp-ui-flycheck-list</code> you will get a list with all of the
errors and inconsistencies you have in your source files.
</p>

<p>
that is good and it corresponds to your eclipse way of seeing your
errors etc.
</p>

<p>
Note that there you see as well the todos as in eclipse so there is
a 1:1 in this sense.
</p>

<p>
See for instance the following on the 101 spring application I am
working on:
</p>

<img src="../../images/Screenshot%202022-02-03%20164053.png" class="center"><p>
<i>Update 01/05/2022:</i>
</p>

<p>
Flycheck 32 was finally released. This solved the flycheck issues I
was experiencing with the lsp-java interaction.
</p>

<p>
Was good to subscribing to the issue where this was being
discussed. It kept me up to date for the release.
</p>

<p>
Now it is cool cause you can have a per buffer list of your
errors. You can also quickly navigate the errors with all of the
available flycheck commands.
</p>

<p>
Finally you will have the highlighted TODOs and errors.
</p>

<p>
So cool - you have a better set up than eclipse in this sense now.
</p>
</div>
</div>


<div id="outline-container-orgd9f59c2" class="outline-2">
<h2 id="orgd9f59c2">lsp format buffer</h2>
<div class="outline-text-2" id="text-orgd9f59c2">
<p>
reformat the buffer based on what the language server thinks it
makes sense.
</p>

<p>
<code>lsp-format-buffer</code>.
</p>

<p>
not that recommended. use different packages that are tailored to
the language for doing code-formatting.
</p>

<p>
usually it works better. 
</p>
</div>
</div>


<div id="outline-container-orgc6fccf7" class="outline-2">
<h2 id="orgc6fccf7">Projectile</h2>
<div class="outline-text-2" id="text-orgc6fccf7">
<p>
this is strong as it gives you all of the options to navigate your
project and code.
</p>

<p>
i.e. jump to the test files etc. I mean this is a non-specific lsp
thing, so you can understand it online and is out of scope for this
entry.
</p>

<p>
Here you have as well all of the functions that keep track how you
moved across buffers and files in your project and you can then move
back and forth in a fast way with all of the shortcuts that you have available.
</p>
</div>

<div id="outline-container-org896554c" class="outline-3">
<h3 id="org896554c">Building and Testing</h3>
<div class="outline-text-3" id="text-org896554c">
<p>
Ok that is not properly lsp-related but let's put it in here. Maybe
I will then write some separate notes on projectile later.
</p>

<p>
You can run your projects from emacs with the <code>projectile
  run-project</code> command.
</p>

<p>
Here you can then pass for instance your <code>gradlew.bat build</code>
command.
</p>

<p>
However, note that you might as well not work in such a way. This
for instance when you are working with your stack with Spring. 
</p>

<p>
You can even run the unit-root tests for your project by running
<code>projectile test-project</code>.
</p>

<p>
Working as a charm now. Just have to configure it with <code>gradle</code> for
your actual project but then you are good to go.
</p>
</div>
</div>
</div>


<div id="outline-container-orgc07f32b" class="outline-2">
<h2 id="orgc07f32b">class hierarchy</h2>
<div class="outline-text-2" id="text-orgc07f32b">
<p>
you can visualize the class hierachy with <code>lsp-ui-imenu</code>
</p>

<p>
this is essentially the same information as you can have with the
<a href="#org95345ce">lsp-header-breadcrumb</a> below.
</p>

<p>
so I would not recommend it too much.
</p>
</div>
</div>


<div id="outline-container-org95345ce" class="outline-2">
<h2 id="org95345ce">lsp-header-breadcrumb</h2>
<div class="outline-text-2" id="text-org95345ce">
<p>
search it. will show you on the top of your buffer the hierarchy for
where you are at in your buffer.
</p>

<p>
i.e. what file, in which class etc.
</p>

<p>
this will adapt as you cycle through your code and it should help
you a bit to keep the visibility over your entire code. 
</p>
</div>
</div>


<div id="outline-container-orge288c08" class="outline-2">
<h2 id="orge288c08">Project Root</h2>
<div class="outline-text-2" id="text-orge288c08">
<p>
That is important as from there the lsp starts and make all of the
connections.
</p>

<p>
This will allow you to jump to variables and declarations at a
project wide level.
</p>

<p>
I managed to adjust the project root by removing the existing
project root that I firstly selected in just a subspace of the
working directory where just an application among the many was
defined. This was not good as that application was using some gneral
classes that were designed to be used across all of the applications
and were therefore on a different path of the hierarchy that was not
available through my project root.
</p>

<p>
In this sense I had to adapt my project root. This was done in the
following way.
</p>

<p>
First you have to see and understand the location of your
configuration file of your lsp-sessions. For this you can call the
variable <code>lsp-session-file</code> by calling <code>C-h v</code>.
</p>

<p>
Once you find such a location you can delete that file, close your
emacs, restart it, navigate a source file of your project.
</p>

<p>
You will be asked then to select the project root for your
lsp. There you should not select the proposed root that will be
inferred from the application specific <code>git</code> and <code>gradle</code> files but
you rather select the option to choose the root of the project
interactively. Then you can navigate to the real root of the project
that includes all of the submodules.
</p>

<p>
In such a way you should have a lsp server that is able to properly
infer all of your relations for your entire project and you can jump
to <b>implementations</b> and <b>definitions</b> for all of your methods,
classes and variables across your entire projects.
</p>
</div>
</div>


<div id="outline-container-org71b119a" class="outline-2">
<h2 id="org71b119a">On checking the hierarchy and dependencies</h2>
<div class="outline-text-2" id="text-org71b119a">
<p>
For visualizing the dependencies and get a general overview of a
package I like to use the <code>lsp-treemacs-java-deps-list</code> function.
</p>

<p>
There you can quickly visualize the pacakges structures and
visualize the classes available in a given file together with the
methods of them.
</p>
</div>
</div>


<div id="outline-container-org3130cf2" class="outline-2">
<h2 id="org3130cf2">treemacs</h2>
<div class="outline-text-2" id="text-org3130cf2">
<p>
Note that this is a different module but I also like this a lot and
the integration with lsp mode.
</p>

<p>
It is nice cause you can see the hierarchy of the files that you are
calling and get a general overview of how your projects are
structured.
</p>

<p>
Moreover it is nice that treemacs will follow you when jumping from
one file to the next. Especially in very large projects with tons of
files and repositories it is convenient.
</p>

<p>
In such a way you will be able to visualize the anchestors of your
file and explore what sits around that source file in the
hierarchy. That is pretty much informative already and will help you
to quickly make sense of your code.  
</p>

<hr>
<p>
<i>Update 01/05/2022:</i> For the point I set up dired-sidebar to
function in the same way.
</p>

<p>
Probably it is better to work with it. You have now shortcuts to
open and close it in a very fast way across your buffers.
</p>

<p>
In the sense that you save yourself the time to edit the treemacs
workspaces etc.
</p>

<p>
You will have to explore in time though. Might be that for
programming itself is better as it is more standard and better
integrated. 
</p>

<hr>
<p>
Note that in a similar way to lsp there is quite annoying story with
the set up. I.e. once you select a root/workspace every time you
open treemacs you will be prompted to that workspace no matter where
you are working on your file-system.
</p>

<p>
There are ways to deal with it. You can check your documentation
<a href="https://github.com/Alexander-Miller/treemacs">online</a>. You can basically call <code>treemacs-edit-workspaces</code> and edit
there your workspaces.
</p>
</div>
</div>


<div id="outline-container-org93ec262" class="outline-2">
<h2 id="org93ec262">Troubleshooting</h2>
<div class="outline-text-2" id="text-org93ec262">
<p>
Look at this <a href="https://emacs-lsp.github.io/lsp-mode/page/troubleshooting/">troubleshooting</a> url when you have issues and want to
debug stuff.  
</p>
</div>
</div>


<div id="outline-container-org6aefa35" class="outline-2">
<h2 id="org6aefa35">Debugging</h2>
<div class="outline-text-2" id="text-org6aefa35">
<p>
Basically Debugging is based once more on a protocol that
communicates with a server. In order to understand this properly
check at <a href="https://code.visualstudio.com/blogs/2018/08/07/debug-adapter-protocol-website">this url</a>.
</p>

<p>
So basically once more you are working with the same debugging
features as in VS-code.
</p>

<p>
Note that you can specify different debugger types that you want to
work with. This in a similar way as in Eclipse.
</p>

<p>
For my projects I am working with a remote Java application. For
debugging that application I am launching it listening at port 8000
for debugging.
</p>

<p>
You can then specify then a dap-debugger that will try to
instantiate a connection at that port.
</p>

<p>
You can do that for instance by specifying the following template.
</p>

<div class="highlight"><pre><span></span><span class="w">  </span><span class="p">(</span><span class="n">dap</span><span class="o">-</span><span class="n">register</span><span class="o">-</span><span class="n">debug</span><span class="o">-</span><span class="n">template</span>
<span class="w">   </span><span class="s">"localhost:8000"</span>
<span class="w">   </span><span class="p">(</span><span class="n">list</span><span class="w"> </span><span class="p">:</span><span class="n">type</span><span class="w"> </span><span class="s">"java"</span>
<span class="w">    </span><span class="p">:</span><span class="n">request</span><span class="w"> </span><span class="s">"attach"</span>
<span class="w">    </span><span class="p">:</span><span class="n">hostName</span><span class="w"> </span><span class="s">"localhost"</span>
<span class="w">    </span><span class="p">:</span><span class="n">port</span><span class="w"> </span><span class="mi">8000</span><span class="p">))</span>
</pre></div>

<p>
You can then enter the debugging modus via <code>dap-debug</code> and the hydra
pop-up will come out. That is particularly useful as it will lock
some keys that will be useful for debugging. You can then hide it or
open it via <code>M-&lt;f5&gt;</code>.
</p>

<p>
You can then start the debugger with <code>dap-debug</code> mapped to <code>&lt;f5&gt;</code>.
</p>
</div>

<div id="outline-container-orgc5a7d46" class="outline-3">
<h3 id="orgc5a7d46">Dap REPL</h3>
<div class="outline-text-3" id="text-orgc5a7d46">
<p>
Note that this is important as this is the space where you would
ultimately run your code in order to understand properly what is
going on.
</p>

<p>
I.e. you can make all of your experiments and check at the
results.
</p>

<p>
It is much better done than the respective Eclipse counterpart (the
debug shell in there).
</p>

<p>
Resembles a bit the python console in this sense.
</p>

<p>
You can open it via <code>dap-ui-repl</code>
</p>
</div>
</div>
</div>


<div id="outline-container-org87b20d4" class="outline-2">
<h2 id="org87b20d4">Auto-completion</h2>
<div class="outline-text-2" id="text-org87b20d4">
<p>
Note that auto-completion is also working now. I think that before
something was broken at configuration level.
</p>

<p>
This is my experience with lsp. There are a lot of things going on
and sometimes things just break.
</p>

<p>
It is sensible once in a while to restart everything by deleting the
<code>workspace</code> and the <code>.lsp-session-v1</code> file once in a while.
</p>

<p>
Note that there is still a lot of confusion around that topic in
lsp for emacs and the way that things are done there at UI level. In
order to understand this, check <a href="https://github.com/emacs-lsp/lsp-java/issues/201">this</a>.
</p>
</div>

<div id="outline-container-org028a42d" class="outline-3">
<h3 id="org028a42d">
<span class="todo TODO">TODO</span> autocompleting as well with the return type</h3>
<div class="outline-text-3" id="text-org028a42d">
<p>
This is suboptimal as you have to cancel it then every time.
</p>

<p>
Fix it as it can be quite annoying. 
</p>
</div>
</div>
</div>


<div id="outline-container-orgaa6efc9" class="outline-2">
<h2 id="orgaa6efc9">Lsp java deps list</h2>
<div class="outline-text-2" id="text-orgaa6efc9">
<p>
In such a way it is possible to quickly navigate all of the
necessary dependencies for your projects in your workspace.
</p>

<p>
It opens kind of a treemacs thing where you would set the stuff.
</p>
</div>
</div>


<div id="outline-container-org03a6375" class="outline-2">
<h2 id="org03a6375">Organize Imports</h2>
<div class="outline-text-2" id="text-org03a6375">
<p>
Use this. I.e. type <code>C-c l a-a</code> and organize imports.
</p>

<p>
It will clear all of the imports you do not have to use.
</p>

<p>
It will as well import all of the stuff you are using in the file.
</p>

<p>
So neat. You see that each day you are closing to working better
with it. 
</p>
</div>
</div>


<div id="outline-container-orgf66caca" class="outline-2">
<h2 id="orgf66caca">Some Eclipse Notes</h2>
<div class="outline-text-2" id="text-orgf66caca">
<p>
This were a backlog as I could not immediately migrarte to my
project.
</p>

<p>
Plus, on the top of it much of the functionalities are shared across
the two ways of developing.
</p>

<p>
Such that understanding how the Eclipse IDE works will help you to
make the best out of the lsp experience as you know all of the
features that you could possilbly leverage.
</p>

<p>
<i>Update 02/05/2022:</i> fully migrated into emacs - space of choice for
development purposes. 
</p>

<p>
This because emacs is not the most easy way you start from scratch
in a new environment. Especially for larger projects like this.
</p>

<p>
In order to switch I will have to properly understand how <code>gradle</code>
works at some point.
</p>

<p>
So understood it, to this stage and in fact I was able to migrate.
</p>

<p>
Moreover, I will have to understand all of the testing suites that
interface with Java and how to properly do the debugging in
emacs. Also understood.
</p>

<p>
From what I could see it is nonetheless theoretically possible to
eventually reach a stage with a much stronger development setting in
emacs in comparison to standard IDEs. Reached that stage as well.
</p>

<p>
In the meanwhile while this process is ongoing check at the
following notes for using more classical IDEs.
</p>
</div>

<div id="outline-container-orgeaab192" class="outline-3">
<h3 id="orgeaab192">On branch</h3>
<div class="outline-text-3" id="text-orgeaab192">
<p>
One thing that irritates me for instance in the Eclipse IDE is that
it does not automatically switch branch for my projects when I
change branch via my shell.
</p>

<p>
In order to change branch you need to right-click on the project
and referesh it. Then the change of branch will be performed. 
</p>
</div>
</div>

<div id="outline-container-org608cd2f" class="outline-3">
<h3 id="org608cd2f">Debugging</h3>
<div class="outline-text-3" id="text-org608cd2f">
<p>
For eclipse you can read <a href="https://www.vogella.com/tutorials/EclipseDebugging/article.html">this</a> documentation.
</p>

<p>
Note that you can see the debugging options for which the
local-server is started in your <code>LOCAL-tomcat</code> command file. 
</p>
</div>
</div>

<div id="outline-container-org67231ee" class="outline-3">
<h3 id="org67231ee">On problems of references in Eclipse</h3>
<div class="outline-text-3" id="text-org67231ee">
<p>
Eclipse does not manage to properly get all of the relations when
you git pull from the shell.
</p>

<p>
so be aware and on the lookout for that. in that case you <code>clean</code>
all of the workspace and start over from scratch.
</p>

<p>
In order to do that <code>Project</code> -&gt; <code>Clean</code>. Then you follow the
instructions there and you can rebuild and it should work.
</p>
</div>
</div>

<div id="outline-container-org315b926" class="outline-3">
<h3 id="org315b926">Note that in eclipse you have a way to write TODOs and search them then.</h3>
<div class="outline-text-3" id="text-org315b926">
<p>
Looks like an interesting feature. Check at it later. 
</p>

<p>
Note that in many of my tasks are noted by the follwoing tags
</p>

<pre class="example">
//TODO auto-generated method stub
</pre>


<p>
as in the following example.
</p>


<div class="highlight"><pre><span></span><span class="w">   </span><span class="nd">@Override</span>
<span class="w">   </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">insert</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="c1">// TODO Auto-generated method stub</span>

<span class="w">   </span><span class="p">}</span>
</pre></div>

<p>
Note that such strings are auto-generated by the Eclipse IDE. It is
interesting the tag <code>TODO</code>. This is a keyword through which you can
manage your todos. It is interesting especially if you will have
some searching feature then to organize such todos. 
</p>

<p>
The <code>stub</code> keyword means that the method is void and has no
return. 
</p>
</div>
</div>

<div id="outline-container-orgbe4de15" class="outline-3">
<h3 id="orgbe4de15">Autogenerated doc-comment schema</h3>
<div class="outline-text-3" id="text-orgbe4de15">
<p>
This is useful as it will give you the skeleton of the doc-comment
and will save you quite some time.
</p>

<p>
You have to find a substitute in emacs once you will get back to
it. And yes it is a matter of time. It might take longer than
expected though.
</p>
</div>
</div>

<div id="outline-container-orgd1235c4" class="outline-3">
<h3 id="orgd1235c4">Broken Eclipse - not understanding project correctly - restart</h3>
<div class="outline-text-3" id="text-orgd1235c4">
<p>
Especially now at the beginning, without having a proper
understanding of the entire thing, I am messing things up a bit.
</p>

<p>
It seems that I am particularly capable of breaking the loop eclipse
&lt;-&gt; gradle etc. In such a way your IDE will not be able to properly
read the stuff in the project. You will have lots of errors because
of missing dependecies etc.
</p>

<p>
Have to fix it at some point. In any case I still plan to eventually
migrate on my emacs for the development experience. Then I will be
properly free.
</p>

<p>
In any case for fixing these issues use the following procedere. 
</p>

<p>
Delete the following from each gradle project
</p>

<ul class="org-ul">
<li>
<code>.gradle</code> – build stuff for each library</li>
<li>
<code>.settings</code> – eclipse settings</li>
<li>
<code>.classpath</code> – classpath info</li>
<li>
<code>.project</code> – project info</li>
</ul>
<p>
on the top of the workspace <code>.metadata</code> (here eclipse saves workspace
config).
</p>

<p>
then basically you can close and reopen eclipse. 
</p>

<p>
Then change your gradle version to 7.1.1. and set the <code>java_home</code>
correctly. You can do this under project -&gt; properties -&gt; gradle.
</p>

<p>
Then basically you are good to go. You click on import -&gt; import
existing gradle project -&gt; you click on the repos.
</p>

<p>
You wait until the built is done. -&gt; you build and deploy.
</p>
</div>
</div>

<div id="outline-container-org5a7b84b" class="outline-3">
<h3 id="org5a7b84b">Multi-Threading Debugging</h3>
<div class="outline-text-3" id="text-org5a7b84b">
<p>
this is not a trivial thing. you can read about it in the following
post.
</p>

<p>
the thing is that you might start to stop a single thread, while
the other threads of the application normally continue to run.
</p>

<p>
<a href="https://stackoverflow.com/questions/5375538/debugging-multiple-threads-in-eclipse/5375589">https://stackoverflow.com/questions/5375538/debugging-multiple-threads-in-eclipse/5375589</a>
</p>

<hr>
<p>
note that I always have an issue of deployment. the jar goes in the
wrong folder. i.e. the things are packaged in the wrong directory.
</p>
</div>
</div>

<div id="outline-container-org34c95b4" class="outline-3">
<h3 id="org34c95b4">On the validation issue</h3>
<div class="outline-text-3" id="text-org34c95b4">
<p>
So basically we work with the mustache framework for embedding some
logic in the html files.
</p>

<p>
Then basically your marks in eclipse complain about it tells you
that you have errors in your html etc.
</p>
</div>
</div>

<div id="outline-container-org4776ee9" class="outline-3">
<h3 id="org4776ee9">On the Eclipse Debugger</h3>
<div class="outline-text-3" id="text-org4776ee9">
<p>
Have to find the option to go back in time - i.e. of steps.
</p>

<p>
I know this is a feature many debuggers provide and I think that it
is quite handy.
</p>

<p>
I found <a href="https://stackoverflow.com/questions/4331336/how-to-step-back-in-eclipse-debugger">this entry</a>…
</p>

<blockquote>
<p>
Beyond what's been mentioned in earlier answers - i.e. Eclipse's drop
to frame feature in the debug view, which restarts debugging earlier
in the stack frame (but does not revert global/static data) and
Omniscient debugger, which is a bit raw and not so much evolving -
there are a few Eclipse-based tools that could be used to "go back" in
(run)time:
</p>

<ul class="org-ul">
<li>JIVE: Java Interactive Visualization Environment</li>

<li>Chronon: A “flight data recorder” for Java programs</li>

<li>Diver (discontinued): Dynamic Interactive Views For Reverse
Engineering</li>

<li>Halik: Only for IntelliJ for now, but porting to Eclipse is
mentioned on the roadmap.</li>
</ul>
</blockquote>

<p>
So search for this entry and explore better these options at some
point. 
</p>
</div>
</div>

<div id="outline-container-org79c0d46" class="outline-3">
<h3 id="org79c0d46">Remove all of the imports that are not used.</h3>
<div class="outline-text-3" id="text-org79c0d46">
<p>
This is also quite handy as Eclipse automatically adds lots of
imports at development time.
</p>

<p>
You can then remove all of the ones you are not needing with
<code>CTRL-Shift-O</code>.
</p>
</div>
</div>

<div id="outline-container-org36e97b7" class="outline-3">
<h3 id="org36e97b7">How to kill all existing java related excutions</h3>
<div class="outline-text-3" id="text-org36e97b7">
<p>
This works on windows. You might need it at some point.
</p>

<blockquote>
<p>
taskkill /F /IM java.exe
</p>
</blockquote>
</div>
</div>
</div>


<div id="outline-container-org616252a" class="outline-2">
<h2 id="org616252a">ISSUES</h2>
<div class="outline-text-2" id="text-org616252a">
</div>
<div id="outline-container-org37aa654" class="outline-3">
<h3 id="org37aa654">
<span class="done DONE">DONE</span> Issue 1 - LSP; Server not connecting when switching files</h3>
<div class="outline-text-3" id="text-org37aa654">
<p>
i.e. if you reference from one file to the other it works but you
cannot change to a file with other methods such as projectile.
</p>

<p>
it will not integrate directly with the lsp server.
</p>

<p>
this is an error and issue that you need to fix if you want to work
with it in a solid way.
</p>

<ul class="org-ul">
<li>all solved. this is simply a matter of setting your lsp-session
correctly.</li>
</ul>
</div>

<div id="outline-container-org99da982" class="outline-4">
<h4 id="org99da982">Note that you manage all of the existing lsp-sessions</h4>
<div class="outline-text-4" id="text-org99da982">
<p>
with the <code>workspace</code> keyword. check at the the functions involving
it in there.
</p>
</div>
</div>

<div id="outline-container-orgab0f1a4" class="outline-4">
<h4 id="orgab0f1a4">Solution</h4>
<div class="outline-text-4" id="text-orgab0f1a4">
<p>
At the time the workaround was removing the highlighting at global
level for lsp. Now it is starting to improve as an IDE.
</p>
</div>
</div>
</div>


<div id="outline-container-orgd46161a" class="outline-3">
<h3 id="orgd46161a">
<span class="done DONE">DONE</span> On Multi-project builds</h3>
<div class="outline-text-3" id="text-orgd46161a">
<p>
See your note in your emacs configuration:
</p>

<hr>
<p>
Check at the <a href="https://issueexplorer.com/issue/emacs-lsp/lsp-java/320">following url</a> to understand the issue.
</p>

<div class="highlight"><pre><span></span><span class="w">   </span><span class="p">(</span><span class="nf">advice-add</span><span class="w"> </span><span class="ss">'lsp</span><span class="w"> </span><span class="nv">:before</span><span class="w"> </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="nf">&amp;rest</span><span class="w"> </span><span class="nv">_args</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">eval</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="nv">setf</span><span class="w"> </span><span class="p">(</span><span class="nf">lsp-session-server-id-&gt;folders</span><span class="w"> </span><span class="p">(</span><span class="nf">lsp-session</span><span class="p">))</span><span class="w"> </span><span class="p">(</span><span class="nf">ht</span><span class="p">)))))</span>
</pre></div>

<p>
It is working now. Check also at the <a href="https://github.com/emacs-lsp/lsp-mode/discussions/3095">following discussion</a> to
understand more.
</p>

<p>
Just the single project that you open is shown there in the erros
sections now in the <code>lsp-ui-flycheck-list</code>. If you add a second one
this is also added to the list in the sense that is managed by the
same server connection. The only issue is that if you close the
file it stays in the server connection. This is not ideal and would
have to sort it somehow. 
</p>

<p>
But basically now you have all of the features you desired. Just
have to check the last thing with the debugger but basically you
are there. 
</p>

<p>
You can now start to run your smaller projects in emacs and start
to get up and running with it.
</p>

<hr>
<p>
Note that this is important to navigate as across project it will
be important to deal with it in the correct way.
</p>
</div>
</div>

<div id="outline-container-orga393f52" class="outline-3">
<h3 id="orga393f52">
<span class="done DONE">DONE</span> Lsp-treemacs error list</h3>
<div class="outline-text-3" id="text-orga393f52">
<p>
That would be the final killer.
</p>

<p>
The issue is that it is not unfolding.
</p>

<p>
Again probably mostly a Windows OS issue.
</p>

<p>
Crazy how much this OS system is less supported by the emacs
community.
</p>

<p>
-—
</p>

<p>
Solved it check at your emacs config file.
</p>

<p>
That is indeed helping you a lot to keep everything properly in
order.
</p>

<p>
Note that after updating the package you will miss that bit of
code. You would have to refactor it into a more solid solution in
this sense.
</p>
</div>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="../java-notes-history-syntax-and-tricks/" rel="prev" title="Java Notes - History, Syntax and Tricks">Previous post</a>
            </li>
            <li class="next">
                <a href="../on-encryption/" rel="next" title="On encryption">Next post</a>
            </li>
        </ul></nav></aside></article><footer id="footer"><p>Contents © 2024         <a href="mailto:marco.hassan30@gmail.com">Marco Hassan</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    </section><script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(2, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
