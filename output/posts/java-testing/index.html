<!DOCTYPE html>
<html prefix="        og: http://ogp.me/ns# article: http://ogp.me/ns/article#     " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Java Testing | Bits of Experience</title>
<link href="https://fonts.googleapis.com/css?family=Bitter:400,400i,700" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://marcohassan.github.io/bits-of-experience/posts/java-testing/">
<!--[if lt IE 9]><script src="../../assets/js/html5shiv-printshiv.min.js"></script><![endif]--><meta name="author" content="Marco Hassan">
<link rel="prev" href="../front-end-stories/" title="Front-End Stories" type="text/html">
<link rel="next" href="../spring/" title="Spring" type="text/html">
<meta property="og:site_name" content="Bits of Experience">
<meta property="og:title" content="Java Testing">
<meta property="og:url" content="https://marcohassan.github.io/bits-of-experience/posts/java-testing/">
<meta property="og:description" content="So I am starting to deliver some solutions on some minor features on
some applications.



There was quite a bit of work to be done in the last couple of
months. I mean I had to get up and running wit">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2022-01-27T16:20:12+01:00">
<meta property="article:tag" content="java">
<meta property="article:tag" content="testing">
</head>
<body>
    <a href="#page-content" class="sr-only sr-only-focusable">Skip to main content</a>
    
    <section class="social"><ul>
<li><a href="../../pages/aboutme/" title="About me"><i class="fa fa-user-circle"></i></a></li>
            <li><a href="../../pages/bits-of-experience-a-readable-view-on-my-study-adventures/" title="Home"><i class="fa fa-home"></i></a></li>
            <li><a href="../../index.html" title="Blog"><i class="fa fa-edit"></i></a></li>
            <li><a href="../../pages/emacs/" title="A life Configuring Emacs"><i class="fa fa-code"></i></a></li>
            <li><a href="../../pages/papers/" title="Term and Research Papers"><i class="fa fa-university"></i></a></li>
            <li><a href="../../pages/foto-blog/" title="Foto Blog"><i class="fa fa-camera-retro"></i></a></li>
            <li><a href="https://github.com/MarcoHassan" title="My Github"><i class="fab fa-github"></i></a></li>
            <li><a href="https://stackoverflow.com/users/9731177/mhass" title="My Stack"><i class="fab fa-stack-overflow"></i></a></li>
            <li><a href="../../rss.xml" title="RSS"><i class="fa fa-rss"></i></a></li>
            <li><a href="../../categories/index.html" title="Tags"><i class="fa fa-tags"></i></a></li>
    
    

        </ul></section><section class="page-content"><div class="content" rel="main">
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Java Testing</a></h1>

        <div class="metadata">
            <p class="dateline"><a href="." rel="bookmark"><i class="fa fa-clock"></i> <time class="published dt-published" datetime="2022-01-27T16:20:12+01:00" itemprop="datePublished" title="2022-01-27 16:20">2022-01-27 16:20</time></a></p>
            <p class="byline author vcard"> <i class="fa fa-user"></i> <span class="byline-name fn" itemprop="author">
                    Marco Hassan
            </span></p>
            
        <p class="sourceline"><a href="index.org" class="sourcelink"><i class="fa fa-file-code"></i> Source</a></p>

            

            
    <div class="tags">
<h3 class="metadata-title">
<i class="fa fa-tags"></i> Tags:</h3>
        <ul itemprop="keywords" class="tags-ul">
<li><a class="tag p-category" href="../../categories/java/" rel="tag">java</a></li>
            <li><a class="tag p-category" href="../../categories/testing/" rel="tag">testing</a></li>
        </ul>
</div>

        </div>
    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>
So I am starting to deliver some solutions on some minor features on
some applications.
</p>

<p>
There was quite a bit of work to be done in the last couple of
months. I mean I had to get up and running with Java, reverse engineer
some bit of application, write documentation etc. I am slowly getting
up to speed. I have still quite a few things on my mind and I guess
that to reach the point where I would like to be it will be another
6-12 months but I am moving at a <i>decent</i> speed so that I am not
complaining too much.
</p>

<p>
The structure and challenges of the job gets clearer everyday so that
is fine - now it is a question of adapting and working strategically
to overcome the various issues.
</p>

<p>
The next bit that is on the list is about testing. This post deals
with it. I am ready to get up and running with it and start to write
well-covered software. In a further step you can then imagine some
further integration with tools as <a href="https://en.wikipedia.org/wiki/SonarQube">sonarqube</a> etc.
</p>

<p>
Cool. Starting to test seriously. Like this we can soon set up serious
devOps pipelines.
</p>

<!-- TEASER_END -->

<div id="outline-container-orgbdb9250" class="outline-2">
<h2 id="orgbdb9250">Testing</h2>
<div class="outline-text-2" id="text-orgbdb9250">
<p>
So basically I am starting to dig in the testing bit.
</p>

<p>
Always recall the essential three kind of tests in the ideal world:
</p>

<ul class="org-ul">
<li>unit testing</li>

<li>integration testing</li>

<li>functional testing</li>
</ul>
<p>
I will start by writing unit tests for my application. I will then
maybe go into the other in time.   
</p>
</div>
</div>


<div id="outline-container-org3839a03" class="outline-2">
<h2 id="org3839a03">Unit Testing</h2>
<div class="outline-text-2" id="text-org3839a03">
</div>
<div id="outline-container-orgd88c577" class="outline-3">
<h3 id="orgd88c577">Index for the page</h3>
<div class="outline-text-3" id="text-orgd88c577">
<ul class="org-ul">
<li>
<a href="#org13a4744">JUnit</a>

<ul class="org-ul">
<li><a href="#org4c14d05">Set Up</a></li>

<li><a href="#org9e30662">Actually Testing</a></li>

<li><a href="#org1657a2d">Test Classes And Method</a></li>

<li>
<a href="#org0896024">JUnit Jupiter</a>:

<ul class="org-ul">
<li><a href="#org0e8ce64">@ExtendWith</a></li>

<li><a href="#orgfb37edc">@RegisterExtension</a></li>

<li><a href="#org26cb81f">@TempDir</a></li>

<li><a href="#org92ecdf8">Testing Annotations</a></li>

<li><a href="#org59b04b7">Tagging</a></li>

<li><a href="#org753a14d">Naming and UI Style Annotations</a></li>

<li><a href="#org24e9f08">LifeCycle Annotations</a></li>

<li><a href="#org13b1805">Templates - @TestTemplate</a></li>

<li><a href="#org4205ca2">Dynamic Testing</a></li>

<li><a href="#orgd2c03ab">URI</a></li>

<li><a href="#orgaa8ae9f">Timeouts</a></li>

<li><a href="#orga35a4ed">check how to combine the annoations above into meta-annotations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul class="org-ul">
<li><a href="#orge2d98b8">AssertionTypes</a></li>

<li><a href="#org5735a87">Assumptions</a></li>
</ul>
<ul class="org-ul">
<li><a href="#org144b1cb">The bigger picture in unit-testing</a></li>

<li><a href="#org97476b9">Stub</a></li>

<li>
<a href="#org6a9aa28">Mocks - Mockito</a>

<ul class="org-ul">
<li><a href="#orgb634aaa">What is a mock object</a></li>
<li><a href="#org776c95c">Creating a mock() object and verifying the parameters received</a></li>
<li><a href="#orgfac0dbe">Dependency Injection Tool</a></li>
<li><a href="#org7c0e3ff">@Spy</a></li>
<li><a href="#orgadc1fa7">@Capture</a></li>
<li><a href="#orgd829cc5">Resources used for the tutorial</a></li>
</ul>
</li>
</ul>
</div>
</div>


<div id="outline-container-org13a4744" class="outline-3">
<h3 id="org13a4744">JUnit</h3>
<div class="outline-text-3" id="text-org13a4744">
</div>
<div id="outline-container-org045dfe0" class="outline-4">
<h4 id="org045dfe0">Index</h4>
<div class="outline-text-4" id="text-org045dfe0">
<ul class="org-ul">
<li>
<a href="#org13a4744">JUnit</a>

<ul class="org-ul">
<li><a href="#org4c14d05">Set Up</a></li>

<li><a href="#org9e30662">Actually Testing</a></li>

<li><a href="#org1657a2d">Test Classes And Method</a></li>

<li>
<a href="#org0896024">JUnit Jupiter</a>:

<ul class="org-ul">
<li><a href="#org0e8ce64">@ExtendWith</a></li>

<li><a href="#orgfb37edc">@RegisterExtension</a></li>

<li><a href="#org26cb81f">@TempDir</a></li>

<li><a href="#org92ecdf8">Testing Annotations</a></li>

<li><a href="#org59b04b7">Tagging</a></li>

<li><a href="#org753a14d">Naming and UI Style Annotations</a></li>

<li><a href="#org24e9f08">LifeCycle Annotations</a></li>

<li><a href="#org13b1805">Templates - @TestTemplate</a></li>

<li><a href="#org4205ca2">Dynamic Testing</a></li>

<li><a href="#orgd2c03ab">URI</a></li>

<li><a href="#orgaa8ae9f">Timeouts</a></li>

<li><a href="#orga35a4ed">check how to combine the annoations above into meta-annotations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul class="org-ul">
<li><a href="#orge2d98b8">AssertionTypes</a></li>

<li>
<a href="#org5735a87">Assumptions</a>
<ul class="org-ul">
<li><a href="#org144b1cb">The bigger picture in unit-testing</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org4c14d05" class="outline-4">
<h4 id="org4c14d05">Set Up</h4>
<div class="outline-text-4" id="text-org4c14d05">
<p>
So essentially I will use the JUnit package for running unit
tests.
</p>

<p>
First of all include it in your gradle dependencies
</p>

<div class="highlight"><pre><span></span>    dependencies {

      ...

      testImplementation 'org.junit.jupiter:junit-jupiter-api:5.8.1'

      ...
    }
</pre></div>

<p>
Then basically you are good to go.
</p>

<p>
Note that I work with gradle. Note that there you essentially have
the default that your tests should lie in the <code>src/test/java</code>
directory.
</p>

<p>
So essentially when working in Eclipse you can start by creating a
source-folder (meaning folder containing source code) respecting
this convention <code>src/test/java</code>.
</p>

<p>
Then from there you can go on by creating <code>JUnit Test</code> Cases. Note
that in Eclipse everything is pretty much embedded. So everything
goes through the UI. In this sense you click on the <code>src/test/java</code>
source file and from there you create a new JUnit test. There you
have to specify the package you want to work on, say
<code>com.zurich.im.b1.feeds.model</code>.
</p>

<p>
Then you can specify the class in that package that you want to
test. Finally you declare your test file with the following naming
convention <code>&lt;MyClass&gt;Test</code>.
</p>

<p>
You are done then, bu as soon as you will manage to fix your issues with
emacs start to migrate as that is a much more powerful tool.
</p>
</div>
</div>

<div id="outline-container-org9e30662" class="outline-4">
<h4 id="org9e30662">Actually Testing</h4>
<div class="outline-text-4" id="text-org9e30662">
<p>
This is then straightforward. You can read and refer a bit to the
<a href="https://junit.org/junit5/docs/current/user-guide/">following documentation</a>.
</p>

<p>
So first thing you have to understand:
</p>

<blockquote>
<p>
JUnit 5 = JUnit Platform + JUnit Jupiter + JUnit Vintage
</p>
</blockquote>

<p>
So what are the three:
</p>

<ul class="org-ul">
<li>
<code>JUnit Platform</code>: it is the actual platform for running your
tests. This is used by the different clients - be a process from
your shell, the one embedded in your Eclipse IDE etc.</li>

<li>
<code>JUnit Jupiter</code>: This module includes new programming and
extension models for writing tests in JUnit 5. You have new
annotators etc.</li>

<li>
<code>JUnit Jupiter</code>: This is for running JUnit 3 and JUnit 4 based
tests on the platform.</li>
</ul>
<p>
So we will now focus on <code>JUnit Jupiter</code> as that is the actually
coding part for writing your tests. You will then check with the
time at the rest - if you will check at them at all… just need
to decide on how to connect to the <code>JUnit Platform</code>… for now use
the Eclipse IDE… there everything is more less embedded. Move
then to Emacs with time.
</p>
</div>
</div>

<div id="outline-container-org1657a2d" class="outline-4">
<h4 id="org1657a2d">Test Classes And Method</h4>
<div class="outline-text-4" id="text-org1657a2d">
<p>
What are the first-class citizens. 
</p>

<ul class="org-ul">
<li>
<code>Test Class</code>  this is a top-level class, static member class or
<code>@Nested</code> class that contains at least 1 test method.</li>

<li>
<code>Test Method</code> any instance method that is directly annotated or
meta-annotated with <code>@Test, @RepeatedTest, @ParameterizedTest,
      @TestFactory, or @TestTemplate</code>
</li>

<li>
<code>Lifecycle Method</code> any method that is directly annotated or
meta-annotated with <code>@BeforeAll, @AfterAll, @BeforeEach, or
      @AfterEach</code>.</li>
</ul>
<p>
So that is nothing new. Trivial I would say it is just setting
naming conv.
</p>

<p>
Note that <code>Test Method</code> and <code>Lifecycle Method</code> does not have to
return any value.
</p>

<p>
The only <b>exception</b> are <code>@TestFactory</code> methods where you are
required to return a value.
</p>
</div>
</div>

<div id="outline-container-org0896024" class="outline-4">
<h4 id="org0896024">JUnit Jupiter</h4>
<div class="outline-text-4" id="text-org0896024">
<ul class="org-ul">
<li><a href="#org0e8ce64">@ExtendWith</a></li>

<li><a href="#orgfb37edc">@RegisterExtension</a></li>

<li><a href="#org26cb81f">@TempDir</a></li>

<li>
<a href="#org92ecdf8">Testing Annotations</a>

<ul class="org-ul">
<li><a href="#orgde555e9">@RepeatedTest</a></li>
<li><a href="#orgde555e9">@RepeatedTest</a></li>
<li><a href="#org2c3d7ac">@ParameterizedTest</a></li>
</ul>
</li>
</ul>
<ul class="org-ul">
<li><a href="#org59b04b7">Tagging</a></li>

<li>
<a href="#org753a14d">Naming and UI Style Annotations</a>

<ul class="org-ul">
<li><a href="#org816e28a">@DisplayName</a></li>
<li><a href="#orga8644b0">@DisplayNameGeneration</a></li>
<li><a href="#org70928ab">@IndicativeSentencesGeneration</a></li>
<li><a href="#orgad0c0e8">@Nested</a></li>
</ul>
</li>

<li>
<a href="#org24e9f08">LifeCycle Annotations</a>

<ul class="org-ul">
<li><a href="#org1d679bf">Tests Lifecycle</a></li>
<li><a href="#org25a772b">@BeforeEach</a></li>
<li><a href="#orge1da4d4">@AfterEach</a></li>
<li><a href="#org6ad8132">@BeforeAll</a></li>
<li><a href="#org3995eb3">@AfterAll</a></li>
<li><a href="#org7e02e7b">@Disabled</a></li>
<li><a href="#org37f9622">@TestInstance</a></li>
<li><a href="#org5ecbeae">@TestMethodOrder</a></li>
<li><a href="#orga857e8f">@TestClassOrder</a></li>
</ul>
</li>

<li><a href="#org13b1805">Templates - @TestTemplate</a></li>

<li>
<a href="#org4205ca2">Dynamic Testing</a>

<ul class="org-ul">
<li><a href="#orgc0e9718">@TestFactory</a></li>
<li><a href="#org258dcce">Examples</a></li>
</ul>
</li>
</ul>
<ul class="org-ul">
<li><a href="#orgd2c03ab">URI</a></li>

<li><a href="#orgaa8ae9f">Timeouts</a></li>

<li><a href="#orga35a4ed">check how to combine the annoations above into meta-annotations</a></li>
</ul>
<p>
Basically in order to understand well how to write tests in Java
understand on the one hand the following annotators through which
it is possible to specify the general logic of your tests and on
the other hand the possible assertions treated in the <a href="#orge2d98b8">next
section</a>. Also recall about <a href="#org5735a87">Assumptions</a>.
</p>

<ul class="org-ul">
<li><a href="#org24e9f08">LifeCycle Annotations</a></li>
</ul>
</div>

<ul class="org-ul">
<li>
<a id="org0e8ce64"></a>@ExtendWith<br><div class="outline-text-5" id="text-org0e8ce64">
<p>
Used to register extensions declaratively. Such annotations are
inherited. 
</p>
</div>
</li>

<li>
<a id="orgfb37edc"></a>@RegisterExtension<br><div class="outline-text-5" id="text-orgfb37edc">
<p>
Used to register extensions programmatically via fields. Such fields
are inherited unless they are shadowed. 
</p>
</div>
</li>

<li>
<a id="org26cb81f"></a>@TempDir<br><div class="outline-text-5" id="text-org26cb81f">
<p>
Used to supply a temporary directory via field injection or parameter
injection in a lifecycle method or test method; located in the
org.junit.jupiter.api.io package. 
</p>
</div>
</li>


<li>
<a id="org92ecdf8"></a>Testing Annotations<br><div class="outline-text-5" id="text-org92ecdf8">
<p>
These annotations are basically used for testing itself.
</p>

<p>
They specify how methods in test classes should be read and
processed.
</p>
</div>


<ul class="org-ul">
<li>
<a id="org4bb90ff"></a>Index<br><div class="outline-text-6" id="text-org4bb90ff">
<ul class="org-ul">
<li><a href="#orgde555e9">@RepeatedTest</a></li>
<li><a href="#orgde555e9">@RepeatedTest</a></li>
<li><a href="#org2c3d7ac">@ParameterizedTest</a></li>
</ul>
</div>
</li>

<li>
<a id="org787ba12"></a>@Test<br><div class="outline-text-6" id="text-org787ba12">
<p>
Denotes that a method is a test method.
</p>

<p>
That is the most trivial one. 
</p>
</div>
</li>

<li>
<a id="orgde555e9"></a>@RepeatedTest<br><div class="outline-text-6" id="text-orgde555e9">
<p>
JUnit Jupiter provides the ability to repeat a test a specified
number of times by annotating a method with @RepeatedTest and
specifying the total number of repetitions desired. Each
invocation of a repeated test behaves like the execution of a
regular @Test method with full support for the same lifecycle
callbacks and extensions.
</p>

<p>
See you demo test. Then when you run the test you will basically
see the repetitions nested in the method of interest.
</p>

<p>
Use the following example as per the offficial docu to style
your tests:
</p>

<div class="highlight"><pre><span></span>      <span class="kn">import static</span> <span class="nn">org.junit.jupiter.api.Assertions.assertEquals</span><span class="p">;</span>

      <span class="kn">import</span> <span class="nn">java.util.logging.Logger</span><span class="p">;</span>

      <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.BeforeEach</span><span class="p">;</span>
      <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.DisplayName</span><span class="p">;</span>
      <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.RepeatedTest</span><span class="p">;</span>
      <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.RepetitionInfo</span><span class="p">;</span>
      <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.TestInfo</span><span class="p">;</span>

      <span class="kd">class</span> <span class="nc">RepeatedTestsDemo</span> <span class="p">{</span>

	  <span class="kd">private</span> <span class="n">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="c1">// ...</span>

	      <span class="nd">@BeforeEach</span>
	      <span class="kt">void</span> <span class="nf">beforeEach</span><span class="p">(</span><span class="n">TestInfo</span> <span class="n">testInfo</span><span class="p">,</span> <span class="n">RepetitionInfo</span> <span class="n">repetitionInfo</span><span class="p">)</span> <span class="p">{</span>
	      <span class="kt">int</span> <span class="n">currentRepetition</span> <span class="o">=</span> <span class="n">repetitionInfo</span><span class="p">.</span><span class="na">getCurrentRepetition</span><span class="p">();</span>
	      <span class="kt">int</span> <span class="n">totalRepetitions</span> <span class="o">=</span> <span class="n">repetitionInfo</span><span class="p">.</span><span class="na">getTotalRepetitions</span><span class="p">();</span>
	      <span class="n">String</span> <span class="n">methodName</span> <span class="o">=</span> <span class="n">testInfo</span><span class="p">.</span><span class="na">getTestMethod</span><span class="p">().</span><span class="na">get</span><span class="p">().</span><span class="na">getName</span><span class="p">();</span>
	      <span class="n">logger</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">"About to execute repetition %d of %d for %s"</span><span class="p">,</span> <span class="c1">//</span>
					<span class="n">currentRepetition</span><span class="p">,</span> <span class="n">totalRepetitions</span><span class="p">,</span> <span class="n">methodName</span><span class="p">));</span>
	  <span class="p">}</span>

	      <span class="nd">@RepeatedTest</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
	      <span class="kt">void</span> <span class="nf">repeatedTest</span><span class="p">()</span> <span class="p">{</span>
		  <span class="c1">// ...</span>
	      <span class="p">}</span>

	  <span class="nd">@RepeatedTest</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
	  <span class="kt">void</span> <span class="nf">repeatedTestWithRepetitionInfo</span><span class="p">(</span><span class="n">RepetitionInfo</span> <span class="n">repetitionInfo</span><span class="p">)</span> <span class="p">{</span>
	      <span class="n">assertEquals</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">repetitionInfo</span><span class="p">.</span><span class="na">getTotalRepetitions</span><span class="p">());</span>
	  <span class="p">}</span>

	  <span class="nd">@RepeatedTest</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">"{displayName} {currentRepetition}/{totalRepetitions}"</span><span class="p">)</span>
	  <span class="nd">@DisplayName</span><span class="p">(</span><span class="s">"Repeat!"</span><span class="p">)</span>
	  <span class="kt">void</span> <span class="nf">customDisplayName</span><span class="p">(</span><span class="n">TestInfo</span> <span class="n">testInfo</span><span class="p">)</span> <span class="p">{</span>
	      <span class="n">assertEquals</span><span class="p">(</span><span class="s">"Repeat! 1/1"</span><span class="p">,</span> <span class="n">testInfo</span><span class="p">.</span><span class="na">getDisplayName</span><span class="p">());</span>
	  <span class="p">}</span>

	  <span class="nd">@RepeatedTest</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">RepeatedTest</span><span class="p">.</span><span class="na">LONG_DISPLAY_NAME</span><span class="p">)</span>
	  <span class="nd">@DisplayName</span><span class="p">(</span><span class="s">"Details..."</span><span class="p">)</span>
	  <span class="kt">void</span> <span class="nf">customDisplayNameWithLongPattern</span><span class="p">(</span><span class="n">TestInfo</span> <span class="n">testInfo</span><span class="p">)</span> <span class="p">{</span>
	      <span class="n">assertEquals</span><span class="p">(</span><span class="s">"Details... :: repetition 1 of 1"</span><span class="p">,</span> <span class="n">testInfo</span><span class="p">.</span><span class="na">getDisplayName</span><span class="p">());</span>
	  <span class="p">}</span>

	  <span class="nd">@RepeatedTest</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">"Wiederholung {currentRepetition} von {totalRepetitions}"</span><span class="p">)</span>
	  <span class="kt">void</span> <span class="nf">repeatedTestInGerman</span><span class="p">()</span> <span class="p">{</span>
	      <span class="c1">// ...</span>
	  <span class="p">}</span>

      <span class="p">}</span>
</pre></div>

<p>
INFO: About to execute repetition 1 of 10 for repeatedTest
INFO: About to execute repetition 2 of 10 for repeatedTest
INFO: About to execute repetition 3 of 10 for repeatedTest
INFO: About to execute repetition 4 of 10 for repeatedTest
INFO: About to execute repetition 5 of 10 for repeatedTest
INFO: About to execute repetition 6 of 10 for repeatedTest
INFO: About to execute repetition 7 of 10 for repeatedTest
INFO: About to execute repetition 8 of 10 for repeatedTest
INFO: About to execute repetition 9 of 10 for repeatedTest
INFO: About to execute repetition 10 of 10 for repeatedTest
INFO: About to execute repetition 1 of 5 for repeatedTestWithRepetitionInfo
INFO: About to execute repetition 2 of 5 for repeatedTestWithRepetitionInfo
INFO: About to execute repetition 3 of 5 for repeatedTestWithRepetitionInfo
INFO: About to execute repetition 4 of 5 for repeatedTestWithRepetitionInfo
INFO: About to execute repetition 5 of 5 for repeatedTestWithRepetitionInfo
INFO: About to execute repetition 1 of 1 for customDisplayName
INFO: About to execute repetition 1 of 1 for customDisplayNameWithLongPattern
INFO: About to execute repetition 1 of 5 for repeatedTestInGerman
INFO: About to execute repetition 2 of 5 for repeatedTestInGerman
INFO: About to execute repetition 3 of 5 for repeatedTestInGerman
INFO: About to execute repetition 4 of 5 for repeatedTestInGerman
INFO: About to execute repetition 5 of 5 for repeatedTestInGerman
import static org.junit.jupiter.api.Assertions.assertEquals;
</p>

<p>
Nice, you can then add this to your logs and inspect them
etc. Have still to decide on the workflow for such tests but that
is a good option.
</p>

<p>
Such methods <b>are inherited</b> unless they are overridden.
</p>
</div>
</li>

<li>
<a id="org2c3d7ac"></a>@ParameterizedTest<br><div class="outline-text-6" id="text-org2c3d7ac">
<p>
Understand the following naming conventition that will be used
in this section
</p>

<ul class="org-ul">
<li>
<code>factory method</code>: a non-private, static method declared in the</li>
</ul>
<p>
target type that accepts a single String argument and returns an
instance of the target type. The name of the method can be
arbitrary and need not follow any particular convention. 
</p>

<ul class="org-ul">
<li>
<code>factory constructor</code>: a non-private constructor in the target</li>
</ul>
<p>
type that accepts a single String argument. Note that the target
type must be declared as either a top-level class or as a static
nested class.
</p>

<p>
These can then be used for parameterizing your test cases.
</p>
</div>

<ul class="org-ul">
<li>
<a id="org734495e"></a>Most basic example<br><div class="outline-text-7" id="text-org734495e">
<p>
It is possible for the tests to run with different parameters
with the use of this tag.
</p>

<p>
See for instace the following
</p>

<div class="highlight"><pre><span></span>       <span class="nd">@ParameterizedTest</span>
       <span class="nd">@ValueSource</span><span class="p">(</span><span class="n">strings</span> <span class="o">=</span> <span class="p">{</span> <span class="s">"hello"</span><span class="p">,</span> <span class="s">"world"</span><span class="p">,</span> <span class="s">"I love J.N."</span> <span class="p">})</span> <span class="c1">// source for the parameters</span>
       <span class="kt">void</span> <span class="nf">words</span><span class="p">(</span><span class="n">String</span> <span class="n">candidate</span><span class="p">)</span> <span class="p">{</span>
	   <span class="n">Assertions</span><span class="p">.</span><span class="na">assertTrue</span><span class="p">(</span><span class="n">candidate</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">"hello"</span><span class="p">));</span>
       <span class="p">}</span>      
</pre></div>
<p>
words(String) ✔
├─ [1] candidate=hello ✔
├─ [2] candidate=world X
└─ [3] candidate=I love J.N. X
</p>

<p>
Such methods are inherited unless they are overridden.
</p>
</div>
</li>

<li>
<a id="org0caff7b"></a>On Methods implementing Autocloseable<br><div class="outline-text-7" id="text-org0caff7b">
<p>
Recall the following point. Might be useful at some point in
the future.
</p>

<div class="highlight"><pre><span></span>       <span class="n">Arguments</span> <span class="n">that</span> <span class="n">implement</span> <span class="n">java</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">AutoCloseable</span> <span class="p">(</span><span class="n">or</span>
       <span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">Closeable</span> <span class="n">which</span> <span class="kd">extends</span> <span class="n">java</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">AutoCloseable</span><span class="p">)</span> <span class="n">will</span>
       <span class="n">be</span> <span class="n">automatically</span> <span class="n">closed</span> <span class="n">after</span> <span class="nd">@AfterEach</span> <span class="n">methods</span> <span class="n">and</span>
       <span class="n">AfterEachCallback</span> <span class="n">extensions</span> <span class="n">have</span> <span class="n">been</span> <span class="n">called</span> <span class="k">for</span> <span class="n">the</span> <span class="n">current</span>
       <span class="n">parameterized</span> <span class="n">test</span> <span class="n">invocation</span><span class="p">.</span>  

       <span class="n">To</span> <span class="n">prevent</span> <span class="k">this</span> <span class="n">from</span> <span class="n">happening</span><span class="p">,</span> <span class="n">set</span> <span class="n">the</span> <span class="n">autoCloseArguments</span>
       <span class="n">attribute</span> <span class="n">in</span> <span class="nd">@ParameterizedTest</span> <span class="n">to</span> <span class="kc">false</span><span class="p">.</span> <span class="n">Specifically</span><span class="p">,</span> <span class="k">if</span> <span class="n">an</span>
       <span class="n">argument</span> <span class="n">that</span> <span class="kd">implements</span> <span class="n">AutoCloseable</span> <span class="n">is</span> <span class="n">reused</span> <span class="k">for</span> <span class="n">multiple</span>
       <span class="n">invocations</span> <span class="n">of</span> <span class="n">the</span> <span class="n">same</span> <span class="n">parameterized</span> <span class="n">test</span> <span class="n">method</span><span class="p">,</span> <span class="n">you</span> <span class="n">must</span>
       <span class="n">annotate</span> <span class="n">the</span> <span class="n">method</span> <span class="n">with</span> <span class="nd">@ParameterizedTest</span><span class="p">(</span><span class="n">autoCloseArguments</span>
       <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="n">to</span> <span class="n">ensure</span> <span class="n">that</span> <span class="n">the</span> <span class="n">argument</span> <span class="n">is</span> <span class="n">not</span> <span class="n">closed</span> <span class="n">between</span>
       <span class="n">invocations</span><span class="p">.</span> 
</pre></div>
</div>
</li>

<li>
<a id="org71d4c0a"></a>On the possible sources for parameterized methods<br><div class="outline-text-7" id="text-org71d4c0a">
<p>
Recall that there are various sources for parametrized methods that
you can use when working with these.
</p>

<p>
Essentially you can work with the follwoing:
</p>

<ul class="org-ul">
<li>
<p>
<code>@ValueSource</code>
</p>

<p>
this is basically the one in the example above. It is the
trivial and most basic one. You pass primitives to it. 
</p>
</li>

<li>
<p>
Null and Empty Sources
</p>

<p>
So essentially these are tags to pass <i>empty and null values</i>
as paramters. Play around with them in the next step.
</p>

<p>
<code>@NullSource</code>: provides a single null argument to the
annotated method.
</p>

<p>
<code>@EmptySource</code>: provides a single empty argument to the
annotated <code>@ParameterizedTest</code> method for parameters of the
following types: java.lang.String, java.util.List,
java.util.Set, java.util.Map, primitive arrays (e.g., int[],
char[][], etc.), object arrays (e.g.,String[], Integer[][],
etc.).
</p>
</li>

<li>
<p>
<code>@EnumSource</code>
</p>

<p>
With this you can use Enum constants.
</p>

<div class="highlight"><pre><span></span>	 <span class="nd">@ParameterizedTest</span>
	 <span class="nd">@EnumSource</span><span class="p">(</span><span class="n">names</span> <span class="o">=</span> <span class="p">{</span> <span class="s">"DAYS"</span><span class="p">,</span> <span class="s">"HOURS"</span> <span class="p">})</span> <span class="c1">// names of the constant you will pass. </span>
	 <span class="kt">void</span> <span class="nf">testWithEnumSourceInclude</span><span class="p">(</span><span class="n">ChronoUnit</span> <span class="n">unit</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// ChronoUnit is the enum you will use</span>
	     <span class="n">assertTrue</span><span class="p">(</span><span class="n">EnumSet</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">ChronoUnit</span><span class="p">.</span><span class="na">DAYS</span><span class="p">,</span> <span class="n">ChronoUnit</span><span class="p">.</span><span class="na">HOURS</span><span class="p">).</span><span class="na">contains</span><span class="p">(</span><span class="n">unit</span><span class="p">));</span>
	 <span class="p">}</span>
</pre></div>

<p>
You can even use exclude logic or regex
</p>

<div class="highlight"><pre><span></span>	 <span class="nd">@ParameterizedTest</span>
	 <span class="nd">@EnumSource</span><span class="p">(</span><span class="n">mode</span> <span class="o">=</span> <span class="n">EXCLUDE</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="p">{</span> <span class="s">"ERAS"</span><span class="p">,</span> <span class="s">"FOREVER"</span> <span class="p">})</span>
	 <span class="kt">void</span> <span class="nf">testWithEnumSourceExclude</span><span class="p">(</span><span class="n">ChronoUnit</span> <span class="n">unit</span><span class="p">)</span> <span class="p">{</span>
	     <span class="n">assertFalse</span><span class="p">(</span><span class="n">EnumSet</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">ChronoUnit</span><span class="p">.</span><span class="na">ERAS</span><span class="p">,</span> <span class="n">ChronoUnit</span><span class="p">.</span><span class="na">FOREVER</span><span class="p">).</span><span class="na">contains</span><span class="p">(</span><span class="n">unit</span><span class="p">));</span>
	 <span class="p">}</span>
	 <span class="nd">@ParameterizedTest</span>
	 <span class="nd">@EnumSource</span><span class="p">(</span><span class="n">mode</span> <span class="o">=</span> <span class="n">MATCH_ALL</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="s">"^.*DAYS$"</span><span class="p">)</span>
	 <span class="kt">void</span> <span class="nf">testWithEnumSourceRegex</span><span class="p">(</span><span class="n">ChronoUnit</span> <span class="n">unit</span><span class="p">)</span> <span class="p">{</span>
	     <span class="n">assertTrue</span><span class="p">(</span><span class="n">unit</span><span class="p">.</span><span class="na">name</span><span class="p">().</span><span class="na">endsWith</span><span class="p">(</span><span class="s">"DAYS"</span><span class="p">));</span>
	 <span class="p">}</span>
</pre></div>
</li>

<li>
<p>
<code>@MethodSource</code>
</p>

<p>
@MethodSource allows you to refer to one or more <i>factory
methods</i> of the test class or external classes.
</p>

<p>
These will supply the input of interest.
</p>

<p>
Each <b>factory method</b> must generate a stream of arguments, and
each set of arguments within the stream will be provided as
the physical arguments for individual invocations of the
annotated @ParameterizedTest method.
</p>

<div class="highlight"><pre><span></span>	 <span class="c1">// Single Parameter Example //</span>
	 <span class="nd">@ParameterizedTest</span>
	 <span class="nd">@MethodSource</span><span class="p">(</span><span class="s">"stringProvider"</span><span class="p">)</span>
	 <span class="kt">void</span> <span class="nf">testWithExplicitLocalMethodSource</span><span class="p">(</span><span class="n">String</span> <span class="n">argument</span><span class="p">)</span> <span class="p">{</span>
	     <span class="n">assertNotNull</span><span class="p">(</span><span class="n">argument</span><span class="p">);</span>
	 <span class="p">}</span>

	 <span class="kd">static</span> <span class="n">Stream</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">stringProvider</span><span class="p">()</span> <span class="p">{</span>
	     <span class="k">return</span> <span class="n">Stream</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">"apple"</span><span class="p">,</span> <span class="s">"banana"</span><span class="p">);</span>
	 <span class="p">}</span>

	 <span class="c1">// Multiple Paramter Parameter Example //</span>
	 <span class="nd">@ParameterizedTest</span>
	 <span class="nd">@MethodSource</span><span class="p">(</span><span class="s">"stringIntAndListProvider"</span><span class="p">)</span>
	 <span class="kt">void</span> <span class="nf">testWithMultiArgMethodSource</span><span class="p">(</span><span class="n">String</span> <span class="n">str</span><span class="p">,</span> <span class="kt">int</span> <span class="n">num</span><span class="p">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">list</span><span class="p">)</span> <span class="p">{</span>
	     <span class="n">assertEquals</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">str</span><span class="p">.</span><span class="na">length</span><span class="p">());</span>
	     <span class="n">assertTrue</span><span class="p">(</span><span class="n">num</span> <span class="o">&gt;=</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">num</span> <span class="o">&lt;=</span><span class="mi">2</span><span class="p">);</span>
	     <span class="n">assertEquals</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">list</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
	 <span class="p">}</span>

	 <span class="kd">static</span> <span class="n">Stream</span><span class="o">&lt;</span><span class="n">Arguments</span><span class="o">&gt;</span> <span class="nf">stringIntAndListProvider</span><span class="p">()</span> <span class="p">{</span>
	     <span class="k">return</span> <span class="n">Stream</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
		 <span class="n">arguments</span><span class="p">(</span><span class="s">"apple"</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="s">"a"</span><span class="p">,</span> <span class="s">"b"</span><span class="p">)),</span> <span class="c1">// note how you have to return an argument object</span>
		 <span class="n">arguments</span><span class="p">(</span><span class="s">"lemon"</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="s">"x"</span><span class="p">,</span> <span class="s">"y"</span><span class="p">))</span>
	     <span class="p">);</span>
	 <span class="p">}</span>
</pre></div>

<p>
recall that Argument Inteface. It is something specific in
Junit. See <a href="https://junit.org/junit5/docs/5.0.0/api/org/junit/jupiter/params/provider/Arguments.html">official docu</a>. In any case just take it as given
and understand it in the way as used above.
</p>

<p>
Note that you can as well work by calling a factory reference.
</p>

<div class="highlight"><pre><span></span>	 <span class="kn">package</span> <span class="nn">example</span><span class="p">;</span>

	 <span class="kn">import</span> <span class="nn">java.util.stream.Stream</span><span class="p">;</span>

	 <span class="kn">import</span> <span class="nn">org.junit.jupiter.params.ParameterizedTest</span><span class="p">;</span>
	 <span class="kn">import</span> <span class="nn">org.junit.jupiter.params.provider.MethodSource</span><span class="p">;</span>

	 <span class="kd">class</span> <span class="nc">ExternalMethodSourceDemo</span> <span class="p">{</span>

	     <span class="nd">@ParameterizedTest</span>
	     <span class="nd">@MethodSource</span><span class="p">(</span><span class="s">"example.StringsProviders#tinyStrings"</span><span class="p">)</span>
	     <span class="kt">void</span> <span class="nf">testWithExternalMethodSource</span><span class="p">(</span><span class="n">String</span> <span class="n">tinyString</span><span class="p">)</span> <span class="p">{</span>
		 <span class="c1">// test with tiny string</span>
	     <span class="p">}</span>
	 <span class="p">}</span>

	 <span class="kd">class</span> <span class="nc">StringsProviders</span> <span class="p">{</span>

	     <span class="kd">static</span> <span class="n">Stream</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">tinyStrings</span><span class="p">()</span> <span class="p">{</span>
		 <span class="k">return</span> <span class="n">Stream</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">"."</span><span class="p">,</span> <span class="s">"oo"</span><span class="p">,</span> <span class="s">"OOO"</span><span class="p">);</span>
	     <span class="p">}</span>
	 <span class="p">}</span>
</pre></div>
</li>

<li>
<p>
<code>@CsvSource</code>:
</p>

<p>
<i>@CsvSource</i> allows you to express argument lists as
comma-separated values.
</p>

<p>
So basically you pass your csv as comma separated values
there.
</p>

<p>
This might be good for writing tests checking and your
implemented parsers.
</p>

<p>
Example
</p>

<div class="highlight"><pre><span></span>	 <span class="nd">@ParameterizedTest</span>
	 <span class="nd">@CsvSource</span><span class="p">({</span>
	     <span class="s">"apple,         1"</span><span class="p">,</span>
	     <span class="s">"banana,        2"</span><span class="p">,</span>
	     <span class="s">"'lemon, lime', 0xF1"</span><span class="p">,</span> <span class="c1">// note single quote ' for quote character.</span>
	     <span class="s">"strawberry,    700_000"</span>
	 <span class="p">})</span>
	 <span class="kt">void</span> <span class="nf">testWithCsvSource</span><span class="p">(</span><span class="n">String</span> <span class="n">fruit</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rank</span><span class="p">)</span> <span class="p">{</span>
	     <span class="n">assertNotNull</span><span class="p">(</span><span class="n">fruit</span><span class="p">);</span>
	     <span class="n">assertNotEquals</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rank</span><span class="p">);</span>
	 <span class="p">}</span>
</pre></div>

<p>
An empty, quoted value ('') results in an empty String unless
the emptyValue attribute is set; whereas, an entirely empty
value is interpreted as a null reference.
</p>

<p>
Note as well the following parameters that you can set
</p>

<div class="highlight"><pre><span></span>	 <span class="nd">@ParameterizedTest</span>
	 <span class="nd">@CsvSource</span><span class="p">(</span><span class="n">delimiter</span> <span class="o">=</span> <span class="sc">'|'</span><span class="p">,</span> <span class="n">quoteCharacter</span> <span class="o">=</span> <span class="sc">'"'</span><span class="p">,</span> <span class="n">textBlock</span> <span class="o">=</span> <span class="s">"""</span>
<span class="s">	     #-----------------------------</span>
<span class="s">	     #    FRUIT     |     RANK</span>
<span class="s">	     #-----------------------------</span>
<span class="s">		  apple     |      1</span>
<span class="s">	     #-----------------------------</span>
<span class="s">		  banana    |      2</span>
<span class="s">	     #-----------------------------</span>
<span class="s">	       "</span><span class="n">lemon</span> <span class="n">lime</span><span class="s">" |     0xF1</span>
<span class="s">	     #-----------------------------</span>
<span class="s">		strawberry  |    700_000</span>
<span class="s">	     #-----------------------------</span>
<span class="s">	     """</span><span class="p">)</span>
	 <span class="kt">void</span> <span class="nf">testWithCsvSource</span><span class="p">(</span><span class="n">String</span> <span class="n">fruit</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rank</span><span class="p">)</span> <span class="p">{</span>
	     <span class="c1">// ...</span>
	 <span class="p">}</span>
</pre></div>

<ul class="org-ul">
<li>
<p>
<code>@CsvFileSource</code>
</p>

<p>
This lets you use CSV files from the classpath or the local
file system.
</p>

<p>
That is very good to know. Like this you can perform all of
the necessary tests for your different parsers and you can
see immediately if you did break anything before building
or even deploying into UAT etc.
</p>

<p>
Check the following examples
</p>

<div class="highlight"><pre><span></span>	   <span class="nd">@ParameterizedTest</span>
	   <span class="nd">@CsvFileSource</span><span class="p">(</span><span class="n">files</span> <span class="o">=</span> <span class="s">"src/test/resources/two-column.csv"</span><span class="p">,</span> <span class="n">numLinesToSkip</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
	   <span class="kt">void</span> <span class="nf">testWithCsvFileSourceFromFile</span><span class="p">(</span><span class="n">String</span> <span class="n">country</span><span class="p">,</span> <span class="kt">int</span> <span class="n">reference</span><span class="p">)</span> <span class="p">{</span>
	       <span class="n">assertNotNull</span><span class="p">(</span><span class="n">country</span><span class="p">);</span>
	       <span class="n">assertNotEquals</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">reference</span><span class="p">);</span>
	   <span class="p">}</span>

	   <span class="nd">@ParameterizedTest</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"[{index}] {arguments}"</span><span class="p">)</span>
	   <span class="nd">@CsvFileSource</span><span class="p">(</span><span class="n">resources</span> <span class="o">=</span> <span class="s">"/two-column.csv"</span><span class="p">,</span> <span class="n">useHeadersInDisplayName</span> <span class="o">=</span> <span class="kc">true</span><span class="p">)</span>
	   <span class="kt">void</span> <span class="nf">testWithCsvFileSourceAndHeaders</span><span class="p">(</span><span class="n">String</span> <span class="n">country</span><span class="p">,</span> <span class="kt">int</span> <span class="n">reference</span><span class="p">)</span> <span class="p">{</span>
	       <span class="n">assertNotNull</span><span class="p">(</span><span class="n">country</span><span class="p">);</span>
	       <span class="n">assertNotEquals</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">reference</span><span class="p">);</span>
	   <span class="p">}</span>
</pre></div>
</li>

<li>
<p>
<code>@ArgumentsSource</code>
</p>

<p>
Not really understanding the point of this to this stage	   
</p>

<div class="highlight"><pre><span></span>	   <span class="nd">@ParameterizedTest</span>
	   <span class="nd">@ArgumentsSource</span><span class="p">(</span><span class="n">MyArgumentsProvider</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
	   <span class="kt">void</span> <span class="nf">testWithArgumentsSource</span><span class="p">(</span><span class="n">String</span> <span class="n">argument</span><span class="p">)</span> <span class="p">{</span>
	       <span class="n">assertNotNull</span><span class="p">(</span><span class="n">argument</span><span class="p">);</span>
	   <span class="p">}</span>
	   <span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyArgumentsProvider</span> <span class="kd">implements</span> <span class="n">ArgumentsProvider</span> <span class="p">{</span>

	       <span class="nd">@Override</span>
	       <span class="kd">public</span> <span class="n">Stream</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Arguments</span><span class="o">&gt;</span> <span class="nf">provideArguments</span><span class="p">(</span><span class="n">ExtensionContext</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
		   <span class="k">return</span> <span class="n">Stream</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">"apple"</span><span class="p">,</span> <span class="s">"banana"</span><span class="p">).</span><span class="na">map</span><span class="p">(</span><span class="n">Arguments</span><span class="p">::</span><span class="n">of</span><span class="p">);</span>
	       <span class="p">}</span>
	   <span class="p">}</span>
</pre></div>
</li>
</ul>
</li>
</ul>
</div>
</li>


<li>
<a id="orga265587"></a>On implicit argument passsing<br><div class="outline-text-7" id="text-orga265587">
<p>
Note the following example. There are a couple of defaults. 
</p>

<p>
I.e. for instance the below uses the concept of <i>factory
method</i> and <i>factory classes</i> mentioned before.
</p>

<p>
So you can see for instance that in the below there is a
<i>factory method</i> fromTitle. Note that it is <code>static</code> and
non-private. 
</p>

<p>
Note now the following <b>fallback</b> mechanism:
</p>

<blockquote>
<p>
See blow you have a string parameter that you pass with
ValueSource.
</p>

<p>
Then the idea is:
</p>

<p>
for automatic conversion from a String to a given target type
if the target type declares <i>exactly one</i> suitable factory method
or a factory constructor as defined below - see that it has the
String argument and there is a match in this sense -. 
</p>
</blockquote>

<div class="highlight"><pre><span></span>       <span class="nd">@ParameterizedTest</span>
       <span class="nd">@ValueSource</span><span class="p">(</span><span class="n">strings</span> <span class="o">=</span> <span class="s">"42 Cats"</span><span class="p">)</span>
       <span class="kt">void</span> <span class="nf">testWithImplicitFallbackArgumentConversion</span><span class="p">(</span><span class="n">Book</span> <span class="n">book</span><span class="p">)</span> <span class="p">{</span>
	   <span class="n">assertEquals</span><span class="p">(</span><span class="s">"42 Cats"</span><span class="p">,</span> <span class="n">book</span><span class="p">.</span><span class="na">getTitle</span><span class="p">());</span>
       <span class="p">}</span>
       <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Book</span> <span class="p">{</span>

	   <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">title</span><span class="p">;</span>

	   <span class="kd">private</span> <span class="nf">Book</span><span class="p">(</span><span class="n">String</span> <span class="n">title</span><span class="p">)</span> <span class="p">{</span>
	       <span class="k">this</span><span class="p">.</span><span class="na">title</span> <span class="o">=</span> <span class="n">title</span><span class="p">;</span>
	   <span class="p">}</span>

	   <span class="kd">public</span> <span class="kd">static</span> <span class="n">Book</span> <span class="nf">fromTitle</span><span class="p">(</span><span class="n">String</span> <span class="n">title</span><span class="p">)</span> <span class="p">{</span>
	       <span class="k">return</span> <span class="k">new</span> <span class="n">Book</span><span class="p">(</span><span class="n">title</span><span class="p">);</span>
	   <span class="p">}</span>

	   <span class="kd">public</span> <span class="n">String</span> <span class="nf">getTitle</span><span class="p">()</span> <span class="p">{</span>
	       <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="na">title</span><span class="p">;</span>
	   <span class="p">}</span>
       <span class="p">}</span> 
</pre></div>
</div>
</li>

<li>
<a id="org7e43925"></a>On Explicit Argument Passing<br><div class="outline-text-7" id="text-org7e43925">
<p>
Note that the above can as well be stated in a more torough and
complete way as follows:
</p>

<div class="highlight"><pre><span></span>       <span class="nd">@ParameterizedTest</span>
       <span class="nd">@EnumSource</span><span class="p">(</span><span class="n">ChronoUnit</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
       <span class="kt">void</span> <span class="nf">testWithExplicitArgumentConversion</span><span class="p">(</span>
	       <span class="nd">@ConvertWith</span><span class="p">(</span><span class="n">ToStringArgumentConverter</span><span class="p">.</span><span class="na">class</span><span class="p">)</span> <span class="n">String</span> <span class="n">argument</span><span class="p">)</span> <span class="p">{</span>

	   <span class="n">assertNotNull</span><span class="p">(</span><span class="n">ChronoUnit</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">argument</span><span class="p">));</span>
       <span class="p">}</span>
       <span class="kd">public</span> <span class="kd">class</span> <span class="nc">ToStringArgumentConverter</span> <span class="kd">extends</span> <span class="n">SimpleArgumentConverter</span> <span class="p">{</span>

	   <span class="nd">@Override</span>
	   <span class="kd">protected</span> <span class="n">Object</span> <span class="nf">convert</span><span class="p">(</span><span class="n">Object</span> <span class="n">source</span><span class="p">,</span> <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">targetType</span><span class="p">)</span> <span class="p">{</span>
	       <span class="n">assertEquals</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">targetType</span><span class="p">,</span> <span class="s">"Can only convert to String"</span><span class="p">);</span>
	       <span class="k">if</span> <span class="p">(</span><span class="n">source</span> <span class="k">instanceof</span> <span class="n">Enum</span><span class="o">&lt;?&gt;</span><span class="p">)</span> <span class="p">{</span>
		   <span class="k">return</span> <span class="p">((</span><span class="n">Enum</span><span class="o">&lt;?&gt;</span><span class="p">)</span> <span class="n">source</span><span class="p">).</span><span class="na">name</span><span class="p">();</span>
	       <span class="p">}</span>
	       <span class="k">return</span> <span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
	   <span class="p">}</span>
       <span class="p">}</span>
</pre></div>
</div>
</li>



<li>
<a id="org4f3d497"></a><span class="todo TODO">TODO</span> double check when you have time - could not understand when reading<br><div class="outline-text-7" id="text-org4f3d497">
<p>
Note that there is quite a few things that you will need to
make sense of when you have time.
</p>

<p>
In the notes they talk about <code>@TestImplementation</code> etc. also in
the context of Parameterized tests.
</p>

<p>
Moreover, they talk about the ordering of the parameters and
of some <code>@AggregateWith</code> annotator. Double check the entire
thing when you have time.
</p>
</div>
</li>

<li>
<a id="orgb5a9304"></a><span class="todo TODO">TODO</span> understand better this and Mockito<br><div class="outline-text-7" id="text-orgb5a9304">
<ul class="org-ul">
<li>
<p>
difference with Mockito… might seem trivial to the user
that has a strong clue about it. I do not have one so we will
see. How do you supply things there that are not working
here? 
</p>

<p>
what is missing etc.?
</p>
</li>
</ul>
</div>
</li>

<li>
<a id="orgd8c1831"></a><span class="todo TODO">TODO</span> better understand the @ArgumentsSource method<br>
</li>
</ul>
</li>
</ul>
</li>


<li>
<a id="org59b04b7"></a>Tagging<br><ul class="org-ul">
<li>
<a id="orge5aee79"></a>@Tag<br><div class="outline-text-6" id="text-orge5aee79">
<p>
Test classes and methods can be tagged via the @Tag
annotation. Those tags can later be used to filter test discovery
and execution.
</p>

<p>
Such annotations are inherited at the class level but not at the
method level. 
</p>
</div>
</li>
</ul>
</li>


<li>
<a id="org753a14d"></a>Naming and UI Style Annotations<br><div class="outline-text-5" id="text-org753a14d">
<p>
This are used for setting the naming of your test methods.
</p>

<p>
You can set naming through such annotators and organize
everything in such a way the standard output of running the
tests. That will be required in order to keep order when things
will grow large.
</p>

<p>
Consider the following good example:
</p>

<div class="highlight"><pre><span></span>     <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.DisplayName</span><span class="p">;</span>
     <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.DisplayNameGeneration</span><span class="p">;</span>
     <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.DisplayNameGenerator</span><span class="p">;</span>
     <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.IndicativeSentencesGeneration</span><span class="p">;</span>
     <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Nested</span><span class="p">;</span>
     <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="p">;</span>
     <span class="kn">import</span> <span class="nn">org.junit.jupiter.params.ParameterizedTest</span><span class="p">;</span>
     <span class="kn">import</span> <span class="nn">org.junit.jupiter.params.provider.ValueSource</span><span class="p">;</span>

     <span class="kd">class</span> <span class="nc">DisplayNameGeneratorDemo</span> <span class="p">{</span>

	 <span class="nd">@Nested</span>
	 <span class="nd">@DisplayNameGeneration</span><span class="p">(</span><span class="n">DisplayNameGenerator</span><span class="p">.</span><span class="na">ReplaceUnderscores</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
	 <span class="kd">class</span> <span class="nc">A_year_is_not_supported</span> <span class="p">{</span>

	     <span class="nd">@Test</span>
	     <span class="kt">void</span> <span class="nf">if_it_is_zero</span><span class="p">()</span> <span class="p">{</span>
	     <span class="p">}</span>

	     <span class="nd">@DisplayName</span><span class="p">(</span><span class="s">"A negative value for year is not supported by the leap year computation."</span><span class="p">)</span>
	     <span class="nd">@ParameterizedTest</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"For example, year {0} is not supported."</span><span class="p">)</span>
	     <span class="nd">@ValueSource</span><span class="p">(</span><span class="n">ints</span> <span class="o">=</span> <span class="p">{</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span> <span class="p">})</span>
	     <span class="kt">void</span> <span class="nf">if_it_is_negative</span><span class="p">(</span><span class="kt">int</span> <span class="n">year</span><span class="p">)</span> <span class="p">{</span>
	     <span class="p">}</span>

	 <span class="p">}</span>

	 <span class="nd">@Nested</span>
	 <span class="nd">@IndicativeSentencesGeneration</span><span class="p">(</span><span class="n">separator</span> <span class="o">=</span> <span class="s">" -&gt; "</span><span class="p">,</span> <span class="n">generator</span> <span class="o">=</span> <span class="n">DisplayNameGenerator</span><span class="p">.</span><span class="na">ReplaceUnderscores</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
	 <span class="kd">class</span> <span class="nc">A_year_is_a_leap_year</span> <span class="p">{</span>

	     <span class="nd">@Test</span>
	     <span class="kt">void</span> <span class="nf">if_it_is_divisible_by_4_but_not_by_100</span><span class="p">()</span> <span class="p">{</span>
	     <span class="p">}</span>

	     <span class="nd">@ParameterizedTest</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"Year {0} is a leap year."</span><span class="p">)</span>
	     <span class="nd">@ValueSource</span><span class="p">(</span><span class="n">ints</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">2016</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2048</span> <span class="p">})</span>
	     <span class="kt">void</span> <span class="nf">if_it_is_one_of_the_following_years</span><span class="p">(</span><span class="kt">int</span> <span class="n">year</span><span class="p">)</span> <span class="p">{</span>
	     <span class="p">}</span>

	 <span class="p">}</span>

     <span class="p">}</span>
</pre></div>

<p>
So based on the above you can easily infer the following rules.
</p>
</div>

<ul class="org-ul">
<li>
<a id="org657dbd3"></a>Index<br><div class="outline-text-6" id="text-org657dbd3">
<ul class="org-ul">
<li><a href="#org816e28a">@DisplayName</a></li>
<li><a href="#orga8644b0">@DisplayNameGeneration</a></li>
<li><a href="#org70928ab">@IndicativeSentencesGeneration</a></li>
<li><a href="#orgad0c0e8">@Nested</a></li>
</ul>
</div>
</li>


<li>
<a id="org816e28a"></a>@DisplayName<br><div class="outline-text-6" id="text-org816e28a">
<p>
Declares a custom display name for the test class or test method. Such
annotations are not inherited.
</p>

<p>
Note that if such an annotator is not used you will work with
the default method name. See for instance the method
<code>if_it_is_zero</code> and the result as above:
</p>

<blockquote>
<p>
if it is zero() [OK]
</p>
</blockquote>
</div>
</li>

<li>
<a id="orga8644b0"></a>@DisplayNameGeneration<br><div class="outline-text-6" id="text-orga8644b0">
<p>
Declares a custom display name generator for the test class. Such
annotations are inherited.
</p>

<p>
Sets some general standards for the naming to be returned by the
methods. Nothing too fancy above but see again how the method
<code>if_it_is_zero</code> with underscores was replaced with spaced in
the output in the example above.
</p>
</div>
</li>

<li>
<a id="org70928ab"></a>@IndicativeSentencesGeneration<br><div class="outline-text-6" id="text-org70928ab">
<p>
Sets some standards for displaying the hierarchy. I think this
is especially important / might be especially important.
</p>
</div>
</li>

<li>
<a id="orgad0c0e8"></a>@Nested<br><div class="outline-text-6" id="text-orgad0c0e8">
<p>
This basically creates the hieararchical structure that you will
ultimately see on your GUI. It will help to structure your tests
in a meaningful way in this sense.
</p>

<p>
Denotes that the annotated class is a non-static nested test
class. @BeforeAll and @AfterAll methods cannot be used directly in a
@Nested test class unless the "per-class" test instance lifecycle is
used. Such annotations are not inherited.
</p>
</div>
</li>
</ul>
</li>


<li>
<a id="org24e9f08"></a>LifeCycle Annotations<br><ul class="org-ul">
<li>
<a id="org6d7568d"></a>Index<br><div class="outline-text-6" id="text-org6d7568d">
<ul class="org-ul">
<li><a href="#org1d679bf">Tests Lifecycle</a></li>
<li><a href="#org25a772b">@BeforeEach</a></li>
<li><a href="#orge1da4d4">@AfterEach</a></li>
<li><a href="#org6ad8132">@BeforeAll</a></li>
<li><a href="#org3995eb3">@AfterAll</a></li>
<li><a href="#org7e02e7b">@Disabled</a></li>
<li><a href="#org37f9622">@TestInstance</a></li>
<li><a href="#org5ecbeae">@TestMethodOrder</a></li>
<li><a href="#orga857e8f">@TestClassOrder</a></li>
</ul>
</div>
</li>

<li>
<a id="org1d679bf"></a>Tests Lifecycle<br><div class="outline-text-6" id="text-org1d679bf">
<p>
In order to proper understand testing lifecycle you can check at
the following 101 test-example.
</p>

<p>
Next you have all of the basics standard types of tests.
</p>

<p>
Basic to understand then how that works. Trivial.
</p>

<div class="highlight"><pre><span></span>      <span class="kn">import static</span> <span class="nn">org.junit.jupiter.api.Assertions.fail</span><span class="p">;</span>
      <span class="kn">import static</span> <span class="nn">org.junit.jupiter.api.Assumptions.assumeTrue</span><span class="p">;</span>

      <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.AfterAll</span><span class="p">;</span>
      <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.AfterEach</span><span class="p">;</span>
      <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.BeforeAll</span><span class="p">;</span>
      <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.BeforeEach</span><span class="p">;</span>
      <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Disabled</span><span class="p">;</span>
      <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="p">;</span>

      <span class="kd">class</span> <span class="nc">StandardTests</span> <span class="p">{</span>

	  <span class="nd">@BeforeAll</span>
	  <span class="kd">static</span> <span class="kt">void</span> <span class="nf">initAll</span><span class="p">()</span> <span class="p">{</span>
	  <span class="p">}</span>

	  <span class="nd">@BeforeEach</span>
	  <span class="kt">void</span> <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
	  <span class="p">}</span>

	  <span class="nd">@Test</span>
	  <span class="kt">void</span> <span class="nf">succeedingTest</span><span class="p">()</span> <span class="p">{</span>
	  <span class="p">}</span>

	  <span class="nd">@Test</span>
	  <span class="kt">void</span> <span class="nf">failingTest</span><span class="p">()</span> <span class="p">{</span>
	      <span class="n">fail</span><span class="p">(</span><span class="s">"a failing test"</span><span class="p">);</span>
	  <span class="p">}</span>

	  <span class="nd">@Test</span>
	  <span class="nd">@Disabled</span><span class="p">(</span><span class="s">"for demonstration purposes"</span><span class="p">)</span>
	  <span class="kt">void</span> <span class="nf">skippedTest</span><span class="p">()</span> <span class="p">{</span>
	      <span class="c1">// not executed</span>
	  <span class="p">}</span>

	  <span class="nd">@Test</span>
	  <span class="kt">void</span> <span class="nf">abortedTest</span><span class="p">()</span> <span class="p">{</span>
	      <span class="n">assumeTrue</span><span class="p">(</span><span class="s">"abc"</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="s">"Z"</span><span class="p">));</span>
	      <span class="n">fail</span><span class="p">(</span><span class="s">"test should have been aborted"</span><span class="p">);</span>
	  <span class="p">}</span>

	  <span class="nd">@AfterEach</span>
	  <span class="kt">void</span> <span class="nf">tearDown</span><span class="p">()</span> <span class="p">{</span>
	  <span class="p">}</span>

	  <span class="nd">@AfterAll</span>
	  <span class="kd">static</span> <span class="kt">void</span> <span class="nf">tearDownAll</span><span class="p">()</span> <span class="p">{</span>
	  <span class="p">}</span>

      <span class="p">}</span>
</pre></div>
</div>
</li>

<li>
<a id="org25a772b"></a>@BeforeEach<br><div class="outline-text-6" id="text-org25a772b">
<p>
Denotes that the annotated method should be executed before each
@Test, @RepeatedTest, @ParameterizedTest, or @TestFactory method in
the current class; analogous to JUnit 4’s @Before. Such methods are
inherited unless they are overridden. 
</p>
</div>
</li>

<li>
<a id="orge1da4d4"></a>@AfterEach<br><div class="outline-text-6" id="text-orge1da4d4">
<p>
Denotes that the annotated method should be executed after each @Test,
@RepeatedTest, @ParameterizedTest, or @TestFactory method in the
current class; analogous to JUnit 4’s @After. Such methods are
inherited unless they are overridden. 
</p>
</div>
</li>

<li>
<a id="org6ad8132"></a>@BeforeAll<br><div class="outline-text-6" id="text-org6ad8132">
<p>
Denotes that the annotated method should be executed before all @Test,
@RepeatedTest, @ParameterizedTest, and @TestFactory methods in the
current class; analogous to JUnit 4’s @BeforeClass. Such methods are
inherited (unless they are hidden or overridden) and must be static
(unless the "per-class" test instance lifecycle is used). 
</p>
</div>
</li>

<li>
<a id="org3995eb3"></a>@AfterAll<br><div class="outline-text-6" id="text-org3995eb3">
<p>
Denotes that the annotated method should be executed after all @Test,
@RepeatedTest, @ParameterizedTest, and @TestFactory methods in the
current class; analogous to JUnit 4’s @AfterClass. Such methods are
inherited (unless they are hidden or overridden) and must be static
(unless the "per-class" test instance lifecycle is used). 
</p>
</div>
</li>

<li>
<a id="org7e02e7b"></a>@Disabled<br><div class="outline-text-6" id="text-org7e02e7b">
<p>
Simple tag to disable a particular test.
</p>

<p>
Say for instance
</p>

<div class="highlight"><pre><span></span>      <span class="nd">@Disabled</span><span class="p">(</span><span class="s">"Disabled until bug #99 has been fixed"</span><span class="p">)</span>
</pre></div>

<p>
Note that there are some extensions in order to condtionally
disable. You can check at it online on the official
documentation. There you have the correct reference.                  
</p>
</div>
</li>


<li>
<a id="org37f9622"></a><span class="todo TODO">TODO</span> @TestInstance<br><div class="outline-text-6" id="text-org37f9622">
<p>
Used to configure the test instance lifecycle for the annotated test
class. Such annotations are inherited.
</p>

<p>
This is more interesting for <code>integration</code> and <code>functional</code>
tests. Basically you can specify there the lifecycle of the
thing.
</p>

<p>
Study it later at a later time-point.
</p>
</div>
</li>

<li>
<a id="org5ecbeae"></a><span class="todo TODO">TODO</span> @TestMethodOrder<br><div class="outline-text-6" id="text-org5ecbeae">
<p>
Used as well to
</p>

<p>
Used to configure the test method execution order for the annotated
test class; similar to JUnit 4’s @FixMethodOrder. Such annotations are
inherited. 
</p>
</div>
</li>


<li>
<a id="orga857e8f"></a><span class="todo TODO">TODO</span> @TestClassOrder<br><div class="outline-text-6" id="text-orga857e8f">
<p>
Used to configure the test class execution order for @Nested test
classes in the annotated test class. Such annotations are inherited.
</p>
</div>
</li>
</ul>
</li>


<li>
<a id="org13b1805"></a>Templates - @TestTemplate<br><div class="outline-text-5" id="text-org13b1805">
<p>
It is essentially possible as well to write template tests. 
</p>

<p>
These will not be run in the normal way but will rather be
invoked by <code>TestTemplateInvocationContextProvider</code> extension.
</p>

<p>
So have to understand that better.
</p>

<p>
Note in any case that:
</p>

<blockquote>
<p>
Each invocation of a test template method behaves like the
execution of a regular @Test method with full support for the
same lifecycle callbacks and extensions. 
</p>
</blockquote>
</div>

<ul class="org-ul">
<li>
<a id="org2714c40"></a><span class="todo TODO">TODO</span> understand TestTemplateInvocationContextProvider better<br><div class="outline-text-6" id="text-org2714c40">
<p>
check <a href="https://junit.org/junit5/docs/current/user-guide/#extensions-test-templates">this</a> in this sense.
</p>
</div>
</li>
</ul>
</li>


<li>
<a id="org4205ca2"></a>Dynamic Testing<br><div class="outline-text-5" id="text-org4205ca2">
<p>
See the following to understand these:
</p>

<blockquote>
<p>
<code>@Test</code>: These test cases are static in the sense that they are
<i>fully specified at compile time</i>, and their behavior cannot be
changed by anything happening at runtime. 
Assumptions provide a basic form of dynamic behavior but are
intentionally rather <b>limited in their expressiveness</b>. 
</p>
</blockquote>

<p>
In order to enrich the testing environment you have now the
introction of <code>dynamic test</code> in Junit.
</p>

<p>
These is a kind of test that is generated <b>at runtime</b> by a factory
method that is annotated with <a href="#orgc0e9718">@TestFactory</a>.
</p>
</div>

<ul class="org-ul">
<li>
<a id="org891112b"></a>Index<br><div class="outline-text-6" id="text-org891112b">
<ul class="org-ul">
<li><a href="#orgc0e9718">@TestFactory</a></li>
<li><a href="#org258dcce">Examples</a></li>
</ul>
</div>
</li>

<li>
<a id="orgc0e9718"></a>@TestFactory<br><div class="outline-text-6" id="text-orgc0e9718">
<p>
Denotes that a <b>method is a test factory</b> for dynamic tests. 
</p>

<p>
So essentially the idea is similar to the one of TestTemplates
in the sense that methods annotated as such are not standard
test case. 
</p>

<blockquote>
<p>
@TestFactory method is not itself a test case but rather a
factory for test cases. 
</p>
</blockquote>

<p>
Technically speaking, a <code>@TestFactory</code> method must return a
single DynamicNode or a Stream, Collection, Iterable, Iterator,
or array of DynamicNode instances.
</p>

<p>
Note that <code>DynamicContainer</code> and <code>DynamicTest</code> are subclasses of
<code>DynamicNode</code>. 
</p>

<p>
Understand now the two:
</p>

<ul class="org-ul">
<li>
<code>DynamicContainer</code> instances are composed of a display name and
a list of dynamic child nodes, enabling the creation of
arbitrarily nested hierarchies of dynamic nodes.</li>

<li>
<code>DynamicTest</code> instances will be executed lazily, enabling
dynamic and even non-deterministic generation of test cases.</li>
</ul>
<p>
Note as well the following: 
</p>

<p>
Any Stream returned by a @TestFactory <i>will be properly closed</i>
by calling <code>stream.close()</code>, making it safe to use a resource
such as Files.lines().
</p>

<p>
<b>Important</b> is as well to understand the following:
</p>

<blockquote>
<p>
A DynamicTest is a test case generated at runtime. It is
composed of a display name and an Executable. <b>Executable</b> is a
<code>@FunctionalInterface</code> which means that the implementations of
dynamic tests can be provided as <b>lambda expressions</b> or <b>method
references</b>. 
</p>
</blockquote>

<p>
So that is it. See the examples in the next section. You see in
fact that you specify lambda functions in order to interact with
that functional interface.
</p>

<p>
One last <b>very important remark</b>:
</p>

<blockquote>
<p>
!!!
The execution lifecycle of a dynamic test is quite different than it
is for a standard @Test case. Specifically, there are <i>no lifecycle
callbacks</i> for individual dynamic tests. This means that @BeforeEach
and @AfterEach methods and their corresponding extension callbacks are
executed for the @TestFactory method but not for each dynamic test.  
!!!
</p>
</blockquote>

<p>
Finally, note that such methods are inherited unless they are
overridden. 
</p>
</div>
</li>

<li>
<a id="org258dcce"></a>Examples<br><div class="outline-text-6" id="text-org258dcce">
<p>
Try to go with the following:
</p>

<div class="highlight"><pre><span></span>       <span class="kn">import static</span> <span class="nn">example.util.StringUtils.isPalindrome</span><span class="p">;</span>
       <span class="kn">import static</span> <span class="nn">org.junit.jupiter.api.Assertions.assertEquals</span><span class="p">;</span>
       <span class="kn">import static</span> <span class="nn">org.junit.jupiter.api.Assertions.assertFalse</span><span class="p">;</span>
       <span class="kn">import static</span> <span class="nn">org.junit.jupiter.api.Assertions.assertNotNull</span><span class="p">;</span>
       <span class="kn">import static</span> <span class="nn">org.junit.jupiter.api.Assertions.assertTrue</span><span class="p">;</span>
       <span class="kn">import static</span> <span class="nn">org.junit.jupiter.api.DynamicContainer.dynamicContainer</span><span class="p">;</span>
       <span class="kn">import static</span> <span class="nn">org.junit.jupiter.api.DynamicTest.dynamicTest</span><span class="p">;</span>
       <span class="kn">import static</span> <span class="nn">org.junit.jupiter.api.Named.named</span><span class="p">;</span>

       <span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="p">;</span>
       <span class="kn">import</span> <span class="nn">java.util.Collection</span><span class="p">;</span>
       <span class="kn">import</span> <span class="nn">java.util.Iterator</span><span class="p">;</span>
       <span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>
       <span class="kn">import</span> <span class="nn">java.util.Random</span><span class="p">;</span>
       <span class="kn">import</span> <span class="nn">java.util.function.Function</span><span class="p">;</span>
       <span class="kn">import</span> <span class="nn">java.util.stream.IntStream</span><span class="p">;</span>
       <span class="kn">import</span> <span class="nn">java.util.stream.Stream</span><span class="p">;</span>

       <span class="kn">import</span> <span class="nn">example.util.Calculator</span><span class="p">;</span>

       <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.DynamicNode</span><span class="p">;</span>
       <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.DynamicTest</span><span class="p">;</span>
       <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Named</span><span class="p">;</span>
       <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Tag</span><span class="p">;</span>
       <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.TestFactory</span><span class="p">;</span>
       <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.function.ThrowingConsumer</span><span class="p">;</span>

       <span class="kd">class</span> <span class="nc">DynamicTestsDemo</span> <span class="p">{</span>

	   <span class="kd">private</span> <span class="kd">final</span> <span class="n">Calculator</span> <span class="n">calculator</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Calculator</span><span class="p">();</span>

	   <span class="c1">// This will result in a JUnitException!</span>
	   <span class="c1">// if you check at the error - is says that @TestFactory must return a single </span>
	   <span class="c1">// one of </span>
	   <span class="nd">@TestFactory</span>
	   <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">dynamicTestsWithInvalidReturnType</span><span class="p">()</span> <span class="p">{</span>
	       <span class="k">return</span> <span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="s">"Hello"</span><span class="p">);</span> 
	   <span class="p">}</span>

	   <span class="c1">// So se how it reference a dynamicTest. So that is fine. </span>
	   <span class="c1">// note the return type. Collection here.</span>
	   <span class="c1">// note that there is nothing dynamic in here. it is just to illustrate how it works with</span>
	   <span class="c1">// the return types. </span>
	   <span class="c1">// Note that usually the dynamic compoenent would come from performing the test in a dynamic</span>
	   <span class="c1">// way by dynamically testing the values within the collection.</span>
	   <span class="nd">@TestFactory</span>
	   <span class="n">Collection</span><span class="o">&lt;</span><span class="n">DynamicTest</span><span class="o">&gt;</span> <span class="nf">dynamicTestsFromCollection</span><span class="p">()</span> <span class="p">{</span>
	       <span class="k">return</span> <span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span>
		   <span class="n">dynamicTest</span><span class="p">(</span><span class="s">"1st dynamic test"</span><span class="p">,</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="p">(</span><span class="n">isPalindrome</span><span class="p">(</span><span class="s">"madam"</span><span class="p">))),</span>
		   <span class="n">dynamicTest</span><span class="p">(</span><span class="s">"2nd dynamic test"</span><span class="p">,</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">assertEquals</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">calculator</span><span class="p">.</span><span class="na">multiply</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
	       <span class="p">);</span>
	   <span class="p">}</span>

	   <span class="c1">// Note the return type in here: Iterable. </span>
	   <span class="c1">// So you see that if you return an Object such an array that is both a Collection and</span>
	   <span class="c1">// an Iterable you are free to specify the two return types.</span>
	   <span class="nd">@TestFactory</span>
	   <span class="n">Iterable</span><span class="o">&lt;</span><span class="n">DynamicTest</span><span class="o">&gt;</span> <span class="nf">dynamicTestsFromIterable</span><span class="p">()</span> <span class="p">{</span>
	       <span class="k">return</span> <span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span>
		   <span class="n">dynamicTest</span><span class="p">(</span><span class="s">"3rd dynamic test"</span><span class="p">,</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="p">(</span><span class="n">isPalindrome</span><span class="p">(</span><span class="s">"madam"</span><span class="p">))),</span>
		   <span class="n">dynamicTest</span><span class="p">(</span><span class="s">"4th dynamic test"</span><span class="p">,</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">assertEquals</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">calculator</span><span class="p">.</span><span class="na">multiply</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
	       <span class="p">);</span>
	   <span class="p">}</span>

	   <span class="c1">// Again nothing fancy - just here for completeness in order to see possible reutrn types</span>
	   <span class="c1">// An Iterable is a simple representation of a series of elements that can be iterated over. </span>
	   <span class="c1">// It does not have any iteration state such as a "current element". Instead, </span>
	   <span class="c1">// it has one method that produces an Iterator.</span>

	   <span class="c1">// An Iterator is the object with iteration state. </span>
	   <span class="c1">// It lets you check if it has more elements using hasNext() </span>
	   <span class="c1">// and move to the next element (if any) using next(). </span>
	   <span class="nd">@TestFactory</span>
	   <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">DynamicTest</span><span class="o">&gt;</span> <span class="nf">dynamicTestsFromIterator</span><span class="p">()</span> <span class="p">{</span>
	       <span class="k">return</span> <span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span>
		   <span class="n">dynamicTest</span><span class="p">(</span><span class="s">"5th dynamic test"</span><span class="p">,</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="p">(</span><span class="n">isPalindrome</span><span class="p">(</span><span class="s">"madam"</span><span class="p">))),</span>
		   <span class="n">dynamicTest</span><span class="p">(</span><span class="s">"6th dynamic test"</span><span class="p">,</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">assertEquals</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">calculator</span><span class="p">.</span><span class="na">multiply</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
	       <span class="p">).</span><span class="na">iterator</span><span class="p">();</span>
	   <span class="p">}</span>


	   <span class="nd">@TestFactory</span>
	   <span class="n">DynamicTest</span><span class="o">[]</span> <span class="nf">dynamicTestsFromArray</span><span class="p">()</span> <span class="p">{</span>
	       <span class="k">return</span> <span class="k">new</span> <span class="n">DynamicTest</span><span class="o">[]</span> <span class="p">{</span>
		   <span class="n">dynamicTest</span><span class="p">(</span><span class="s">"7th dynamic test"</span><span class="p">,</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="p">(</span><span class="n">isPalindrome</span><span class="p">(</span><span class="s">"madam"</span><span class="p">))),</span>
		   <span class="n">dynamicTest</span><span class="p">(</span><span class="s">"8th dynamic test"</span><span class="p">,</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">assertEquals</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">calculator</span><span class="p">.</span><span class="na">multiply</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
	       <span class="p">};</span>
	   <span class="p">}</span>

	   <span class="c1">// Here you actually see the dynamic component of the tests. </span>
	   <span class="c1">// Note not everything is fixed at compile time. </span>
	   <span class="c1">// At runtime actually the tests execute by passing the stream.</span>
	   <span class="c1">// A stream is also returned.</span>
	   <span class="nd">@TestFactory</span>
	   <span class="n">Stream</span><span class="o">&lt;</span><span class="n">DynamicTest</span><span class="o">&gt;</span> <span class="nf">dynamicTestsFromStream</span><span class="p">()</span> <span class="p">{</span>
	       <span class="k">return</span> <span class="n">Stream</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">"racecar"</span><span class="p">,</span> <span class="s">"radar"</span><span class="p">,</span> <span class="s">"mom"</span><span class="p">,</span> <span class="s">"dad"</span><span class="p">)</span>
		   <span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">text</span> <span class="o">-&gt;</span> <span class="n">dynamicTest</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="p">(</span><span class="n">isPalindrome</span><span class="p">(</span><span class="n">text</span><span class="p">))));</span>
	   <span class="p">}</span>

	   <span class="c1">// See the following example of dynamic behaviour with a collection result.</span>
	   <span class="c1">// so you see that the returning method is the key.</span>
	   <span class="c1">// usually you do not work with such conversion. Not good practice. </span>
	   <span class="c1">// The practice is to have the return type as the object type you pass to be dynamically tested.   </span>
	   <span class="nd">@TestFactory</span>
	   <span class="n">Collection</span><span class="o">&lt;</span><span class="n">DynamicTest</span><span class="o">&gt;</span> <span class="nf">dynamicTestsFromStreamtoCollection</span><span class="p">()</span> <span class="p">{</span>
	       <span class="k">return</span> <span class="n">Stream</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">"racecar"</span><span class="p">,</span> <span class="s">"radar"</span><span class="p">,</span> <span class="s">"mom"</span><span class="p">,</span> <span class="s">"dad"</span><span class="p">)</span>
		   <span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">text</span> <span class="o">-&gt;</span> <span class="n">dynamicTest</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="p">(</span><span class="n">text</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">"hello"</span><span class="p">))))</span>
		   <span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">());</span>
	   <span class="p">}</span>


	   <span class="nd">@TestFactory</span>
	   <span class="n">Stream</span><span class="o">&lt;</span><span class="n">DynamicTest</span><span class="o">&gt;</span> <span class="nf">dynamicTestsFromIntStream</span><span class="p">()</span> <span class="p">{</span>
	       <span class="c1">// Generates tests for the first 10 even integers.</span>
	       <span class="k">return</span> <span class="n">IntStream</span><span class="p">.</span><span class="na">iterate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">-&gt;</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="p">).</span><span class="na">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
		   <span class="p">.</span><span class="na">mapToObj</span><span class="p">(</span><span class="n">n</span> <span class="o">-&gt;</span> <span class="n">dynamicTest</span><span class="p">(</span><span class="s">"test"</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)));</span>
	   <span class="p">}</span>

	   <span class="nd">@TestFactory</span>
	   <span class="n">Stream</span><span class="o">&lt;</span><span class="n">DynamicTest</span><span class="o">&gt;</span> <span class="nf">generateRandomNumberOfTestsFromIterator</span><span class="p">()</span> <span class="p">{</span>

	       <span class="c1">// Generates random positive integers between 0 and 100 until</span>
	       <span class="c1">// a number evenly divisible by 7 is encountered.</span>
	       <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">inputGenerator</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="p">()</span> <span class="p">{</span>

		   <span class="n">Random</span> <span class="n">random</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Random</span><span class="p">();</span>
		   <span class="kt">int</span> <span class="n">current</span><span class="p">;</span>

		   <span class="nd">@Override</span>
		   <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasNext</span><span class="p">()</span> <span class="p">{</span>
		       <span class="n">current</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="na">nextInt</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
		       <span class="k">return</span> <span class="n">current</span> <span class="o">%</span> <span class="mi">7</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span>
		   <span class="p">}</span>

		   <span class="nd">@Override</span>
		   <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">next</span><span class="p">()</span> <span class="p">{</span>
		       <span class="k">return</span> <span class="n">current</span><span class="p">;</span>
		   <span class="p">}</span>
	       <span class="p">};</span>

	       <span class="c1">// Generates display names like: input:5, input:37, input:85, etc.</span>
	       <span class="n">Function</span><span class="o">&lt;</span><span class="n">Integer</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">displayNameGenerator</span> <span class="o">=</span> <span class="p">(</span><span class="n">input</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s">"input:"</span> <span class="o">+</span> <span class="n">input</span><span class="p">;</span>

	       <span class="c1">// Executes tests based on the current input value.</span>
	       <span class="n">ThrowingConsumer</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">testExecutor</span> <span class="o">=</span> <span class="p">(</span><span class="n">input</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="p">(</span><span class="n">input</span> <span class="o">%</span> <span class="mi">7</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">);</span>

	       <span class="c1">// Returns a stream of dynamic tests.</span>
	       <span class="k">return</span> <span class="n">DynamicTest</span><span class="p">.</span><span class="na">stream</span><span class="p">(</span><span class="n">inputGenerator</span><span class="p">,</span> <span class="n">displayNameGenerator</span><span class="p">,</span> <span class="n">testExecutor</span><span class="p">);</span>
	   <span class="p">}</span>


	   <span class="cm">/** Lovely to see such stream of tests. Very nice way to program in a way </span>
<span class="cm">	    *  where it is easy to keep the overview. Nice.</span>
<span class="cm">	    */</span>
	   <span class="nd">@TestFactory</span>
	   <span class="n">Stream</span><span class="o">&lt;</span><span class="n">DynamicTest</span><span class="o">&gt;</span> <span class="nf">dynamicTestsFromStreamFactoryMethod</span><span class="p">()</span> <span class="p">{</span>
	       <span class="c1">// Stream of palindromes to check</span>
	       <span class="n">Stream</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">"racecar"</span><span class="p">,</span> <span class="s">"radar"</span><span class="p">,</span> <span class="s">"mom"</span><span class="p">,</span> <span class="s">"dad"</span><span class="p">);</span>

	       <span class="c1">// Generates display names like: racecar is a palindrome</span>
	       <span class="n">Function</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">displayNameGenerator</span> <span class="o">=</span> <span class="n">text</span> <span class="o">-&gt;</span> <span class="n">text</span> <span class="o">+</span> <span class="s">" is a palindrome"</span><span class="p">;</span>

	       <span class="c1">// Executes tests based on the current input value.</span>
	       <span class="n">ThrowingConsumer</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">testExecutor</span> <span class="o">=</span> <span class="n">text</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="p">(</span><span class="n">isPalindrome</span><span class="p">(</span><span class="n">text</span><span class="p">));</span>

	       <span class="c1">// Returns a stream of dynamic tests.</span>
	       <span class="k">return</span> <span class="n">DynamicTest</span><span class="p">.</span><span class="na">stream</span><span class="p">(</span><span class="n">inputStream</span><span class="p">,</span> <span class="n">displayNameGenerator</span><span class="p">,</span> <span class="n">testExecutor</span><span class="p">);</span>
	   <span class="p">}</span>

	   <span class="nd">@TestFactory</span>
	   <span class="n">Stream</span><span class="o">&lt;</span><span class="n">DynamicTest</span><span class="o">&gt;</span> <span class="nf">dynamicTestsFromStreamFactoryMethodWithNames</span><span class="p">()</span> <span class="p">{</span>
	       <span class="c1">// Stream of palindromes to check</span>
	       <span class="n">Stream</span><span class="o">&lt;</span><span class="n">Named</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
		       <span class="n">named</span><span class="p">(</span><span class="s">"racecar is a palindrome"</span><span class="p">,</span> <span class="s">"racecar"</span><span class="p">),</span>
		       <span class="n">named</span><span class="p">(</span><span class="s">"radar is also a palindrome"</span><span class="p">,</span> <span class="s">"radar"</span><span class="p">),</span>
		       <span class="n">named</span><span class="p">(</span><span class="s">"mom also seems to be a palindrome"</span><span class="p">,</span> <span class="s">"mom"</span><span class="p">),</span>
		       <span class="n">named</span><span class="p">(</span><span class="s">"dad is yet another palindrome"</span><span class="p">,</span> <span class="s">"dad"</span><span class="p">)</span>
		   <span class="p">);</span>

	       <span class="c1">// Returns a stream of dynamic tests.</span>
	       <span class="k">return</span> <span class="n">DynamicTest</span><span class="p">.</span><span class="na">stream</span><span class="p">(</span><span class="n">inputStream</span><span class="p">,</span>
		   <span class="n">text</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="p">(</span><span class="n">isPalindrome</span><span class="p">(</span><span class="n">text</span><span class="p">)));</span>
	   <span class="p">}</span>


	   <span class="cm">/** See Dynamic containers here. </span>
<span class="cm">	   *   This is nice. Basically each time you nest a container is one level</span>
<span class="cm">	   *   lower in the call hieararchy. </span>
<span class="cm">	   *   The first string argument is the title of the particular hierarchical name </span>
<span class="cm">	   *   of the test. </span>
<span class="cm">	   */</span>
	   <span class="nd">@TestFactory</span>
	   <span class="n">Stream</span><span class="o">&lt;</span><span class="n">DynamicNode</span><span class="o">&gt;</span> <span class="nf">dynamicTestsWithContainers</span><span class="p">()</span> <span class="p">{</span>
	       <span class="k">return</span> <span class="n">Stream</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">"A"</span><span class="p">,</span> <span class="s">"B"</span><span class="p">,</span> <span class="s">"C"</span><span class="p">)</span>
		   <span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">input</span> <span class="o">-&gt;</span> <span class="n">dynamicContainer</span><span class="p">(</span><span class="s">"Container "</span> <span class="o">+</span> <span class="n">input</span><span class="p">,</span> <span class="n">Stream</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
		       <span class="n">dynamicTest</span><span class="p">(</span><span class="s">"not null"</span><span class="p">,</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">assertNotNull</span><span class="p">(</span><span class="n">input</span><span class="p">)),</span>
		       <span class="n">dynamicContainer</span><span class="p">(</span><span class="s">"properties"</span><span class="p">,</span> <span class="n">Stream</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
			   <span class="n">dynamicTest</span><span class="p">(</span><span class="s">"length &gt; 0"</span><span class="p">,</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="na">length</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)),</span>
			   <span class="n">dynamicTest</span><span class="p">(</span><span class="s">"not empty"</span><span class="p">,</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">assertFalse</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">()))</span>
		       <span class="p">))</span>
		   <span class="p">)));</span>
	   <span class="p">}</span>

	   <span class="nd">@TestFactory</span>
	   <span class="n">DynamicNode</span> <span class="nf">dynamicNodeSingleTest</span><span class="p">()</span> <span class="p">{</span>
	       <span class="k">return</span> <span class="n">dynamicTest</span><span class="p">(</span><span class="s">"'pop' is a palindrome"</span><span class="p">,</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="p">(</span><span class="n">isPalindrome</span><span class="p">(</span><span class="s">"pop"</span><span class="p">)));</span>
	   <span class="p">}</span>

	   <span class="nd">@TestFactory</span>
	   <span class="n">DynamicNode</span> <span class="nf">dynamicNodeSingleContainer</span><span class="p">()</span> <span class="p">{</span>
	       <span class="k">return</span> <span class="n">dynamicContainer</span><span class="p">(</span><span class="s">"palindromes"</span><span class="p">,</span>
		   <span class="n">Stream</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">"racecar"</span><span class="p">,</span> <span class="s">"radar"</span><span class="p">,</span> <span class="s">"mom"</span><span class="p">,</span> <span class="s">"dad"</span><span class="p">)</span>
		       <span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">text</span> <span class="o">-&gt;</span> <span class="n">dynamicTest</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="p">(</span><span class="n">isPalindrome</span><span class="p">(</span><span class="n">text</span><span class="p">)))</span>
	       <span class="p">));</span>
	   <span class="p">}</span>

       <span class="p">}</span>
</pre></div>

<p>
Example of dynamic Node in a picture. Run it on my Eclipse
together a couple of others tests in order to understand the
entire thingy.
</p>

<img src="../../images/Screenshot%202022-01-31%20140121.png" class="center">
</div>
</li>
</ul>
</li>

<li>
<a id="orgd2c03ab"></a>URI<br><div class="outline-text-5" id="text-orgd2c03ab">
<p>
Note that this might particularly be interesting for working with
dynamic Tests or Test-templates.
</p>

<p>
The idea is that you can reference then particular tests that you
want to use through URI.
</p>

<p>
The idea is essentially the following:
</p>

<p>
The JUnit Platform provides TestSource, a representation of the
source of a test or container used to navigate to its location by
IDEs and build tools. 
</p>

<p>
The TestSource for a dynamic test or dynamic container can be
constructed from a java.net.URI which can be supplied via the
DynamicTest.dynamicTest(String, URI, Executable) or
DynamicContainer.dynamicContainer(String, URI, Stream) factory method,
respectively. The URI will be converted to one of the following
TestSource implementations.
</p>
</div>
</li>


<li>
<a id="orgaa8ae9f"></a>Timeouts<br><ul class="org-ul">
<li>
<a id="org61539ea"></a>@Timeout<br><div class="outline-text-6" id="text-org61539ea">
<p>
Used to fail a test, test factory, test template, or lifecycle method
if its execution exceeds a given duration. 
</p>

<p>
Note that you have as well the assertion timeout option - see
the section <a href="#orge2d98b8">AssertionTypes</a>.
</p>

<p>
So that will be as well a design choice to understand which one
of the two you should use.
</p>

<p>
Check at the following quote:
</p>

<blockquote>
<p>
Contrary to the assertTimeoutPreemptively() assertion, the execution
of the annotated method proceeds in the main thread of the test. If
the timeout is exceeded, the main thread is interrupted from another
thread. This is done to ensure interoperability with frameworks such
as Spring that make use of mechanisms that are sensitive to the
currently running thread — for example, ThreadLocal transaction
management. - Double check this.
</p>
</blockquote>

<p>
So I guess that there would be a slight difference in the
logic. 
</p>

<p>
An example is the following:
</p>

<div class="highlight"><pre><span></span><span class="kd">class</span> <span class="nc">TimeoutDemo</span> <span class="p">{</span>

    <span class="nd">@BeforeEach</span>
    <span class="nd">@Timeout</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="kt">void</span> <span class="nf">setUp</span><span class="p">()</span> <span class="p">{</span>
	<span class="c1">// fails if execution time exceeds 5 seconds</span>
    <span class="p">}</span>

    <span class="nd">@Test</span>
    <span class="nd">@Timeout</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="n">TimeUnit</span><span class="p">.</span><span class="na">MILLISECONDS</span><span class="p">)</span>
    <span class="kt">void</span> <span class="nf">failsIfExecutionTimeExceeds100Milliseconds</span><span class="p">()</span> <span class="p">{</span>
	<span class="c1">// fails if execution time exceeds 100 milliseconds</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>

<p>
Such annotations are inherited.
</p>
</div>
</li>

<li>
<a id="org90a55b1"></a><span class="todo TODO">TODO</span> understand better the difference with Assertion Kind of errors.<br>
</li>
</ul>
</li>


<li>
<a id="orga35a4ed"></a><span class="todo TODO">TODO</span> check how to combine the annoations above into meta-annotations<br><div class="outline-text-5" id="text-orga35a4ed">
<p>
see chapter 2.1 in this sense. 
</p>

<p>
have as well to understand the benefit of properly combining
annotations. 
</p>
</div>
</li>


<li>
<a id="org87b510a"></a>Parallel Execution<br><div class="outline-text-5" id="text-org87b510a">
<p>
This might be useful in order to keep a fast and nimble execution
of your tests.
</p>

<p>
Understand the following:
</p>

<blockquote>
<p>
By <b>default</b>, JUnit Jupiter tests are <b>run sequentially</b> in a single
thread. 
</p>

<p>
Running tests in parallel — for example, to speed up execution — is
available as an opt-in feature since version 5.3. To enable parallel
execution, set the junit.jupiter.execution.parallel.enabled
configuration parameter to true — for example, in
<code>junit-platform.properties</code>.
</p>


<p>
This property is <i>only the first step</i> required to execute tests in
parallel. If enabled, test classes and methods will <i>still be executed
sequentially by default</i>. Whether or not a node in the test tree is
executed concurrently is controlled by its execution mode. The
following two modes are available:
</p>


<ul class="org-ul">
<li>SAME<sub>THREAD</sub>: execution in the same thread as the parent.</li>

<li>CONCURRENT: Execute concurrently unless a resource lock forces
execution in the same thread.</li>
</ul>
</blockquote>

<p>
Note now that with the understanding above you have essentially
two options in order to implment the parallel execution strategy.
</p>

<ul class="org-ul">
<li>
<p>
Method 1 - set it at global level:
</p>

<div class="highlight"><pre><span></span>       <span class="n">junit</span><span class="p">.</span><span class="na">jupiter</span><span class="p">.</span><span class="na">execution</span><span class="p">.</span><span class="na">parallel</span><span class="p">.</span><span class="na">enabled</span> <span class="o">=</span> <span class="kc">true</span>
       <span class="n">junit</span><span class="p">.</span><span class="na">jupiter</span><span class="p">.</span><span class="na">execution</span><span class="p">.</span><span class="na">parallel</span><span class="p">.</span><span class="na">mode</span><span class="p">.</span><span class="na">default</span> <span class="o">=</span> <span class="n">concurrent</span>
</pre></div>

<p>
Note here that: most of your test classes can be <b>run in
parallel</b> without any synchronization but you have some test
classes that need to run in isolation, you can mark the latter
with the @Isolated annotation. 
</p>
</li>

<li>
<p>
Method 2 - set it for sepcific tests:
</p>

<p>
You can use the <code>@Execution</code> annotation to change the execution
mode for the annotated element and its subelements (if any)
which allows you to activate parallel execution for individual
test classes, one by one.  
</p>

<p>
Example: set - <code>@Execution(CONCURRENT)</code>
</p>
</li>

<li>
<p>
Method 3 - parallel classes but methods sequentially
</p>

<p>
There is also the option to run the tests of methods in the same
class on a specific thread, while tests across classes are
executed on separate threads. You can achieve that through the
following function:
</p>

<div class="highlight"><pre><span></span>       <span class="n">junit</span><span class="p">.</span><span class="na">jupiter</span><span class="p">.</span><span class="na">execution</span><span class="p">.</span><span class="na">parallel</span><span class="p">.</span><span class="na">enabled</span> <span class="o">=</span> <span class="kc">true</span>
       <span class="n">junit</span><span class="p">.</span><span class="na">jupiter</span><span class="p">.</span><span class="na">execution</span><span class="p">.</span><span class="na">parallel</span><span class="p">.</span><span class="na">mode</span><span class="p">.</span><span class="na">default</span> <span class="o">=</span> <span class="n">same_thread</span>
       <span class="n">junit</span><span class="p">.</span><span class="na">jupiter</span><span class="p">.</span><span class="na">execution</span><span class="p">.</span><span class="na">parallel</span><span class="p">.</span><span class="na">mode</span><span class="p">.</span><span class="na">classes</span><span class="p">.</span><span class="na">default</span> <span class="o">=</span> <span class="n">concurrent</span>
</pre></div>
</li>

<li>
<p>
Method 4 - Classes sequentially while methods within in
parallel
</p>

<p>
So essentially the exact opposite of above.
</p>

<div class="highlight"><pre><span></span>       <span class="n">junit</span><span class="p">.</span><span class="na">jupiter</span><span class="p">.</span><span class="na">execution</span><span class="p">.</span><span class="na">parallel</span><span class="p">.</span><span class="na">enabled</span> <span class="o">=</span> <span class="kc">true</span>
       <span class="n">junit</span><span class="p">.</span><span class="na">jupiter</span><span class="p">.</span><span class="na">execution</span><span class="p">.</span><span class="na">parallel</span><span class="p">.</span><span class="na">mode</span><span class="p">.</span><span class="na">default</span> <span class="o">=</span> <span class="n">concurrent</span>
       <span class="n">junit</span><span class="p">.</span><span class="na">jupiter</span><span class="p">.</span><span class="na">execution</span><span class="p">.</span><span class="na">parallel</span><span class="p">.</span><span class="na">mode</span><span class="p">.</span><span class="na">classes</span><span class="p">.</span><span class="na">default</span> <span class="o">=</span> <span class="n">same_thread</span>
</pre></div>
</li>
</ul>
</div>

<ul class="org-ul">
<li>
<a id="org5c704b0"></a>Recall that it is as well possible to set ResourceLocks<br><div class="outline-text-6" id="text-org5c704b0">
<p>
These will be especially important in order to avoid race
conditions. 
</p>

<p>
When access to shared resources is declared using the
@ResourceLock annotation, the JUnit Jupiter engine uses this
information to ensure that no conflicting tests are run in
parallel. 
</p>
</div>
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-orge2d98b8" class="outline-4">
<h4 id="orge2d98b8">AssertionTypes</h4>
<div class="outline-text-4" id="text-orge2d98b8">
<p>
Check in the following all of the different types of possible
assertion methods - note again in junit package.
</p>

<p>
Note that should you want to start to go deeper into the topic
there is the following statement on the official documentation:
</p>

<blockquote>
<p>
There are times when more power and additional functionality such as
matchers are desired or required. In such cases, the JUnit team
recommends the use of third-party assertion libraries such as <code>AssertJ,
Hamcrest, Truth</code>, etc. Developers are therefore free to use the
assertion library of their choice. 
</p>
</blockquote>

<p>
Might want to check at these.
</p>

<p>
In any case coming back to our case, see the following script with
the possible assertions. I especially like the
<b>assertionTimeOut</b>. I never worked with it before but I can
already picture beautiful use-cases for it. Very neat.
</p>

<div class="highlight"><pre><span></span>    <span class="kn">import static</span> <span class="nn">java.time.Duration.ofMillis</span><span class="p">;</span>
    <span class="kn">import static</span> <span class="nn">java.time.Duration.ofMinutes</span><span class="p">;</span>
    <span class="kn">import static</span> <span class="nn">org.junit.jupiter.api.Assertions.assertAll</span><span class="p">;</span>
    <span class="kn">import static</span> <span class="nn">org.junit.jupiter.api.Assertions.assertEquals</span><span class="p">;</span>
    <span class="kn">import static</span> <span class="nn">org.junit.jupiter.api.Assertions.assertNotNull</span><span class="p">;</span>
    <span class="kn">import static</span> <span class="nn">org.junit.jupiter.api.Assertions.assertThrows</span><span class="p">;</span>
    <span class="kn">import static</span> <span class="nn">org.junit.jupiter.api.Assertions.assertTimeout</span><span class="p">;</span>
    <span class="kn">import static</span> <span class="nn">org.junit.jupiter.api.Assertions.assertTimeoutPreemptively</span><span class="p">;</span>
    <span class="kn">import static</span> <span class="nn">org.junit.jupiter.api.Assertions.assertTrue</span><span class="p">;</span>

    <span class="kn">import</span> <span class="nn">java.util.concurrent.CountDownLatch</span><span class="p">;</span>

    <span class="kn">import</span> <span class="nn">example.domain.Person</span><span class="p">;</span>
    <span class="kn">import</span> <span class="nn">example.util.Calculator</span><span class="p">;</span>

    <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="p">;</span>

    <span class="kd">class</span> <span class="nc">AssertionsDemo</span> <span class="p">{</span>

	<span class="kd">private</span> <span class="kd">final</span> <span class="n">Calculator</span> <span class="n">calculator</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Calculator</span><span class="p">();</span>

	<span class="kd">private</span> <span class="kd">final</span> <span class="n">Person</span> <span class="n">person</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Person</span><span class="p">(</span><span class="s">"Jane"</span><span class="p">,</span> <span class="s">"Doe"</span><span class="p">);</span>

	<span class="nd">@Test</span>
	<span class="kt">void</span> <span class="nf">standardAssertions</span><span class="p">()</span> <span class="p">{</span>
	    <span class="n">assertEquals</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">calculator</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>

	    <span class="n">assertEquals</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">calculator</span><span class="p">.</span><span class="na">multiply</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
			 <span class="s">"The optional failure message is now the last parameter"</span><span class="p">);</span>


	    <span class="c1">// well the next point is a I wanna be thing. I don't think that compiling a string is such a big issue</span>
	    <span class="c1">// anyways see the point of lazy evaluation.</span>
	    <span class="n">assertTrue</span><span class="p">(</span><span class="sc">'a'</span> <span class="o">&lt;</span> <span class="sc">'b'</span><span class="p">,</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="s">"Assertion messages can be lazily evaluated -- "</span>
		       <span class="o">+</span> <span class="s">"to avoid constructing complex messages unnecessarily."</span><span class="p">);</span> 
	<span class="p">}</span>

	<span class="nd">@Test</span>
	<span class="kt">void</span> <span class="nf">groupedAssertions</span><span class="p">()</span> <span class="p">{</span>
	    <span class="c1">// In a grouped assertion all assertions are executed, and all</span>
	    <span class="c1">// failures will be reported together.</span>
	    <span class="n">assertAll</span><span class="p">(</span><span class="s">"person"</span><span class="p">,</span>
		      <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">assertEquals</span><span class="p">(</span><span class="s">"Jane"</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="na">getFirstName</span><span class="p">()),</span>
		      <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">assertEquals</span><span class="p">(</span><span class="s">"Doe"</span><span class="p">,</span> <span class="n">person</span><span class="p">.</span><span class="na">getLastName</span><span class="p">())</span>
		      <span class="p">);</span>
	<span class="p">}</span>

	<span class="nd">@Test</span>
	<span class="kt">void</span> <span class="nf">dependentAssertions</span><span class="p">()</span> <span class="p">{</span>
	    <span class="c1">// Within a code block, if an assertion fails the</span>
	    <span class="c1">// subsequent code in the same block will be skipped.</span>
	    <span class="n">assertAll</span><span class="p">(</span><span class="s">"properties"</span><span class="p">,</span>
		      <span class="p">()</span> <span class="o">-&gt;</span> <span class="p">{</span>
			  <span class="n">String</span> <span class="n">firstName</span> <span class="o">=</span> <span class="n">person</span><span class="p">.</span><span class="na">getFirstName</span><span class="p">();</span>
			  <span class="n">assertNotNull</span><span class="p">(</span><span class="n">firstName</span><span class="p">);</span>

			  <span class="c1">// Executed only if the previous assertion is valid.</span>
			  <span class="n">assertAll</span><span class="p">(</span><span class="s">"first name"</span><span class="p">,</span>
				    <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="p">(</span><span class="n">firstName</span><span class="p">.</span><span class="na">startsWith</span><span class="p">(</span><span class="s">"J"</span><span class="p">)),</span>
				    <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="p">(</span><span class="n">firstName</span><span class="p">.</span><span class="na">endsWith</span><span class="p">(</span><span class="s">"e"</span><span class="p">))</span>
				    <span class="p">);</span>
		      <span class="p">},</span>
		      <span class="p">()</span> <span class="o">-&gt;</span> <span class="p">{</span>
			  <span class="c1">// Grouped assertion, so processed independently</span>
			  <span class="c1">// of results of first name assertions.</span>
			  <span class="n">String</span> <span class="n">lastName</span> <span class="o">=</span> <span class="n">person</span><span class="p">.</span><span class="na">getLastName</span><span class="p">();</span>
			  <span class="n">assertNotNull</span><span class="p">(</span><span class="n">lastName</span><span class="p">);</span>

			  <span class="c1">// Executed only if the previous assertion is valid.</span>
			  <span class="n">assertAll</span><span class="p">(</span><span class="s">"last name"</span><span class="p">,</span>
				    <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="p">(</span><span class="n">lastName</span><span class="p">.</span><span class="na">startsWith</span><span class="p">(</span><span class="s">"D"</span><span class="p">)),</span>
				    <span class="p">()</span> <span class="o">-&gt;</span> <span class="n">assertTrue</span><span class="p">(</span><span class="n">lastName</span><span class="p">.</span><span class="na">endsWith</span><span class="p">(</span><span class="s">"e"</span><span class="p">))</span>
				    <span class="p">);</span>
		      <span class="p">}</span>
		      <span class="p">);</span>
	<span class="p">}</span>

	<span class="c1">// so note the syntax of assertThrows:</span>
	<span class="c1">// first argument: exception that should result</span>
	<span class="c1">// second arg: the actual code that should throw the exception.</span>
	<span class="c1">// third arg: message   If the executable code does not throw</span>
	<span class="c1">//            any exception, this message will be printed along with FAIL result </span>
	<span class="c1">// so basically use it in order to see if you get the error as desired. </span>
	<span class="nd">@Test</span> 
	<span class="kt">void</span> <span class="nf">exceptionTesting</span><span class="p">()</span> <span class="p">{</span>
	    <span class="n">Exception</span> <span class="n">exception</span> <span class="o">=</span> <span class="n">assertThrows</span><span class="p">(</span><span class="n">ArithmeticException</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="p">()</span> <span class="o">-&gt;</span>
					       <span class="n">calculator</span><span class="p">.</span><span class="na">divide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span> 

	    <span class="n">assertEquals</span><span class="p">(</span><span class="s">"/ by zero"</span><span class="p">,</span> <span class="n">exception</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
	<span class="p">}</span>

	<span class="c1">// this is a very nice one.</span>
	<span class="nd">@Test</span>
	<span class="kt">void</span> <span class="nf">timeoutNotExceeded</span><span class="p">()</span> <span class="p">{</span>
	    <span class="c1">// The following assertion succeeds.</span>
	    <span class="n">assertTimeout</span><span class="p">(</span><span class="n">ofMinutes</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="p">{</span>
		    <span class="c1">// Perform task that takes less than 2 minutes.</span>
		<span class="p">});</span>
	<span class="p">}</span>

	<span class="nd">@Test</span>
	<span class="kt">void</span> <span class="nf">timeoutNotExceededWithResult</span><span class="p">()</span> <span class="p">{</span>
	    <span class="c1">// The following assertion succeeds, and returns the supplied object.</span>
	    <span class="n">String</span> <span class="n">actualResult</span> <span class="o">=</span> <span class="n">assertTimeout</span><span class="p">(</span><span class="n">ofMinutes</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="p">{</span>
		    <span class="k">return</span> <span class="s">"a result"</span><span class="p">;</span>
		<span class="p">});</span>
	    <span class="n">assertEquals</span><span class="p">(</span><span class="s">"a result"</span><span class="p">,</span> <span class="n">actualResult</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="nd">@Test</span>
	<span class="kt">void</span> <span class="nf">timeoutNotExceededWithMethod</span><span class="p">()</span> <span class="p">{</span>
	    <span class="c1">// The following assertion invokes a method reference and returns an object.</span>
	    <span class="n">String</span> <span class="n">actualGreeting</span> <span class="o">=</span> <span class="n">assertTimeout</span><span class="p">(</span><span class="n">ofMinutes</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">AssertionsDemo</span><span class="p">::</span><span class="n">greeting</span><span class="p">);</span>
	    <span class="n">assertEquals</span><span class="p">(</span><span class="s">"Hello, World!"</span><span class="p">,</span> <span class="n">actualGreeting</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="nd">@Test</span>
	<span class="kt">void</span> <span class="nf">timeoutExceeded</span><span class="p">()</span> <span class="p">{</span>
	    <span class="c1">// The following assertion fails with an error message similar to:</span>
	    <span class="c1">// execution exceeded timeout of 10 ms by 91 ms</span>
	    <span class="n">assertTimeout</span><span class="p">(</span><span class="n">ofMillis</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="p">{</span>
		    <span class="c1">// Simulate task that takes more than 10 ms.</span>
		    <span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
		<span class="p">});</span>
	<span class="p">}</span>

	<span class="nd">@Test</span>
	<span class="kt">void</span> <span class="nf">timeoutExceededWithPreemptiveTermination</span><span class="p">()</span> <span class="p">{</span>
	    <span class="c1">// The following assertion fails with an error message similar to:</span>
	    <span class="c1">// execution timed out after 10 ms</span>
	    <span class="n">assertTimeoutPreemptively</span><span class="p">(</span><span class="n">ofMillis</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="p">{</span>
		    <span class="c1">// Simulate task that takes more than 10 ms.</span>
		    <span class="k">new</span> <span class="n">CountDownLatch</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="na">await</span><span class="p">();</span>
		<span class="p">});</span>
	<span class="p">}</span>

	<span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">greeting</span><span class="p">()</span> <span class="p">{</span>
	    <span class="k">return</span> <span class="s">"Hello, World!"</span><span class="p">;</span>
	<span class="p">}</span>

    <span class="p">}</span>
</pre></div>
</div>
</div>

<div id="outline-container-org5735a87" class="outline-4">
<h4 id="org5735a87">Assumptions</h4>
<div class="outline-text-4" id="text-org5735a87">
<p>
Ok… that is as well something I never came across
before. Interesting to know of its existence.
</p>

<p>
The idea is the following, if you include an <i>assumption</i>
statement in a test, if the assumption is met then you run the
rest of the test otherwise you will abort the test <b>without
throwing an error</b> for it.
</p>

<p>
It is essentially and if condition that has to hold in order to
run the test.
</p>

<p>
Then see the following two options (<code>assumeTrue</code> and <code>assumeThat</code>)
</p>

<div class="highlight"><pre><span></span>    <span class="kn">import static</span> <span class="nn">org.junit.jupiter.api.Assertions.assertEquals</span><span class="p">;</span>
    <span class="kn">import static</span> <span class="nn">org.junit.jupiter.api.Assumptions.assumeTrue</span><span class="p">;</span>
    <span class="kn">import static</span> <span class="nn">org.junit.jupiter.api.Assumptions.assumingThat</span><span class="p">;</span>

    <span class="kn">import</span> <span class="nn">example.util.Calculator</span><span class="p">;</span>

    <span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="p">;</span>

    <span class="kd">class</span> <span class="nc">AssumptionsDemo</span> <span class="p">{</span>

	<span class="kd">private</span> <span class="kd">final</span> <span class="n">Calculator</span> <span class="n">calculator</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Calculator</span><span class="p">();</span>

	<span class="nd">@Test</span>
	<span class="kt">void</span> <span class="nf">testOnlyOnCiServer</span><span class="p">()</span> <span class="p">{</span>
	    <span class="n">assumeTrue</span><span class="p">(</span><span class="s">"CI"</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">getenv</span><span class="p">(</span><span class="s">"ENV"</span><span class="p">)));</span> <span class="c1">// note that it</span>
							   <span class="c1">// is a boolean</span>
							   <span class="c1">// condition. It</span>
							   <span class="c1">// is not a</span>
							   <span class="c1">// function of</span>
							   <span class="c1">// multiple</span>
							   <span class="c1">// parameters.</span>
	    <span class="c1">// remainder of test</span>
	<span class="p">}</span>

	<span class="nd">@Test</span>
	<span class="kt">void</span> <span class="nf">testOnlyOnDeveloperWorkstation</span><span class="p">()</span> <span class="p">{</span>
	    <span class="n">assumeTrue</span><span class="p">(</span><span class="s">"DEV"</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">getenv</span><span class="p">(</span><span class="s">"ENV"</span><span class="p">)),</span>
		<span class="p">()</span> <span class="o">-&gt;</span> <span class="s">"Aborting test: not on developer workstation"</span><span class="p">);</span> <span class="c1">// with message</span>
	    <span class="c1">// remainder of test</span>
	<span class="p">}</span>

	<span class="c1">// note that you could do the above in two different tests but</span>
	<span class="c1">// good to know the compact option.</span>
	<span class="nd">@Test</span>
	<span class="kt">void</span> <span class="nf">testInAllEnvironments</span><span class="p">()</span> <span class="p">{</span>
	    <span class="n">assumingThat</span><span class="p">(</span><span class="s">"CI"</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">getenv</span><span class="p">(</span><span class="s">"ENV"</span><span class="p">)),</span>
		<span class="p">()</span> <span class="o">-&gt;</span> <span class="p">{</span>
		    <span class="c1">// perform these assertions only on the CI server</span>
		    <span class="n">assertEquals</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">calculator</span><span class="p">.</span><span class="na">divide</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
		<span class="p">});</span>

	    <span class="c1">// perform these assertions in all environments</span>
	    <span class="n">assertEquals</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="n">calculator</span><span class="p">.</span><span class="na">multiply</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">));</span>
	<span class="p">}</span>

    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>


<div id="outline-container-org144b1cb" class="outline-3">
<h3 id="org144b1cb">The bigger picture in unit-testing</h3>
<div class="outline-text-3" id="text-org144b1cb">
<p>
Ok so basically the part above deals on how to write the unit-tests
themselves. 
</p>

<p>
That is the easy bit. You have now your basic logic in order to
write your testing suits. 
</p>

<p>
The issue is that sometimes you have one of the following
circumstances:
</p>

<ul class="org-ul">
<li>the object supplies <i>non-deterministic results</i> (e.g. the current
time or the current temperature);</li>

<li>it has states that are difficult to create or reproduce (e.g. a
network error);</li>

<li>it is slow (e.g. a complete database, which would have to be
initialized before the test);</li>

<li>it does not yet exist or may change behavior;</li>

<li>it would have to include information and methods exclusively for
testing purposes (and not for its actual task).</li>
</ul>
<p>
Then you understand that it is not that trivial to <i>test a bit of
code</i>. What you are interesting into is testing the application
logic of your code. Does it fulfill the goal? 
</p>

<p>
Though, what you will ultimately have is in most of the cases above
a <b>dependency</b> that makes testing the application bit
difficult/annoying. In this case the idea is to rely on mock
objects and other practices addressed in this section that will
make it possible for you to properly isolate the logic of your code
and test this in a shielded environment.
</p>

<p>
So the concept that you have to dominate are now the following:
</p>

<ul class="org-ul">
<li>
<code>Stub</code> : an implementation that returns a hard-coded value for
purposes of testing is known as a stub.</li>

<li>
<code>Mocks</code>: A mock is a test construct that provides emulated
behavior and also does the job of <b>verifying whether or not it
received all the parameters expected</b>.</li>

<li>
<code>Fakes</code>:</li>
</ul>
</div>
</div>

<div id="outline-container-org97476b9" class="outline-3">
<h3 id="org97476b9">Stub</h3>
<div class="outline-text-3" id="text-org97476b9">
<p>
So basic example of a stub is the following as from the book
<i>Pragmatic Unit Testing</i>.
</p>

<p>
Say you have an http response that you will need to use in a bit of
your code. Then you can do the following:
</p>

<div class="highlight"><pre><span></span>   <span class="c1">// See the following object creation</span>
   <span class="n">Http</span> <span class="n">http</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Http</span><span class="p">()</span> <span class="p">{</span>
	   <span class="nd">@Override</span>
	   <span class="kd">public</span> <span class="n">String</span> <span class="nf">get</span><span class="p">(</span><span class="n">String</span> <span class="n">url</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="p">{</span>
	       <span class="k">return</span> <span class="s">"{\"address\":{"</span>
		   <span class="o">+</span> <span class="s">"\"house_number\":\"324\","</span>
		   <span class="o">+</span> <span class="s">"\"road\":\"North Tejon Street\","</span>
		   <span class="c1">// ...</span>
		   <span class="p">}};</span>
</pre></div>

<p>
Then you can use that stub by invoking the object from the
anonymous inner class:
</p>

<div class="highlight"><pre><span></span>   <span class="kd">public</span> <span class="n">Address</span> <span class="nf">retrieve</span><span class="p">(</span><span class="kt">double</span> <span class="n">latitude</span><span class="p">,</span> <span class="kt">double</span> <span class="n">longitude</span><span class="p">)</span>
   <span class="kd">throws</span> <span class="n">IOException</span><span class="p">,</span> <span class="n">ParseException</span> <span class="p">{</span>
   <span class="n">String</span> <span class="n">parms</span> <span class="o">=</span> <span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">"lat=%.6flon=%.6f"</span><span class="p">,</span> <span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">);</span>
    <span class="n">String</span> <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="p">.</span><span class="na">get</span><span class="p">(</span>
    <span class="s">"http://open.mapquestapi.com/nominatim/v1/reverse?format=json&amp;"</span>
    <span class="o">+</span> <span class="n">parms</span><span class="p">);</span> <span class="c1">// here you have your stub</span>
   <span class="n">JSONObject</span> <span class="n">obj</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span><span class="k">new</span> <span class="n">JSONParser</span><span class="p">().</span><span class="na">parse</span><span class="p">(</span><span class="n">response</span><span class="p">);</span>
   <span class="c1">// ...</span>
   <span class="p">}</span>
</pre></div>

<p>
You can then continue with your test in the most classical way. 
</p>

<p>
I.e. with the two above methods you would have something as
follows:
</p>

<div class="highlight"><pre><span></span>   <span class="kn">import</span> <span class="nn">java.io.*</span><span class="p">;</span>
   <span class="kn">import</span> <span class="nn">org.json.simple.parser.*</span><span class="p">;</span>
   <span class="kn">import</span> <span class="nn">org.junit.*</span><span class="p">;</span>
   <span class="kn">import</span> <span class="nn">util.*</span><span class="p">;</span>
   <span class="kn">import static</span> <span class="nn">org.hamcrest.CoreMatchers.*</span><span class="p">;</span>
   <span class="kn">import static</span> <span class="nn">org.junit.Assert.*</span><span class="p">;</span>
   <span class="kd">public</span> <span class="kd">class</span> <span class="nc">AddressRetrieverTest</span> <span class="p">{</span>
       <span class="nd">@Test</span>
       <span class="kd">public</span> <span class="kt">void</span> <span class="nf">answersAppropriateAddressForValidCoordinates</span><span class="p">()</span>
	   <span class="kd">throws</span> <span class="n">IOException</span><span class="p">,</span> <span class="n">ParseException</span> <span class="p">{</span>
	   <span class="n">Http</span> <span class="n">http</span> <span class="o">=</span> <span class="p">(</span><span class="n">String</span> <span class="n">url</span><span class="p">)</span> <span class="o">-&gt;</span>
	       <span class="s">"{\"address\":{"</span>
	       <span class="o">+</span> <span class="s">"\"house_number\":\"324\","</span>
	       <span class="o">+</span> <span class="s">"\"road\":\"North Tejon Street\","</span>
	       <span class="o">+</span> <span class="s">"\"city\":\"Colorado Springs\","</span>
	       <span class="o">+</span> <span class="s">"\"state\":\"Colorado\","</span>
	       <span class="o">+</span> <span class="s">"\"postcode\":\"80903\","</span>
	       <span class="o">+</span> <span class="s">"\"country_code\":\"us\"}"</span>
	       <span class="o">+</span> <span class="s">"}"</span><span class="p">;</span>
	   <span class="n">AddressRetriever</span> <span class="n">retriever</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AddressRetriever</span><span class="p">(</span><span class="n">http</span><span class="p">);</span>
	   <span class="n">Address</span> <span class="n">address</span> <span class="o">=</span> <span class="n">retriever</span><span class="p">.</span><span class="na">retrieve</span><span class="p">(</span><span class="mf">38.0</span><span class="p">,</span><span class="o">-</span><span class="mf">104.0</span><span class="p">);</span>
	   <span class="n">assertThat</span><span class="p">(</span><span class="n">address</span><span class="p">.</span><span class="na">houseNumber</span><span class="p">,</span> <span class="n">equalTo</span><span class="p">(</span><span class="s">"324"</span><span class="p">));</span>
	   <span class="n">assertThat</span><span class="p">(</span><span class="n">address</span><span class="p">.</span><span class="na">road</span><span class="p">,</span> <span class="n">equalTo</span><span class="p">(</span><span class="s">"North Tejon Street"</span><span class="p">));</span>
	   <span class="n">assertThat</span><span class="p">(</span><span class="n">address</span><span class="p">.</span><span class="na">city</span><span class="p">,</span> <span class="n">equalTo</span><span class="p">(</span><span class="s">"Colorado Springs"</span><span class="p">));</span>
	   <span class="n">assertThat</span><span class="p">(</span><span class="n">address</span><span class="p">.</span><span class="na">state</span><span class="p">,</span> <span class="n">equalTo</span><span class="p">(</span><span class="s">"Colorado"</span><span class="p">));</span>
	   <span class="n">assertThat</span><span class="p">(</span><span class="n">address</span><span class="p">.</span><span class="na">zip</span><span class="p">,</span> <span class="n">equalTo</span><span class="p">(</span><span class="s">"80903"</span><span class="p">));</span>
       <span class="p">}</span>
   <span class="p">}</span>
</pre></div>

<p>
so you see that you pass the <code>http</code> dependency to the
<code>AddressRetriever</code> where your stub will be declared.
</p>

<p>
So note now that it is up to you to specify how you pass that exact
dependency. You can use as well spring and the way you pass
dependencies over there.             
</p>
</div>

<div id="outline-container-orgb6167b5" class="outline-4">
<h4 id="orgb6167b5">Side note - why is this a stub?</h4>
<div class="outline-text-4" id="text-orgb6167b5">
<p>
This because you use the object from the anonymous class above in
order to get your hard-coded string.   I.e. you are actually
calling the <code>get</code> method.
</p>
</div>
</div>
</div>


<div id="outline-container-org6a9aa28" class="outline-3">
<h3 id="org6a9aa28">Mocks - Mockito</h3>
<div class="outline-text-3" id="text-org6a9aa28">
<p>
Basically the fundamental idea of the framework is the one of
giving the possibility to <code>mock</code> the <i>dependencies</i>.
</p>

<p>
A mock object is a dummy implementation for an interface or a
class. It allows to <i>define the output of certain method calls</i>. They
typically record the interaction with the system and tests can
validate that. 
</p>

<p>
So basically that is the idea. You have a dependency and use
Mockito to feed the dependency record/object.
</p>

<p>
This is in fact interesting and important. You can create
<b>mock-objects</b> that you will use in your tests. So understand that
this is not simply for feeding values or calling a single
method. It is creating an <i>entire mock-object</i>.
</p>
</div>

<div id="outline-container-org895d9e3" class="outline-4">
<h4 id="org895d9e3">Index</h4>
<div class="outline-text-4" id="text-org895d9e3">
<ul class="org-ul">
<li><a href="#orgb634aaa">What is a mock object</a></li>
<li><a href="#org776c95c">Creating a mock() object and verifying the parameters received</a></li>
<li><a href="#orgfac0dbe">Dependency Injection Tool</a></li>
<li><a href="#org7c0e3ff">@Spy</a></li>
<li><a href="#orgadc1fa7">@Capture</a></li>
<li><a href="#orgd829cc5">Resources used for the tutorial</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgb634aaa" class="outline-4">
<h4 id="orgb634aaa">What is a mock object</h4>
<div class="outline-text-4" id="text-orgb634aaa">
<p>
In object-oriented programming, mock objects are <i>simulated
objects</i> that mimic the behavior of real objects in controlled
ways, most often as part of a software testing initiative. A
programmer typically creates a mock object to test the behavior of
some other object, in much the same way that a car designer uses a
crash test dummy to simulate the dynamic behavior of a human in
vehicle impacts. The technique is also applicable in generic
programming.
</p>
</div>
</div>

<div id="outline-container-org776c95c" class="outline-4">
<h4 id="org776c95c">Creating a mock() object and verifying the parameters received</h4>
<div class="outline-text-4" id="text-org776c95c">
<p>
In order to create a mock object you can do the following - as in
the example:
</p>

<div class="highlight"><pre><span></span>    <span class="kn">import static</span> <span class="nn">org.mockito.Mockito.*</span><span class="p">;</span>

    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">AddressRetrieverTest</span> <span class="p">{</span>
	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">answersAppropriateAddressForValidCoordinates</span><span class="p">()</span>
	    <span class="kd">throws</span> <span class="n">IOException</span><span class="p">,</span> <span class="n">ParseException</span> <span class="p">{</span>
	    <span class="n">Http</span> <span class="n">http</span> <span class="o">=</span> <span class="n">mock</span><span class="p">(</span><span class="n">Http</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
	    <span class="n">when</span><span class="p">(</span><span class="n">http</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">contains</span><span class="p">(</span><span class="s">"lat=38.000000&amp;lon=-104.000000"</span><span class="p">))).</span><span class="na">thenReturn</span><span class="p">(</span>
										 <span class="s">"{\"address\":{"</span>
										 <span class="o">+</span> <span class="s">"\"house_number\":\"324\","</span>
										 <span class="c1">// ...</span>
										 <span class="o">+</span> <span class="s">"}"</span><span class="p">);</span>
	    <span class="n">AddressRetriever</span> <span class="n">retriever</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AddressRetriever</span><span class="p">(</span><span class="n">http</span><span class="p">);</span>
	    <span class="n">Address</span> <span class="n">address</span> <span class="o">=</span> <span class="n">retriever</span><span class="p">.</span><span class="na">retrieve</span><span class="p">(</span><span class="mf">38.0</span><span class="p">,</span><span class="o">-</span><span class="mf">104.0</span><span class="p">);</span> <span class="c1">// parameters</span>
							       <span class="c1">// you pass</span>
							       <span class="c1">// you are</span>
							       <span class="c1">// testing.</span>
	    <span class="n">assertThat</span><span class="p">(</span><span class="n">address</span><span class="p">.</span><span class="na">houseNumber</span><span class="p">,</span> <span class="n">equalTo</span><span class="p">(</span><span class="s">"324"</span><span class="p">));</span>
	    <span class="c1">// ...</span>
	<span class="p">}</span>
</pre></div>

<p>
Then understand the following:
</p>

<ul class="org-ul">
<li>first you understand the mock-object from the Http.class.</li>

<li>then you verify the parameters: <code>when(contains...)</code>
</li>

<li>finally you return the stub values.</li>
</ul>
<p>
Note now that the <code>http.get</code> method does not has the argument
above. Where do you pass this exactly? Have to double check. Not
that trivial. It means that the call of the get method providing
the argument to it is done somewhere else.
</p>

<p>
When a call to the http method <code>get()</code> is made with a parameter
containing the string "lat=38.000000&amp;lon=- 104.000000", then
return the hardcoded JSON string. 
</p>
</div>
</div>

<div id="outline-container-orgfac0dbe" class="outline-4">
<h4 id="orgfac0dbe">Dependency Injection Tool</h4>
<div class="outline-text-4" id="text-orgfac0dbe">
<p>
Passing a mock to a target class using a constructor is one
technique. It requires a change to the interface and exposes a
<b>private detail</b> to another class in the production code. Not a
great deal, but you can do better by using a <i>dependency injection
(DI)</i> tool.
</p>

<p>
However, not that Mockito has its own dependency injection tool:
</p>

<div class="highlight"><pre><span></span>    <span class="kd">public</span> <span class="kd">class</span> <span class="nc">AddressRetrieverTest</span> <span class="p">{</span>
	<span class="nd">@Mock</span> <span class="kd">private</span> <span class="n">Http</span> <span class="n">http</span><span class="p">;</span>  <span class="c1">// here you specify the mock object to</span>
				  <span class="c1">// be synthetized.</span>
	<span class="nd">@InjectMocks</span> <span class="kd">private</span> <span class="n">AddressRetriever</span> <span class="n">retriever</span><span class="p">;</span>  <span class="c1">// dependency</span>
							  <span class="c1">// injection. I.e. you</span>
							  <span class="c1">// tell that</span>
							  <span class="c1">// your mock</span>
							  <span class="c1">// should be</span>
							  <span class="c1">// injected in</span>
							  <span class="c1">// here.</span>
	<span class="nd">@Before</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">createRetriever</span><span class="p">()</span> <span class="p">{</span>
	    <span class="n">retriever</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AddressRetriever</span><span class="p">();</span>
	    <span class="n">MockitoAnnotations</span><span class="p">.</span><span class="na">initMocks</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="nd">@Test</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">answersAppropriateAddressForValidCoordinates</span><span class="p">()</span>
	    <span class="kd">throws</span> <span class="n">IOException</span><span class="p">,</span> <span class="n">ParseException</span> <span class="p">{</span>
	    <span class="n">when</span><span class="p">(</span><span class="n">http</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">contains</span><span class="p">(</span><span class="s">"lat=38.000000&amp;lon=-104.000000"</span><span class="p">)))</span>
		<span class="p">.</span><span class="na">thenReturn</span><span class="p">(</span><span class="s">"{\"address\":{"</span>
			    <span class="o">+</span> <span class="s">"\"house_number\":\"324\","</span>
			    <span class="c1">// ...</span>
			    <span class="p">)</span>
	<span class="p">}</span>
    <span class="p">}</span>
</pre></div>

<p>
Understand now the following:
</p>

<div class="highlight"><pre><span></span>    <span class="nd">@Before</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">createRetriever</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">retriever</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AddressRetriever</span><span class="p">();</span>
	<span class="n">MockitoAnnotations</span><span class="p">.</span><span class="na">initMocks</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="p">}</span>
</pre></div>

<p>
So basically you first instantiate a retriever object.
</p>

<p>
Then you call MockitoAnnotations.initMocks(this). The <code>this</code>
argument refers to the test class itself. Mockito retrieves any
@Mock-annotated fields on the test class and synthesizes a mock
instance for each.  It then retrieves any @InjectMocks-annotated
fields and injects mock objects into them. 
</p>

<p>
This is how things work and how dependency are injected through
annotators. 
</p>

<p>
<b>Finally note:</b> the <code>when</code> method is not strictly restricted to
fix-values. You can as well pass methods to it. See for instance
the following way of getting a value value out of a list.
</p>

<div class="highlight"><pre><span></span>    <span class="n">when</span><span class="p">(</span><span class="n">mockList</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">anyInt</span><span class="p">())).</span><span class="na">thenReturn</span><span class="p">(</span><span class="s">"hello"</span><span class="p">);</span>
</pre></div>
</div>
</div>

<div id="outline-container-org7c0e3ff" class="outline-4">
<h4 id="org7c0e3ff">@Spy</h4>
<div class="outline-text-4" id="text-org7c0e3ff">
<p>
Spies are known as <i>partially mock objects</i>. 
</p>

<p>
It means spy creates a partial object or a half dummy of the real
object by stubbing or spying the real ones. 
</p>

<p>
In spying, the <b>real object remains unchanged</b>, and we just spy some
specific methods of it. In other words, we take the existing
(real) object and replace or spy only some of its methods. 
</p>

<p>
What this practically means is the following:
</p>

<div class="highlight"><pre><span></span><span class="c1">// Mock </span>
<span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">whenCreateMock_thenCreated</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">List</span> <span class="n">mockedList</span> <span class="o">=</span> <span class="n">Mockito</span><span class="p">.</span><span class="na">mock</span><span class="p">(</span><span class="n">ArrayList</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

    <span class="n">mockedList</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">"one"</span><span class="p">);</span>
    <span class="n">Mockito</span><span class="p">.</span><span class="na">verify</span><span class="p">(</span><span class="n">mockedList</span><span class="p">).</span><span class="na">add</span><span class="p">(</span><span class="s">"one"</span><span class="p">);</span>

    <span class="n">assertEquals</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">mockedList</span><span class="p">.</span><span class="na">size</span><span class="p">());</span> <span class="c1">// will be TRUE. adding an</span>
					<span class="c1">// element into the mocked</span>
					<span class="c1">// list doesn't actually add</span>
					<span class="c1">// anything, it just calls the</span>
					<span class="c1">// method with no other</span>
					<span class="c1">// side-effects.</span>
<span class="p">}</span>

<span class="c1">// Spy</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">whenCreateMock_thenCreated</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">List</span> <span class="n">spyList</span> <span class="o">=</span> <span class="n">Mockito</span><span class="p">.</span><span class="na">spy</span><span class="p">(</span><span class="n">ArrayList</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

    <span class="n">spyList</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">"one"</span><span class="p">);</span>
    <span class="n">Mockito</span><span class="p">.</span><span class="na">verify</span><span class="p">(</span><span class="n">spyList</span><span class="p">).</span><span class="na">add</span><span class="p">(</span><span class="s">"one"</span><span class="p">);</span>

    <span class="n">assertEquals</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">spyList</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>  <span class="c1">// will be FALSE. The spy it</span>
				      <span class="c1">// will actually call the real</span>
				      <span class="c1">// implementation of the add</span>
				      <span class="c1">// method and add the element to</span>
				      <span class="c1">// the underlying list.</span>
<span class="p">}</span>
</pre></div>

<p>
When using spy objects, the default behavior of the methods (when
not stubbed) is the real method behavior. 
</p>

<p>
See the following way to use spies:
</p>

<div class="highlight"><pre><span></span>    <span class="nd">@Spy</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">spyList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="p">();</span> <span class="c1">// Spy</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">whenUsingTheSpyAnnotation_thenObjectIsSpied</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">spyList</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">"one"</span><span class="p">);</span>
	<span class="n">spyList</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">"two"</span><span class="p">);</span>

	<span class="n">Mockito</span><span class="p">.</span><span class="na">verify</span><span class="p">(</span><span class="n">spyList</span><span class="p">).</span><span class="na">add</span><span class="p">(</span><span class="s">"one"</span><span class="p">);</span>
	<span class="n">Mockito</span><span class="p">.</span><span class="na">verify</span><span class="p">(</span><span class="n">spyList</span><span class="p">).</span><span class="na">add</span><span class="p">(</span><span class="s">"two"</span><span class="p">);</span>

	<span class="n">assertEquals</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">spyList</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>


	<span class="n">Mockito</span><span class="p">.</span><span class="na">doReturn</span><span class="p">(</span><span class="mi">100</span><span class="p">).</span><span class="na">when</span><span class="p">(</span><span class="n">spyList</span><span class="p">).</span><span class="na">size</span><span class="p">();</span> <span class="c1">// stubbed value.</span>
	<span class="n">assertEquals</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">spyList</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>

<div id="outline-container-orgadc1fa7" class="outline-4">
<h4 id="orgadc1fa7">
<span class="todo TODO">TODO</span> @Capture</h4>
</div>


<div id="outline-container-orgd829cc5" class="outline-4">
<h4 id="orgd829cc5">Resources used for the tutorial</h4>
<div class="outline-text-4" id="text-orgd829cc5">
<ul class="org-ul">
<li><a href="https://www.journaldev.com/21816/mockito-tutorial">Resource 1</a></li>

<li><a href="https://pragprog.com/titles/utj2/pragmatic-unit-testing-in-java-8-with-junit/">Resource 2</a></li>
</ul>
</div>
</div>
</div>





<div id="outline-container-org8f383fa" class="outline-3">
<h3 id="org8f383fa">Testing in Spring Boot</h3>
<div class="outline-text-3" id="text-org8f383fa">
<p>
Especially important is to understand the testing compoenent of MVC
as I plan to use this a lot. 
</p>

<p>
There basically you have a couple of spring specific tags that you
use to properly tag and create your test. 
</p>

<p>
See the following 101 example from spring in action.
</p>


<div class="highlight"><pre><span></span>   <span class="kn">package</span> <span class="nn">tacos</span><span class="p">;</span>
   <span class="kn">import static</span> <span class="nn">org.hamcrest.Matchers.containsString</span><span class="p">;</span>
   <span class="kn">import static</span> 
       <span class="nn">org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get</span><span class="p">;</span>
   <span class="kn">import static</span> 
       <span class="nn">org.springframework.test.web.servlet.result.MockMvcResultMatchers.content</span><span class="p">;</span>
   <span class="kn">import static</span> 
       <span class="nn">org.springframework.test.web.servlet.result.MockMvcResultMatchers.status</span><span class="p">;</span>
   <span class="kn">import static</span> 
       <span class="nn">org.springframework.test.web.servlet.result.MockMvcResultMatchers.view</span><span class="p">;</span>
   <span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="p">;</span>
   <span class="kn">import</span> <span class="nn">org.junit.runner.RunWith</span><span class="p">;</span>
   <span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
   <span class="kn">import</span> <span class="nn">org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest</span><span class="p">;</span>
   <span class="kn">import</span> <span class="nn">org.springframework.test.context.junit4.SpringRunner</span><span class="p">;</span>
   <span class="kn">import</span> <span class="nn">org.springframework.test.web.servlet.MockMvc</span><span class="p">;</span>

   <span class="nd">@RunWith</span><span class="p">(</span><span class="n">SpringRunner</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
   <span class="nd">@WebMvcTest</span><span class="p">(</span><span class="n">HomeController</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>  <span class="c1">// this is necessary to make the</span>
				      <span class="c1">// HomeController seeable.</span>

   <span class="kd">public</span> <span class="kd">class</span> <span class="nc">HomeControllerTest</span> <span class="p">{</span>

       <span class="nd">@Autowired</span>
       <span class="kd">private</span> <span class="n">MockMvc</span> <span class="n">mockMvc</span><span class="p">;</span>       <span class="c1">// this is the Mock object through</span>
				      <span class="c1">// which you will perform the calls</span>
				      <span class="c1">// to your endpoints and test them.</span>

       <span class="nd">@Test</span> 
       <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testHomePage</span><span class="p">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="p">{</span>    <span class="c1">// this is the</span>
							<span class="c1">// test through</span>
							<span class="c1">// the mock</span>
							<span class="c1">// object.</span>
	   <span class="n">mockMvc</span><span class="p">.</span><span class="na">perform</span><span class="p">(</span><span class="n">get</span><span class="p">(</span><span class="s">"/"</span><span class="p">))</span> 
	       <span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">status</span><span class="p">().</span><span class="na">isOk</span><span class="p">())</span> 
	       <span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">view</span><span class="p">().</span><span class="na">name</span><span class="p">(</span><span class="s">"home"</span><span class="p">))</span> 
	       <span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">content</span><span class="p">().</span><span class="na">string</span><span class="p">(</span><span class="n">containsString</span><span class="p">(</span><span class="s">"Welcome to..."</span><span class="p">)));</span>
       <span class="p">}</span>
   <span class="p">}</span>
</pre></div>

<p>
So this is how you can test the actual business logic of your end-points.
</p>
</div>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="../front-end-stories/" rel="prev" title="Front-End Stories">Previous post</a>
            </li>
            <li class="next">
                <a href="../spring/" rel="next" title="Spring">Next post</a>
            </li>
        </ul></nav></aside></article><footer id="footer"><p>Contents © 2022         <a href="mailto:marco.hassan30@gmail.com">Marco Hassan</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    </section><script src="../../assets/js/all-nocdn.js"></script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(2, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates --><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script>
</body>
</html>
